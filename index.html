<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css">


  <meta name="keywords" content="Hexo, NexT">








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0">






<meta name="description" content="ä¸€èŠ±ä¸€ä¸–ç•Œï¼Œä¸€ç ä¸€æµ®ç”Ÿ">
<meta property="og:type" content="website">
<meta property="og:title" content="JunBin">
<meta property="og:url" content="https://junbin1011.github.io/index.html">
<meta property="og:site_name" content="JunBin">
<meta property="og:description" content="ä¸€èŠ±ä¸€ä¸–ç•Œï¼Œä¸€ç ä¸€æµ®ç”Ÿ">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="JunBin">
<meta name="twitter:description" content="ä¸€èŠ±ä¸€ä¸–ç•Œï¼Œä¸€ç ä¸€æµ®ç”Ÿ">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://junbin1011.github.io/">





  <title> JunBin </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?b3ffb4912eee79c795100275f268095c";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">JunBin</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">ä¸€èŠ±ä¸€ä¸–ç•Œï¼Œä¸€ç ä¸€æµ®ç”Ÿ</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            æ ‡ç­¾
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            å…³äº
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://junbin1011.github.io/2020/05/07/Android-R-æ–°ç‰¹æ€§å˜åŒ–/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="é»„ä¿Šå½¬">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://note.youdao.com/yws/api/personal/file/WEB917b08143504a6f8c96228312fcb5245?method=download&shareKey=03cb5c302c83b56bbb91668c5008444f">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JunBin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/05/07/Android-R-æ–°ç‰¹æ€§å˜åŒ–/" itemprop="url">
                  Android R æ–°ç‰¹æ€§å˜åŒ–
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2020-05-07T15:23:27+08:00">
                2020-05-07
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/05/07/Android-R-æ–°ç‰¹æ€§å˜åŒ–/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2020/05/07/Android-R-æ–°ç‰¹æ€§å˜åŒ–/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><ul>
<li><p>Android Q ä¸»è¦æ–°ç‰¹æ€§</p>
</li>
<li><p>Android R ç‰ˆæœ¬å‘å¸ƒè®¡åˆ’</p>
</li>
<li><p>Android R åŠŸèƒ½æ¼”ç¤ºï¼ˆVideoï¼‰</p>
</li>
<li><p>Android R æ–°åŠŸèƒ½ä¸APIç‰¹æ€§</p>
</li>
<li>æ€»ç»“ä¸æ€è€ƒ</li>
</ul>
<h1 id="1ï¸âƒ£-Android-Q-ä¸»è¦æ–°ç‰¹æ€§-emsp-emsp"><a href="#1ï¸âƒ£-Android-Q-ä¸»è¦æ–°ç‰¹æ€§-emsp-emsp" class="headerlink" title="1ï¸âƒ£ Android Q ä¸»è¦æ–°ç‰¹æ€§&emsp; &emsp;"></a>1ï¸âƒ£ Android Q ä¸»è¦æ–°ç‰¹æ€§&emsp; &emsp;</h1><blockquote>
<p>ç”¨äºå¯æŠ˜å è®¾å¤‡ã€æ·±è‰²ä¸»é¢˜ã€æ‰‹åŠ¿å¯¼èˆªã€è¿æ¥ç­‰æ–°ç‰¹æ€§  </p>
</blockquote>
<h2 id="å¯æŠ˜å è®¾å¤‡"><a href="#å¯æŠ˜å è®¾å¤‡" class="headerlink" title="å¯æŠ˜å è®¾å¤‡"></a>å¯æŠ˜å è®¾å¤‡</h2><p><img src="https://developer.android.com/images/about/versions/10/overview/image2.png" alt></p>
<p>Android 10 åœ¨ onResume å’Œ onPause ä¸­æ·»åŠ äº†å¤šé¡¹æ”¹è¿›ï¼Œç”¨äºæ”¯æŒå¤šé¡¹æ¢å¤ï¼Œå¹¶åœ¨åº”ç”¨è·å¾—ç„¦ç‚¹æ—¶é€šçŸ¥åº”ç”¨</p>
<h2 id="æ·±è‰²ä¸»é¢˜"><a href="#æ·±è‰²ä¸»é¢˜" class="headerlink" title="æ·±è‰²ä¸»é¢˜"></a>æ·±è‰²ä¸»é¢˜</h2><p><img src="https://developer.android.com/images/about/versions/10/overview/image12.png" alt></p>
<p>Android 10 æ–°å¢äº†ä¸€ä¸ªç³»ç»Ÿçº§çš„æ·±è‰²ä¸»é¢˜ï¼Œéå¸¸é€‚åˆå…‰çº¿è¾ƒæš—çš„åœºæ™¯å¹¶èƒ½å¸®åŠ©èŠ‚çœç”µé‡ã€‚</p>
<ul>
<li>DayNight ä¸»é¢˜</li>
<li>Force Dark</li>
</ul>
<h2 id="æ‰‹åŠ¿å¯¼èˆª"><a href="#æ‰‹åŠ¿å¯¼èˆª" class="headerlink" title="æ‰‹åŠ¿å¯¼èˆª"></a>æ‰‹åŠ¿å¯¼èˆª</h2><p><img src="https://developer.android.com/images/about/versions/10/overview/gesture.gif" alt></p>
<p>Android 10 å¼•å…¥äº†å…¨æ‰‹åŠ¿å¯¼èˆªæ¨¡å¼ï¼Œè¯¥æ¨¡å¼ä¸æ˜¾ç¤ºé€šçŸ¥æ åŒºåŸŸï¼Œå…è®¸åº”ç”¨ä½¿ç”¨å…¨å±æ¥æä¾›æ›´ä¸°å¯Œã€æ›´è®©äººæ²‰æµ¸çš„ä½“éªŒã€‚</p>
<h2 id="å…±äº«å¿«æ·æ–¹å¼"><a href="#å…±äº«å¿«æ·æ–¹å¼" class="headerlink" title="å…±äº«å¿«æ·æ–¹å¼"></a>å…±äº«å¿«æ·æ–¹å¼</h2><p><img src="https://developer.android.com/images/about/versions/10/overview/image11.png" alt></p>
<p>å…±äº«å¿«æ·æ–¹å¼åŠŸèƒ½å¯ä½¿å…±äº«æ›´åŠ è½»æ¾å¿«æ·ï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿç›´æ¥è·³è½¬åˆ°å…¶ä»–åº”ç”¨æ¥å…±äº«å†…å®¹ã€‚</p>
<h2 id="5G-ç½‘ç»œ"><a href="#5G-ç½‘ç»œ" class="headerlink" title="5G ç½‘ç»œ"></a>5G ç½‘ç»œ</h2><p>Android 10 æ–°å¢äº†é’ˆå¯¹ 5G çš„å¹³å°æ”¯æŒï¼Œå¯ä»¥ä½¿ç”¨è¿æ¥ API (ConnectivityManager)æ¥æ£€æµ‹è®¾å¤‡æ˜¯å¦å…·æœ‰é«˜å¸¦å®½è¿æ¥ï¼Œè¿˜å¯ä»¥æ£€æŸ¥è¿æ¥æ˜¯å¦æŒ‰æµé‡è®¡è´¹ã€‚å€ŸåŠ©è¿™äº›åŠŸèƒ½ï¼Œåº”ç”¨å’Œæ¸¸æˆå¯ä»¥ä¸ºä½¿ç”¨ 5G çš„ç”¨æˆ·é‡èº«æ‰“é€ ä¸°å¯Œçš„æ²‰æµ¸å¼ä½“éªŒã€‚</p>
<h2 id="æ›´å¤š"><a href="#æ›´å¤š" class="headerlink" title="æ›´å¤š"></a>æ›´å¤š</h2><p> å®‰å…¨ã€è¿æ¥ã€æ€§èƒ½ä¼˜åŒ–</p>
<blockquote>
<p><a href="https://developer.android.com/about/versions/10/highlights" target="_blank" rel="noopener">https://developer.android.com/about/versions/10/highlights</a></p>
</blockquote>
<h1 id="2ï¸âƒ£-Android-R-ç‰ˆæœ¬å‘å¸ƒè®¡åˆ’-emsp-emsp"><a href="#2ï¸âƒ£-Android-R-ç‰ˆæœ¬å‘å¸ƒè®¡åˆ’-emsp-emsp" class="headerlink" title="2ï¸âƒ£ Android R ç‰ˆæœ¬å‘å¸ƒè®¡åˆ’&emsp; &emsp;"></a>2ï¸âƒ£ Android R ç‰ˆæœ¬å‘å¸ƒè®¡åˆ’&emsp; &emsp;</h1><h2 id="ç‰ˆæœ¬å‘å¸ƒæ—¶é—´"><a href="#ç‰ˆæœ¬å‘å¸ƒæ—¶é—´" class="headerlink" title="ç‰ˆæœ¬å‘å¸ƒæ—¶é—´"></a>ç‰ˆæœ¬å‘å¸ƒæ—¶é—´</h2><p><img src="https://note.youdao.com/yws/api/personal/file/WEBf62fd481ebb84dab2548322f0d37e918?method=download&amp;shareKey=4737ddd94e34214ca48ac39a438035c4" alt></p>
<blockquote>
<p>ç¬¬3å­£åº¦å‘å¸ƒé¢å‘ AOSP å’Œç”Ÿæ€ç³»ç»Ÿå‘å¸ƒ Android 11 æœ€ç»ˆç‰ˆæœ¬</p>
</blockquote>
<h2 id="ç‰ˆæœ¬å‘å¸ƒè®¡åˆ’"><a href="#ç‰ˆæœ¬å‘å¸ƒè®¡åˆ’" class="headerlink" title="ç‰ˆæœ¬å‘å¸ƒè®¡åˆ’"></a>ç‰ˆæœ¬å‘å¸ƒè®¡åˆ’</h2><p> <img src="https://note.youdao.com/yws/api/personal/file/WEBbdad941ea99230e8b0a22d24b931d53f?method=download&amp;shareKey=98fec952404b085e8c0bdf468db44b91" alt></p>
<h1 id="3ï¸âƒ£-Android-R-åŠŸèƒ½æ¼”ç¤ºï¼ˆVideoï¼‰-emsp-emsp"><a href="#3ï¸âƒ£-Android-R-åŠŸèƒ½æ¼”ç¤ºï¼ˆVideoï¼‰-emsp-emsp" class="headerlink" title="3ï¸âƒ£ Android R åŠŸèƒ½æ¼”ç¤ºï¼ˆVideoï¼‰&emsp; &emsp;"></a>3ï¸âƒ£ Android R åŠŸèƒ½æ¼”ç¤ºï¼ˆVideoï¼‰&emsp; &emsp;</h1><h2 id="Android-11-First-Look-7-Most-Exciting-Features"><a href="#Android-11-First-Look-7-Most-Exciting-Features" class="headerlink" title="Android 11 First Look: 7 Most Exciting Features!"></a>Android 11 First Look: 7 Most Exciting Features!</h2><p>  <a href="https://www.youtube.com/watch?v=04hjpFshguU" target="_blank" rel="noopener">https://www.youtube.com/watch?v=04hjpFshguU</a></p>
<h2 id="æ–°åŠŸèƒ½ç‰¹æ€§"><a href="#æ–°åŠŸèƒ½ç‰¹æ€§" class="headerlink" title="æ–°åŠŸèƒ½ç‰¹æ€§"></a>æ–°åŠŸèƒ½ç‰¹æ€§</h2><ul>
<li>Improved Notification Share</li>
<li>Bubbles</li>
<li>Better Permissions</li>
<li>Screen Recorded</li>
<li>Improved DND (Do Not Disturb)</li>
<li>Auto Dark Mode</li>
<li>Other Changes</li>
</ul>
<h1 id="4ï¸âƒ£-Android-R-æ–°APIç‰¹æ€§-emsp-emsp"><a href="#4ï¸âƒ£-Android-R-æ–°APIç‰¹æ€§-emsp-emsp" class="headerlink" title="4ï¸âƒ£ Android R æ–°APIç‰¹æ€§&emsp; &emsp;"></a>4ï¸âƒ£ Android R æ–°APIç‰¹æ€§&emsp; &emsp;</h1><blockquote>
<p>5Gã€å…±äº«ã€è¿æ¥ã€åª’ä½“ã€æ˜¾ç¤ºç­‰æ–¹é¢çš„ API</p>
</blockquote>
<h2 id="å¸§é€Ÿç‡"><a href="#å¸§é€Ÿç‡" class="headerlink" title="å¸§é€Ÿç‡"></a>å¸§é€Ÿç‡</h2><p>Android 11 æä¾›äº†ä¸€ä¸ª APIï¼Œå¯è®©åº”ç”¨å‘ŠçŸ¥ç³»ç»Ÿå®ƒä»¬é¢„æœŸçš„å¸§é€Ÿç‡ã€‚è¯¥ API çš„ä¸»è¦ç›®çš„æ˜¯è®©åº”ç”¨èƒ½å¤Ÿæ›´å¥½åœ°åˆ©ç”¨æ”¯æŒçš„æ‰€æœ‰æ˜¾ç¤ºå±åˆ·æ–°é¢‘ç‡ï¼ˆ90Hz 120Hzï¼‰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Surface.setFrameRate()</span><br><span class="line">SurfaceControl.Transaction.setFrameRate()</span><br><span class="line">ANativeWindow_setFrameRate()</span><br><span class="line">ASurfaceTransaction_setFrameRate()</span><br></pre></td></tr></table></figure>
<h2 id="ç€‘å¸ƒå±"><a href="#ç€‘å¸ƒå±" class="headerlink" title="ç€‘å¸ƒå±"></a>ç€‘å¸ƒå±</h2><p>Android 11 æä¾›äº†ä¸€äº› API æ¥æ”¯æŒç€‘å¸ƒå±ï¼Œè¿™æ˜¯ä¸€ç§æ— è¾¹æ¡†çš„å…¨é¢å±ã€‚ï¼ˆè¶…å¤§çš„å¼¯æŠ˜è§’åº¦ï¼‰</p>
<ul>
<li><p>è°ƒç”¨ DisplayCutout. getWaterfallInsets() ä»¥è·å–ç€‘å¸ƒè¾¹è¡¬åŒºçš„ç²¾ç¡®å°ºå¯¸ã€‚</p>
</li>
<li><p>å°†çª—å£å¸ƒå±€å±æ€§ layoutInDisplayCutoutMode è®¾ä¸º LAYOUT_IN_DISPLAY_CUTOUT_MODE_ALWAYSï¼Œä»¥å…è®¸çª—å£å»¶ä¼¸åˆ°å±å¹•å„ä¸ªè¾¹ç¼˜ä¸Šçš„åˆ˜æµ·å’Œç€‘å¸ƒåŒºåŸŸ</p>
</li>
</ul>
<h2 id="APK-ç­¾åæ–¹æ¡ˆ-v4-amp-å¢é‡-APK-å®‰è£…"><a href="#APK-ç­¾åæ–¹æ¡ˆ-v4-amp-å¢é‡-APK-å®‰è£…" class="headerlink" title="APK ç­¾åæ–¹æ¡ˆ v4 &amp; å¢é‡ APK å®‰è£…"></a>APK ç­¾åæ–¹æ¡ˆ v4 &amp; å¢é‡ APK å®‰è£…</h2><p>åœ¨è®¾å¤‡ä¸Šå®‰è£…å¤§å‹ï¼ˆ2GB ä»¥ä¸Šï¼‰APK å¯èƒ½éœ€è¦å¾ˆé•¿çš„æ—¶é—´ï¼Œå¢é‡ APK å®‰è£…é€šè¿‡å®‰è£… APK ä¸­è¶³ä»¥ç”¨æ¥å¯åŠ¨åº”ç”¨çš„éƒ¨åˆ†ï¼ŒåŒæ—¶åœ¨åå°æµå¼ä¼ è¾“å‰©ä½™æ•°æ®ï¼ŒåŠ é€Ÿäº†è¿™ä¸€è¿‡ç¨‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb install --incremental</span><br></pre></td></tr></table></figure>
<h2 id="NDK-å›¾åƒè§£ç å™¨"><a href="#NDK-å›¾åƒè§£ç å™¨" class="headerlink" title="NDK å›¾åƒè§£ç å™¨"></a>NDK å›¾åƒè§£ç å™¨</h2><p>NDK ImageDecoder API æä¾›äº†ä¸€ç§æ ‡å‡† APIï¼Œä¾› Android C/C++ åº”ç”¨ç›´æ¥è§£ç å›¾åƒã€‚åº”ç”¨å¼€å‘è€…ä¸å†éœ€è¦ä½¿ç”¨æ¡†æ¶ APIï¼ˆé€šè¿‡ JNIï¼‰æˆ–æ†ç»‘ç¬¬ä¸‰æ–¹å›¾åƒè§£ç åº“ã€‚</p>
<h2 id="åº”ç”¨è¿›ç¨‹é€€å‡ºåŸå› "><a href="#åº”ç”¨è¿›ç¨‹é€€å‡ºåŸå› " class="headerlink" title="åº”ç”¨è¿›ç¨‹é€€å‡ºåŸå› "></a>åº”ç”¨è¿›ç¨‹é€€å‡ºåŸå› </h2><p> Android 11 å¼•å…¥äº† getHistoricalProcessExitReasons() æ–¹æ³•ï¼Œç”¨äºæŠ¥å‘Šè¿‘æœŸä»»ä½•è¿›ç¨‹ç»ˆæ­¢çš„åŸå› ã€‚åº”ç”¨å¯ä»¥ä½¿ç”¨æ­¤æ–¹æ³•æ¥æ”¶é›†å´©æºƒè¯Šæ–­ä¿¡æ¯ï¼Œä¾‹å¦‚è¿›ç¨‹ç»ˆæ­¢æ˜¯ç”±äº ANRã€å†…å­˜é—®é¢˜è¿˜æ˜¯å…¶ä»–åŸå› æ‰€è‡´ã€‚</p>
<h2 id="æ›´å¥½åœ°æ”¯æŒåŒ…å«å¤šä¸ªå¸§çš„-HEIF-å›¾ç‰‡"><a href="#æ›´å¥½åœ°æ”¯æŒåŒ…å«å¤šä¸ªå¸§çš„-HEIF-å›¾ç‰‡" class="headerlink" title="æ›´å¥½åœ°æ”¯æŒåŒ…å«å¤šä¸ªå¸§çš„ HEIF å›¾ç‰‡"></a>æ›´å¥½åœ°æ”¯æŒåŒ…å«å¤šä¸ªå¸§çš„ HEIF å›¾ç‰‡</h2><p>ä» Android 11 å¼€å§‹ï¼Œå¦‚æœæ‚¨è°ƒç”¨ ImageDecoder.decodeDrawable() å¹¶ä¼ é€’åŒ…å«å¸§åºåˆ—çš„ HEIF å›¾ç‰‡ï¼ˆå¦‚åŠ¨ç”»æˆ–è¿æ‹ç…§ç‰‡ï¼‰ï¼Œåˆ™è¯¥æ–¹æ³•ä¼šè¿”å›åŒ…å«æ•´ä¸ªå›¾ç‰‡åºåˆ—çš„ AnimatedImageDrawableã€‚</p>
<blockquote>
<p>HEIFå°±æ˜¯â€é«˜æ•ˆå›¾åƒæ ¼å¼â€œï¼Œæ˜¯æ–°ä¸€ä»£çš„å›¾ç‰‡å‹ç¼©æŠ€æœ¯ã€‚åœ¨åŒæ ·æ¡ä»¶ä¸‹ï¼ŒHEIFçš„ä½“ç§¯å¯ä»¥æ¯”jpgå°æ¥è¿‘ä¸€</p>
</blockquote>
<h2 id="ä½¿ç”¨æ•°æ®-blob-å®‰å…¨å…±äº«å¤§å‹æ•°æ®é›†"><a href="#ä½¿ç”¨æ•°æ®-blob-å®‰å…¨å…±äº«å¤§å‹æ•°æ®é›†" class="headerlink" title="ä½¿ç”¨æ•°æ® blob å®‰å…¨å…±äº«å¤§å‹æ•°æ®é›†"></a>ä½¿ç”¨æ•°æ® blob å®‰å…¨å…±äº«å¤§å‹æ•°æ®é›†</h2><p>ä¸ºå¸®åŠ©å‡å°‘ç½‘ç»œä¸­å’Œç£ç›˜ä¸Šçš„æ•°æ®å†—ä½™ï¼ŒAndroid 11ï¼ˆAPI çº§åˆ«â€œRâ€ï¼‰ä¼šç¼“å­˜å…±äº«æ•°æ®é›†ï¼Œä¸ºæœºå™¨å­¦ä¹ å’Œåª’ä½“æ’­æ”¾ç­‰ç”¨ä¾‹æä¾›æ”¯æŒ.</p>
<blockquote>
<p>å½“ä¸€ä¸ªåº”ç”¨ä¸‹è½½å®ŒæŸä¸ªæ•°æ®åï¼Œå¯ä»¥å°†è¯¥æ•°æ®å…±äº«ç»™æŒ‡å®šçš„åŒ…ååº”ç”¨ã€æˆ–è€…ç›¸åŒç­¾ååº”ç”¨ã€æˆ–è€…æ— é™åˆ¶å…¬å¼€ï¼Œå…¶ä»–åº”ç”¨å¯ä»¥ç›´æ¥è¯»å–è¯¥æ•°æ®</p>
</blockquote>
<h2 id="åœ¨-Android-æ¨¡æ‹Ÿå™¨ä¸Šè¿è¡Œ-ARM-åº”ç”¨"><a href="#åœ¨-Android-æ¨¡æ‹Ÿå™¨ä¸Šè¿è¡Œ-ARM-åº”ç”¨" class="headerlink" title="åœ¨ Android æ¨¡æ‹Ÿå™¨ä¸Šè¿è¡Œ ARM åº”ç”¨"></a>åœ¨ Android æ¨¡æ‹Ÿå™¨ä¸Šè¿è¡Œ ARM åº”ç”¨</h2><p>æ–°çš„ç³»ç»Ÿæ˜ åƒåœ¨æ‰§è¡Œ ARM äºŒè¿›åˆ¶æ–‡ä»¶æ–¹é¢å–å¾—äº†æ˜¾è‘—çš„æ€§èƒ½æå‡ã€‚Android 11 ç³»ç»Ÿæ˜ åƒèƒ½å¤Ÿåœ¨ä¸å½±å“æ•´ä¸ªç³»ç»Ÿçš„å‰æä¸‹ï¼Œç›´æ¥å°† ARM æŒ‡ä»¤è½¬æ¢æˆ x86 æŒ‡ä»¤ã€‚å¼€å‘è€…æ— éœ€æ­å»ºé«˜è´Ÿè½½çš„ ARM ç¯å¢ƒå³å¯æ‰§è¡Œ ARM äºŒè¿›åˆ¶æ–‡ä»¶å¹¶è¿›è¡Œæµ‹è¯•ã€‚</p>
<blockquote>
<p><a href="https://www.jianshu.com/p/d2def" target="_blank" rel="noopener">https://www.jianshu.com/p/d2def</a><br>eb32558</p>
</blockquote>
<h2 id="æ›´å¤š-1"><a href="#æ›´å¤š-1" class="headerlink" title="æ›´å¤š"></a>æ›´å¤š</h2><p>Android R ç›®å‰ä¸º DP3  ï¼Œæ›´å¤šç‰¹æ€§å‚è€ƒï¼š</p>
<blockquote>
<p><a href="https://developer.android.com/preview/features" target="_blank" rel="noopener">https://developer.android.com/preview/features</a></p>
</blockquote>
<h1 id="5ï¸âƒ£-æ€»ç»“ä¸æ€è€ƒ-ğŸ’¡-emsp-emsp"><a href="#5ï¸âƒ£-æ€»ç»“ä¸æ€è€ƒ-ğŸ’¡-emsp-emsp" class="headerlink" title="5ï¸âƒ£ æ€»ç»“ä¸æ€è€ƒ ğŸ’¡&emsp; &emsp;"></a>5ï¸âƒ£ æ€»ç»“ä¸æ€è€ƒ ğŸ’¡&emsp; &emsp;</h1><ul>
<li><p>Android R æœ€æ–°ç‰ˆæœ¬ä¸ºDP3,ç›®å‰æ•´ä½“æ¥çœ‹ï¼Œä¸»è¦æ˜¯ä¸€äº›ä¼˜åŒ–å’Œæ”¹è¿›ï¼Œæ²¡æœ‰æ¯”è¾ƒé‡å¤§çš„æ›´æ–°ã€‚</p>
</li>
<li><p>ä»Android Q å¼€å§‹ï¼ŒåŸç”Ÿç³»ç»Ÿæ”¯æŒäº†å›½å†…ROMéå¸¸å¤šçš„ç‰¹æ€§ï¼ŒåŒ…å«æ·±è‰²ä¸»é¢˜ã€å¯¼èˆªæ‰‹åŠ¿ã€æ»šåŠ¨æˆªå±ã€å±å¹•å½•åƒã€å…±äº«å¿«æ·ç­‰</p>
</li>
</ul>
<h2 id="å…³äº"><a href="#å…³äº" class="headerlink" title="å…³äº"></a>å…³äº</h2><p><strong>æ¬¢è¿å…³æ³¨æˆ‘çš„ä¸ªäººå…¬ä¼—å·</strong></p>
<p>å¾®ä¿¡æœç´¢ï¼š<strong>ä¸€ç ä¸€æµ®ç”Ÿ</strong>ï¼Œæˆ–è€…æœç´¢å…¬ä¼—å·ID:<strong>life2code</strong></p>
<p><img src="https://note.youdao.com/yws/api/personal/file/WEB8682567ec4f22dab1ed9c5350ec9db62?method=download&amp;shareKey=06e819ed512febb7dcf540161b125867" alt></p>
<ul>
<li>ä½œè€…ï¼šé»„ä¿Šå½¬ </li>
<li><a href="https://junbin.tech/" target="_blank" rel="noopener">åšå®¢ï¼šjunbin.tech</a></li>
<li><a href="https://github.com/junbin1011" target="_blank" rel="noopener">GitHub: junbin1011 </a></li>
<li><a href="https://www.zhihu.com/people/junbin-9-77" target="_blank" rel="noopener">çŸ¥ä¹: @JunBin</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://junbin1011.github.io/2020/04/21/Clean-Architecture-Android/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="é»„ä¿Šå½¬">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://note.youdao.com/yws/api/personal/file/WEB917b08143504a6f8c96228312fcb5245?method=download&shareKey=03cb5c302c83b56bbb91668c5008444f">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JunBin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/04/21/Clean-Architecture-Android/" itemprop="url">
                  Clean Architecture - Android
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2020-04-21T17:19:55+08:00">
                2020-04-21
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/04/21/Clean-Architecture-Android/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2020/04/21/Clean-Architecture-Android/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="æ•´æ´æ¶æ„"><a href="#æ•´æ´æ¶æ„" class="headerlink" title="æ•´æ´æ¶æ„"></a>æ•´æ´æ¶æ„</h1><p><img src="https://camo.githubusercontent.com/a2342fe9acb71d058612dd06e1d09779dc7bf79a/68747470733a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f343039392d303464666262663230373261643261662e6a70673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f3737322f666f726d61742f77656270" alt="image.png"></p>
<ul>
<li>ç‹¬ç«‹äºæ¡†æ¶</li>
<li>å¯æµ‹è¯•</li>
<li>ç‹¬ç«‹äºUI</li>
<li>ç‹¬ç«‹äºæ•°æ®åº“</li>
<li><p>ç‹¬ç«‹äºå¤–éƒ¨ä¾èµ–</p>
<hr>
<h1 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h1></li>
</ul>
<p><img src="https://github.com/googlesamples/android-architecture/wiki/images/todoapp.gif" alt="image"></p>
<h1 id="æ¶æ„è®¾è®¡"><a href="#æ¶æ„è®¾è®¡" class="headerlink" title="æ¶æ„è®¾è®¡"></a>æ¶æ„è®¾è®¡</h1><p><img src="https://github.com/googlesamples/android-architecture/wiki/images/mvp-clean.png" alt="image"></p>
<hr>
<h1 id="Data-Layerï¼ˆæ•°æ®å±‚ï¼‰"><a href="#Data-Layerï¼ˆæ•°æ®å±‚ï¼‰" class="headerlink" title="Data Layerï¼ˆæ•°æ®å±‚ï¼‰"></a>Data Layerï¼ˆæ•°æ®å±‚ï¼‰</h1><p>ä»“å‚¨æ¨¡å¼ï¼ˆRepository Patternï¼‰æ˜¯å­˜åœ¨äºä¸šåŠ¡å’Œæ•°æ®åº“ä¹‹é—´å•ç‹¬åˆ†ç¦»å‡ºæ¥çš„ä¸€å±‚ï¼Œæ˜¯å¯¹æ•°æ®è®¿é—®çš„å°è£…ã€‚ </p>
<ul>
<li>ä¸šåŠ¡å±‚æ— éœ€çŸ¥é“å…·ä½“å®ç°è¾¾åˆ°åˆ†ç¦»å…³æ³¨ç‚¹</li>
<li>æé«˜å¯¹æ•°æ®è®¿é—®çš„ç»´æŠ¤ï¼Œå¯¹äºä»“å‚¨çš„æ”¹å˜å¹¶ä¸æ”¹å˜ä¸šåŠ¡çš„é€»è¾‘</li>
</ul>
<p><img src="https://camo.githubusercontent.com/8429a23cf2de87e9c0537b2eaa808672c849cf22/68747470733a2f2f6665726e616e646f63656a61732e636f6d2f6173736574732f696d616765732f636c65616e5f6172636869746563747572655f636c65616e5f7761795f30352e706e67" alt="image"></p>
<h1 id="æ¥å£"><a href="#æ¥å£" class="headerlink" title="æ¥å£"></a>æ¥å£</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">TasksDataSource</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">getTask</span><span class="params">(@NonNull String taskId, @NonNull GetTaskCallback callback)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">saveTask</span><span class="params">(@NonNull Task task)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">completeTask</span><span class="params">(@NonNull Task task)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">deleteTask</span><span class="params">(@NonNull String taskId)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="Domain-Layer-é¢†åŸŸå±‚"><a href="#Domain-Layer-é¢†åŸŸå±‚" class="headerlink" title="Domain Layer (é¢†åŸŸå±‚)"></a>Domain Layer (é¢†åŸŸå±‚)</h1><ul>
<li>åŒ…å«æ‰€æœ‰çš„ä¸šåŠ¡é€»è¾‘</li>
<li>Use case å®šä¹‰åº”ç”¨ç¨‹åºéœ€è¦çš„æ“ä½œ</li>
<li>è¯¥å±‚æ˜¯ä¸€ä¸ªçº¯Javaæ¨¡å—ï¼Œæ²¡æœ‰ä»»ä½•Androidä¾èµ–é¡¹</li>
</ul>
<p><img src="https://camo.githubusercontent.com/df065e887ac07fe185e4d8e43ec12a6fa8a8015d/68747470733a2f2f6665726e616e646f63656a61732e636f6d2f6173736574732f696d616765732f636c65616e5f6172636869746563747572655f636c65616e5f7761795f30342e706e67" alt="image"></p>
<h1 id="Task-Domain"><a href="#Task-Domain" class="headerlink" title="Task Domain"></a>Task Domain</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Task</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String mId;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String mTitle;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String mDescription;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">boolean</span> mCompleted;</span><br><span class="line">    <span class="comment">// ... ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CompleteTask</span> <span class="keyword">extends</span> <span class="title">UseCase</span>&lt;<span class="title">CompleteTask</span>.<span class="title">RequestValues</span>, <span class="title">CompleteTask</span>.<span class="title">ResponseValue</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> TasksRepository mTasksRepository;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">executeUseCase</span><span class="params">(<span class="keyword">final</span> RequestValues values)</span> </span>&#123;</span><br><span class="line">        String completedTask = values.getCompletedTask();</span><br><span class="line">        mTasksRepository.completeTask(completedTask);</span><br><span class="line">        getUseCaseCallback().onSuccess(<span class="keyword">new</span> ResponseValue());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Statistics-Domain"><a href="#Statistics-Domain" class="headerlink" title="Statistics Domain"></a>Statistics Domain</h1> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Statistics</span> </span>&#123;</span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> completedTasks;</span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> activeTasks;</span><br><span class="line">   <span class="comment">//... ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GetStatistics</span> <span class="keyword">extends</span> <span class="title">UseCase</span>&lt;<span class="title">GetStatistics</span>.<span class="title">RequestValues</span>, <span class="title">GetStatistics</span>.<span class="title">ResponseValue</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> TasksRepository mTasksRepository;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">executeUseCase</span><span class="params">(RequestValues requestValues)</span> </span>&#123;</span><br><span class="line">        mTasksRepository.getTasks(<span class="keyword">new</span> TasksDataSource.LoadTasksCallback() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onTasksLoaded</span><span class="params">(List&lt;Task&gt; tasks)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">int</span> activeTasks = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">int</span> completedTasks = <span class="number">0</span>;</span><br><span class="line">                <span class="comment">// We calculate number of active and completed tasks</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="Presentation-Layer-è¡¨ç°å±‚"><a href="#Presentation-Layer-è¡¨ç°å±‚" class="headerlink" title="Presentation Layer (è¡¨ç°å±‚)"></a>Presentation Layer (è¡¨ç°å±‚)</h1><ul>
<li>æ ¹æ®Domain Layerçš„æ•°æ®è¿›è¡Œç•Œé¢æ˜¾ç¤º</li>
<li><p><strong>å°†ä¸šåŠ¡é€»è¾‘ç§»åŠ¨åˆ°é¢†åŸŸå±‚ä¸­æ›´å°ç²’åº¦çš„Use caseï¼Œé¿å…Presenterçš„ä»£ç é‡å¤</strong></p>
<p><img src="https://camo.githubusercontent.com/5185ca8da84fcda38262041e407fa5ae2b857d83/68747470733a2f2f6665726e616e646f63656a61732e636f6d2f6173736574732f696d616765732f636c65616e5f6172636869746563747572655f636c65616e5f7761795f30332e706e67" alt="image.png"></p>
</li>
</ul>
<h1 id="Presenter"><a href="#Presenter" class="headerlink" title="Presenter"></a>Presenter</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"> public class TasksPresenter implements TasksContract.Presenter &#123;</span><br><span class="line"></span><br><span class="line">    private final TasksContract.View mTasksView;</span><br><span class="line">    private final GetTasks mGetTasks;</span><br><span class="line">    private final CompleteTask mCompleteTask;</span><br><span class="line"></span><br><span class="line">    private void loadTasks(boolean forceUpdate, final boolean showLoadingUI) &#123;</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">        GetTasks.RequestValues requestValue = new GetTasks.RequestValues(forceUpdate,</span><br><span class="line">                mCurrentFiltering);</span><br><span class="line"></span><br><span class="line">        mUseCaseHandler.execute(mGetTasks, requestValue,</span><br><span class="line">                new UseCase.UseCaseCallback&lt;GetTasks.ResponseValue&gt;() &#123;</span><br><span class="line">                    @Override</span><br><span class="line">                    public void onSuccess(GetTasks.ResponseValue response) &#123;</span><br><span class="line">                        // ... ...</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    @Override</span><br><span class="line">                    public void onError() &#123;</span><br><span class="line">                        // The view may not be able to handle UI updates anymore</span><br><span class="line">                        if (!mTasksView.isActive()) &#123;</span><br><span class="line">                            return;</span><br><span class="line">                        &#125;</span><br><span class="line">                        mTasksView.showLoadingTasksError();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h1><ul>
<li>Presentation Layer (è¡¨ç°å±‚)ï¼šå°å‹/ä¸­å‹æµ‹è¯•ï¼Œ Robolectricã€Espresso</li>
<li>Domain Layer (é¢†åŸŸå±‚)ï¼šå°å‹æµ‹è¯•ï¼ŒJunitã€Mockito</li>
<li>Data Layerï¼ˆæ•°æ®å±‚ï¼‰ï¼š å°å‹/ä¸­å‹æµ‹è¯•ï¼ŒRobolectricï¼ˆå› ä¸ºè¯¥å±‚å…·æœ‰androidä¾èµ–é¡¹ï¼‰ï¼ŒJunitã€Mockito</li>
</ul>
<h1 id="ä¸­å‹æµ‹è¯•"><a href="#ä¸­å‹æµ‹è¯•" class="headerlink" title="ä¸­å‹æµ‹è¯•"></a>ä¸­å‹æµ‹è¯•</h1> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith</span>(AndroidJUnit4.class)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TasksScreenTest</span> </span>&#123;</span><br><span class="line">      <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">createTask</span><span class="params">(String title, String description)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// Click on the add task button</span></span><br><span class="line">        onView(withId(R.id.fab_add_task)).perform(click());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Add task title and description</span></span><br><span class="line">        onView(withId(R.id.add_task_title)).perform(typeText(title),</span><br><span class="line">                closeSoftKeyboard()); <span class="comment">// Type new task title</span></span><br><span class="line">        onView(withId(R.id.add_task_description)).perform(typeText(description),</span><br><span class="line">                closeSoftKeyboard()); <span class="comment">// Type new task description and close the keyboard</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// Save the task</span></span><br><span class="line">        onView(withId(R.id.fab_edit_task_done)).perform(click());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ... ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="å°å‹æµ‹è¯•"><a href="#å°å‹æµ‹è¯•" class="headerlink" title="å°å‹æµ‹è¯•"></a>å°å‹æµ‹è¯•</h1> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TasksPresenterTest</span> </span>&#123;</span><br><span class="line">       <span class="meta">@Test</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">completeTask_ShowsTaskMarkedComplete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       <span class="comment">// Given a stubbed task</span></span><br><span class="line">       Task task = <span class="keyword">new</span> Task(<span class="string">"Details Requested"</span>, <span class="string">"For this task"</span>);</span><br><span class="line"></span><br><span class="line">       <span class="comment">// When task is marked as complete</span></span><br><span class="line">       mTasksPresenter.completeTask(task);</span><br><span class="line"></span><br><span class="line">       <span class="comment">// Then repository is called and task marked complete UI is shown</span></span><br><span class="line">       verify(mTasksRepository).completeTask(eq(task.getId()));</span><br><span class="line">       verify(mTasksView).showTaskMarkedComplete();</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="comment">//... ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="ç¤ºä¾‹ï¼ˆJavaï¼‰"><a href="#ç¤ºä¾‹ï¼ˆJavaï¼‰" class="headerlink" title="ç¤ºä¾‹ï¼ˆJavaï¼‰"></a>ç¤ºä¾‹ï¼ˆJavaï¼‰</h1><p>android/architecture-samples</p>
<p><a href="https://github.com/android/architecture-samples/tree/todo-mvp-clean" target="_blank" rel="noopener">https://github.com/android/architecture-samples/tree/todo-mvp-clean</a></p>
<h1 id="æ¨èï¼ˆKotlinï¼‰"><a href="#æ¨èï¼ˆKotlinï¼‰" class="headerlink" title="æ¨èï¼ˆKotlinï¼‰"></a>æ¨èï¼ˆKotlinï¼‰</h1><p> android10/Android-CleanArchitecture-Kotlin</p>
<p> <a href="https://github.com/android10/Android-CleanArchitecture-Kotlin" target="_blank" rel="noopener">https://github.com/android10/Android-CleanArchitecture-Kotlin</a></p>
<h2 id="å…³äº"><a href="#å…³äº" class="headerlink" title="å…³äº"></a>å…³äº</h2><p><strong>æ¬¢è¿å…³æ³¨æˆ‘çš„ä¸ªäººå…¬ä¼—å·</strong></p>
<p>å¾®ä¿¡æœç´¢ï¼š<strong>ä¸€ç ä¸€æµ®ç”Ÿ</strong>ï¼Œæˆ–è€…æœç´¢å…¬ä¼—å·ID:<strong>life2code</strong></p>
<p><img src="https://note.youdao.com/yws/api/personal/file/WEBa96dfd23abb87ebdf59dd39d5081a7be?method=download&amp;shareKey=09bc64e9133e43f61c1651a59c9c92d7" alt="image"></p>
<ul>
<li>ä½œè€…ï¼šé»„ä¿Šå½¬ </li>
<li><a href="https://junbin.tech/" target="_blank" rel="noopener">åšå®¢ï¼šjunbin.tech</a></li>
<li><a href="https://github.com/junbin1011" target="_blank" rel="noopener">GitHub: junbin1011 </a></li>
<li><a href="https://www.zhihu.com/people/junbin-9-77" target="_blank" rel="noopener">çŸ¥ä¹: @JunBin</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://junbin1011.github.io/2020/04/21/Androidé¡¹ç›®æŒ‡å—/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="é»„ä¿Šå½¬">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://note.youdao.com/yws/api/personal/file/WEB917b08143504a6f8c96228312fcb5245?method=download&shareKey=03cb5c302c83b56bbb91668c5008444f">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JunBin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/04/21/Androidé¡¹ç›®æŒ‡å—/" itemprop="url">
                  Androidé¡¹ç›®æŒ‡å—
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2020-04-21T17:01:25+08:00">
                2020-04-21
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/04/21/Androidé¡¹ç›®æŒ‡å—/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2020/04/21/Androidé¡¹ç›®æŒ‡å—/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Githubåœ°å€ï¼š<a href="https://github.com/junbin1011/android-guidelines" target="_blank" rel="noopener">https://github.com/junbin1011/android-guidelines</a></p>
<h1 id="1-é¡¹ç›®æŒ‡å—"><a href="#1-é¡¹ç›®æŒ‡å—" class="headerlink" title="1. é¡¹ç›®æŒ‡å—"></a>1. é¡¹ç›®æŒ‡å—</h1><h2 id="1-1-é¡¹ç›®ç»“æ„"><a href="#1-1-é¡¹ç›®ç»“æ„" class="headerlink" title="1.1 é¡¹ç›®ç»“æ„"></a>1.1 é¡¹ç›®ç»“æ„</h2><p>æ–°é¡¹ç›®åº”éµå¾ª<a href="http://tools.android.com/tech-docs/new-build-system/user-guide#TOC-Project-Structure" target="_blank" rel="noopener">Android Gradleæ’ä»¶ç”¨æˆ·æŒ‡å—</a>ä¸­å®šä¹‰çš„Android Gradleé¡¹ç›®ç»“æ„ã€‚</p>
<h2 id="1-2-æ–‡ä»¶å"><a href="#1-2-æ–‡ä»¶å" class="headerlink" title="1.2 æ–‡ä»¶å"></a>1.2 æ–‡ä»¶å</h2><h3 id="1-2-1-ç±»å"><a href="#1-2-1-ç±»å" class="headerlink" title="1.2.1 ç±»å"></a>1.2.1 ç±»å</h3><p>ç±»åç”¨<a href="http://en.wikipedia.org/wiki/CamelCase" target="_blank" rel="noopener">UpperCamelCase</a>ç¼–å†™ã€‚<br>å¯¹äºæ‰©å±•Androidç»„ä»¶çš„ç±»ï¼Œè¯¥ç±»çš„åç§°åº”ä»¥è¯¥ç»„ä»¶çš„åç§°ç»“å°¾ï¼›ä¾‹å¦‚ï¼š<code>SignInActivity</code>ï¼Œ<code>SignInFragment</code>ï¼Œ<code>ImageUploaderService</code>ï¼Œ<code>ChangePasswordDialog</code>ã€‚</p>
<h3 id="1-2-2-èµ„æºæ–‡ä»¶"><a href="#1-2-2-èµ„æºæ–‡ä»¶" class="headerlink" title="1.2.2 èµ„æºæ–‡ä»¶"></a>1.2.2 èµ„æºæ–‡ä»¶</h3><p>èµ„æºæ–‡ä»¶åå†™åœ¨ <strong>lowercase_underscore</strong>.</p>
<h4 id="1-2-2-1-Drawable-æ–‡ä»¶"><a href="#1-2-2-1-Drawable-æ–‡ä»¶" class="headerlink" title="1.2.2.1 Drawable æ–‡ä»¶"></a>1.2.2.1 Drawable æ–‡ä»¶</h4><p>drawableså‘½åçº¦å®š:</p>
<table>
<thead>
<tr>
<th>Asset Type</th>
<th>Prefix</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td>Action bar</td>
<td><code>ab_</code></td>
<td><code>ab_stacked.9.png</code></td>
</tr>
<tr>
<td>Button</td>
<td><code>btn_</code></td>
<td><code>btn_send_pressed.9.png</code></td>
</tr>
<tr>
<td>Dialog</td>
<td><code>dialog_</code></td>
<td><code>dialog_top.9.png</code></td>
</tr>
<tr>
<td>Divider</td>
<td><code>divider_</code></td>
<td><code>divider_horizontal.9.png</code></td>
</tr>
<tr>
<td>Icon</td>
<td><code>ic_</code></td>
<td><code>ic_star.png</code></td>
</tr>
<tr>
<td>Menu</td>
<td><code>menu_</code></td>
<td><code>menu_submenu_bg.9.png</code></td>
</tr>
<tr>
<td>Notification</td>
<td><code>notification_</code></td>
<td><code>notification_bg.9.png</code></td>
</tr>
<tr>
<td>Tabs</td>
<td><code>tab_</code></td>
<td><code>tab_pressed.9.png</code></td>
</tr>
</tbody>
</table>
<p>iconså‘½åè§„èŒƒ (å‚è€ƒ <a href="http://developer.android.com/design/style/iconography.html" target="_blank" rel="noopener">Android iconography guidelines</a>):</p>
<table>
<thead>
<tr>
<th>Asset Type</th>
<th>Prefix</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td>Icons</td>
<td><code>ic_</code></td>
<td><code>ic_star.png</code></td>
</tr>
<tr>
<td>Launcher icons</td>
<td><code>ic_launcher</code></td>
<td><code>ic_launcher_calendar.png</code></td>
</tr>
<tr>
<td>Menu icons and Action Bar icons</td>
<td><code>ic_menu</code></td>
<td><code>ic_menu_archive.png</code></td>
</tr>
<tr>
<td>Status bar icons</td>
<td><code>ic_stat_notify</code></td>
<td><code>ic_stat_notify_msg.png</code></td>
</tr>
<tr>
<td>Tab icons</td>
<td><code>ic_tab</code></td>
<td><code>ic_tab_recent.png</code></td>
</tr>
<tr>
<td>Dialog icons</td>
<td><code>ic_dialog</code></td>
<td><code>ic_dialog_info.png</code></td>
</tr>
</tbody>
</table>
<p>selector stateså‘½åè§„èŒƒ:</p>
<table>
<thead>
<tr>
<th>State</th>
<th>Suffix</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td>Normal</td>
<td><code>_normal</code></td>
<td><code>btn_order_normal.9.png</code></td>
</tr>
<tr>
<td>Pressed</td>
<td><code>_pressed</code></td>
<td><code>btn_order_pressed.9.png</code></td>
</tr>
<tr>
<td>Focused</td>
<td><code>_focused</code></td>
<td><code>btn_order_focused.9.png</code></td>
</tr>
<tr>
<td>Disabled</td>
<td><code>_disabled</code></td>
<td><code>btn_order_disabled.9.png</code></td>
</tr>
<tr>
<td>Selected</td>
<td><code>_selected</code></td>
<td><code>btn_order_selected.9.png</code></td>
</tr>
</tbody>
</table>
<h4 id="1-2-2-2-Layout-æ–‡ä»¶"><a href="#1-2-2-2-Layout-æ–‡ä»¶" class="headerlink" title="1.2.2.2 Layout æ–‡ä»¶"></a>1.2.2.2 Layout æ–‡ä»¶</h4><p>å¸ƒå±€æ–‡ä»¶åº”ä¸è¦ä½¿ç”¨çš„Androidç»„ä»¶çš„åç§°åŒ¹é…ï¼Œä½†å°†é¡¶çº§ç»„ä»¶çš„åç§°ç§»åˆ°å¼€å¤´ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æ­£åœ¨ä¸ºåˆ›å»ºå¸ƒå±€<code>SignInActivity</code>ï¼Œåˆ™å¸ƒå±€æ–‡ä»¶çš„åç§°åº”ä¸º<code>activity_sign_in.xml</code>ã€‚</p>
<table>
<thead>
<tr>
<th>Component</th>
<th>Class Name</th>
<th>Layout Name</th>
</tr>
</thead>
<tbody>
<tr>
<td>Activity</td>
<td><code>UserProfileActivity</code></td>
<td><code>activity_user_profile.xml</code></td>
</tr>
<tr>
<td>Fragment</td>
<td><code>SignUpFragment</code></td>
<td><code>fragment_sign_up.xml</code></td>
</tr>
<tr>
<td>Dialog</td>
<td><code>ChangePasswordDialog</code></td>
<td><code>dialog_change_password.xml</code></td>
</tr>
<tr>
<td>AdapterView item</td>
<td>â€”</td>
<td><code>item_person.xml</code></td>
</tr>
<tr>
<td>Partial layout</td>
<td>â€”</td>
<td><code>partial_stats_bar.xml</code></td>
</tr>
</tbody>
</table>
<p>ç¨æœ‰ä¸åŒçš„æƒ…å†µæ˜¯ï¼Œå½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¸ƒå±€æ—¶ï¼Œè¯¥å¸ƒå±€å°†è¢«Adapterå¡«å……ï¼Œä¾‹å¦‚å¡«å……ListViewã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¸ƒå±€çš„åç§°åº”ä»¥å¼€å¤´<code>item_</code>ã€‚</p>
<p>è¯·æ³¨æ„ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹å°†æ— æ³•åº”ç”¨è¿™äº›è§„åˆ™ã€‚ä¾‹å¦‚ï¼Œåœ¨åˆ›å»ºå…¶ä»–å¸ƒå±€ä¸€éƒ¨åˆ†çš„å¸ƒå±€æ–‡ä»¶æ—¶ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨åº”è¯¥ä½¿ç”¨å‰ç¼€<code>partial_</code></p>
<h4 id="1-2-2-3-Menu-æ–‡ä»¶"><a href="#1-2-2-3-Menu-æ–‡ä»¶" class="headerlink" title="1.2.2.3 Menu æ–‡ä»¶"></a>1.2.2.3 Menu æ–‡ä»¶</h4><p>ä¸å¸ƒå±€æ–‡ä»¶ç±»ä¼¼ï¼Œèœå•æ–‡ä»¶åº”ä¸ç»„ä»¶åç§°åŒ¹é…ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬å®šä¹‰è¦åœ¨ä¸­ä½¿ç”¨çš„èœå•æ–‡ä»¶ï¼Œåˆ™<code>UserActivity</code>æ–‡ä»¶ååº”ä¸º<code>activity_user.xml</code></p>
<p>å¥½çš„åšæ³•æ˜¯ä¸è¦å°†å•è¯<code>menu</code>ä½œä¸ºåç§°çš„ä¸€éƒ¨åˆ†ï¼Œå› ä¸ºè¿™äº›æ–‡ä»¶å·²ç»ä½äº<code>menu</code>ç›®å½•ä¸­</p>
<h4 id="1-2-2-4-Values-æ–‡ä»¶"><a href="#1-2-2-4-Values-æ–‡ä»¶" class="headerlink" title="1.2.2.4 Values æ–‡ä»¶"></a>1.2.2.4 Values æ–‡ä»¶</h4><p>åœ¨æ–‡ä»¶å¤¹åº”è¯¥æ˜¯å€¼çš„èµ„æºæ–‡ä»¶å¤æ•°ï¼Œä¾‹å¦‚ <code>strings.xml</code>, <code>styles.xml</code>, <code>colors.xml</code>, <code>dimens.xml</code>, <code>attrs.xml</code></p>
<h1 id="2-ä»£ç æŒ‡å—"><a href="#2-ä»£ç æŒ‡å—" class="headerlink" title="2 ä»£ç æŒ‡å—"></a>2 ä»£ç æŒ‡å—</h1><h2 id="2-1-Java-è¯­è¨€è§„èŒƒ"><a href="#2-1-Java-è¯­è¨€è§„èŒƒ" class="headerlink" title="2.1 Java è¯­è¨€è§„èŒƒ"></a>2.1 Java è¯­è¨€è§„èŒƒ</h2><h3 id="2-1-1-ä¸è¦å¿½ç•¥å¼‚å¸¸"><a href="#2-1-1-ä¸è¦å¿½ç•¥å¼‚å¸¸" class="headerlink" title="2.1.1 ä¸è¦å¿½ç•¥å¼‚å¸¸"></a>2.1.1 ä¸è¦å¿½ç•¥å¼‚å¸¸</h3><p>ç¦æ­¢æ‰§è¡Œä»¥ä¸‹çš„æ“ä½œ:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setServerPort</span><span class="params">(String value)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        serverPort = Integer.parseInt(value);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (NumberFormatException e) &#123; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å°½ç®¡æ‚¨å¯èƒ½è®¤ä¸ºæ‚¨çš„ä»£ç æ°¸è¿œä¸ä¼šé‡åˆ°è¿™ç§é”™è¯¯æƒ…å†µï¼Œæˆ–è€…å¤„ç†å®ƒå¹¶ä¸é‡è¦ï¼Œä½†æ˜¯å¿½ç•¥ä¸Šè¿°å¼‚å¸¸ä¼šåœ¨ä»£ç ä¸­äº§ç”Ÿéšæ‚£ï¼Œè®©å…¶ä»–äººæœ‰ä¸€å¤©ä¼šè·³å…¥å‘ä¸­ã€‚æ‚¨å¿…é¡»ä»¥æŸç§åŸåˆ™å¤„ç†ä»£ç ä¸­çš„æ¯ä¸ªExceptionã€‚å…·ä½“å¤„ç†æ–¹å¼è§†æƒ…å†µè€Œå¼‚ã€‚-<a href="https://source.android.com/setup/contribute/code-style" target="_blank" rel="noopener">Androidç¨‹å¼ç è§„èŒƒ</a></p>
<p><a href="https://source.android.com/source/code-style.html#dont-ignore-exceptions" target="_blank" rel="noopener">åœ¨è¿™é‡Œ</a>æŸ¥çœ‹æ›¿ä»£æ–¹æ¡ˆ</p>
<h3 id="2-1-2-ä¸è¦æ•è·é€šç”¨å¼‚å¸¸"><a href="#2-1-2-ä¸è¦æ•è·é€šç”¨å¼‚å¸¸" class="headerlink" title="2.1.2 ä¸è¦æ•è·é€šç”¨å¼‚å¸¸"></a>2.1.2 ä¸è¦æ•è·é€šç”¨å¼‚å¸¸</h3><p>ä¸å»ºè®®æ‰§è¡Œä»¥ä¸‹çš„æ“ä½œ:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    someComplicatedIOFunction();        <span class="comment">// may throw IOException</span></span><br><span class="line">    someComplicatedParsingFunction();   <span class="comment">// may throw ParsingException</span></span><br><span class="line">    someComplicatedSecurityFunction();  <span class="comment">// may throw SecurityException</span></span><br><span class="line">    <span class="comment">// phew, made it all the way</span></span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;                 <span class="comment">// I'll just catch all exceptions</span></span><br><span class="line">    handleError();                      <span class="comment">// with one generic handler!</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨<a href="https://source.android.com/source/code-style.html#dont-catch-generic-exception" target="_blank" rel="noopener">è¿™é‡Œ</a>æŸ¥çœ‹åŸå› å’Œä¸€äº›æ›¿ä»£æ–¹æ¡ˆ</p>
<h3 id="2-1-3-ä¸è¦ä½¿ç”¨ç»ˆç»“å™¨"><a href="#2-1-3-ä¸è¦ä½¿ç”¨ç»ˆç»“å™¨" class="headerlink" title="2.1.3 ä¸è¦ä½¿ç”¨ç»ˆç»“å™¨"></a>2.1.3 ä¸è¦ä½¿ç”¨ç»ˆç»“å™¨</h3><p>ç»ˆç»“å™¨æ˜¯ä¸€ç§åœ¨åƒåœ¾å›æ”¶å¯¹è±¡æ—¶æ‰§è¡Œå¤§é‡ä»£ç çš„æ–¹æ³•ã€‚è™½ç„¶ç»ˆç»“å™¨å¯ä»¥å¾ˆæ–¹ä¾¿åœ°è¿›è¡Œæ¸…ç†ï¼ˆå°¤å…¶æ˜¯å¤–éƒ¨èµ„æºï¼‰ï¼Œä½†æ— æ³•ä¿è¯ä½•æ—¶è°ƒç”¨ç»ˆç»“å™¨ï¼ˆç”šè‡³æ ¹æœ¬ä¸ä¼šè°ƒç”¨ç»ˆç»“å™¨ï¼‰ã€‚</p>
<p>Androidä¸ä½¿ç”¨ç»ˆç»“å™¨ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è‰¯å¥½çš„å¼‚å¸¸å¤„ç†ã€‚å¦‚æœæ‚¨ç»å¯¹éœ€è¦ç»ˆç»“å™¨ï¼Œè¯·å®šä¹‰ä¸€ä¸ªclose()æ–¹æ³•ï¼ˆæˆ–ç±»ä¼¼æ–¹æ³•ï¼‰å¹¶ç¡®åˆ‡è®°å½•ä½•æ—¶éœ€è¦è°ƒç”¨è¯¥æ–¹æ³•ï¼ˆæœ‰å…³ç¤ºä¾‹ï¼Œè¯·å‚è§ InputStreamï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä»ç»ˆç»“å™¨æ‰“å°ä¸€æ¡ç®€çŸ­çš„æ—¥å¿—æ¶ˆæ¯æ˜¯é€‚å½“çš„ï¼Œä½†ä¸æ˜¯å¿…éœ€çš„ï¼Œåªè¦ä¸å¸Œæœ›å®ƒæ·¹æ²¡æ—¥å¿—å³å¯ã€‚ - (<a href="https://source.android.com/source/code-style.html#dont-use-finalizers" target="_blank" rel="noopener">Android code style guidelines</a>)</p>
<h3 id="2-1-4-ä½¿ç”¨å®Œæ•´çš„-imports"><a href="#2-1-4-ä½¿ç”¨å®Œæ•´çš„-imports" class="headerlink" title="2.1.4 ä½¿ç”¨å®Œæ•´çš„ imports"></a>2.1.4 ä½¿ç”¨å®Œæ•´çš„ imports</h3><p>ä¸å¥½çš„: <code>import foo.*;</code></p>
<p>å¥½çš„: <code>import foo.Bar;</code></p>
<p>æ›´å¤š <a href="https://source.android.com/source/code-style.html#fully-qualify-imports" target="_blank" rel="noopener">å‚è€ƒ</a></p>
<h2 id="2-2-Java-æ ·å¼è§„åˆ™"><a href="#2-2-Java-æ ·å¼è§„åˆ™" class="headerlink" title="2.2 Java æ ·å¼è§„åˆ™"></a>2.2 Java æ ·å¼è§„åˆ™</h2><h3 id="2-2-1-å­—æ®µå®šä¹‰å’Œå‘½å"><a href="#2-2-1-å­—æ®µå®šä¹‰å’Œå‘½å" class="headerlink" title="2.2.1 å­—æ®µå®šä¹‰å’Œå‘½å"></a>2.2.1 å­—æ®µå®šä¹‰å’Œå‘½å</h3><p>å­—æ®µåº”åœ¨æ–‡ä»¶é¡¶éƒ¨å®šä¹‰ï¼Œå¹¶ä¸”åº”éµå¾ªä¸‹é¢åˆ—å‡ºçš„å‘½åè§„åˆ™ã€‚</p>
<ul>
<li>ç§æœ‰éé™æ€å­—æ®µåç§°ä»¥må¼€å¤´ã€‚</li>
<li>ç§æœ‰é™æ€å­—æ®µåç§°ä»¥så¼€å¤´ã€‚</li>
<li>å…¶ä»–å­—æ®µä»¥å°å†™å­—æ¯å¼€å¤´ã€‚</li>
<li>é™æ€æœ€ç»ˆå­—æ®µï¼ˆå¸¸é‡ï¼‰ä¸ºALL_CAPS_WITH_UNDERSCORESã€‚</li>
</ul>
<p>Example:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> SOME_CONSTANT = <span class="number">42</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> publicField;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> MyClass sSingleton;</span><br><span class="line">    <span class="keyword">int</span> mPackagePrivate;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> mPrivate;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">int</span> mProtected;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-2-3-å°†ç¼©å†™è¯è§†ä¸ºå•è¯"><a href="#2-2-3-å°†ç¼©å†™è¯è§†ä¸ºå•è¯" class="headerlink" title="2.2.3 å°†ç¼©å†™è¯è§†ä¸ºå•è¯"></a>2.2.3 å°†ç¼©å†™è¯è§†ä¸ºå•è¯</h3><table>
<thead>
<tr>
<th>Good</th>
<th>Bad</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>XmlHttpRequest</code></td>
<td><code>XMLHTTPRequest</code></td>
</tr>
<tr>
<td><code>getCustomerId</code></td>
<td><code>getCustomerID</code></td>
</tr>
<tr>
<td><code>String url</code></td>
<td><code>String URL</code></td>
</tr>
<tr>
<td><code>long id</code></td>
<td><code>long ID</code></td>
</tr>
</tbody>
</table>
<h3 id="2-2-4-ä½¿ç”¨ç©ºæ ¼è¿›è¡Œç¼©è¿›"><a href="#2-2-4-ä½¿ç”¨ç©ºæ ¼è¿›è¡Œç¼©è¿›" class="headerlink" title="2.2.4 ä½¿ç”¨ç©ºæ ¼è¿›è¡Œç¼©è¿›"></a>2.2.4 ä½¿ç”¨ç©ºæ ¼è¿›è¡Œç¼©è¿›</h3><p>å¯¹å—ä½¿ç”¨4ä¸ªç©ºæ ¼ç¼©è¿›:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (x == <span class="number">1</span>) &#123;</span><br><span class="line">    x++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨8ä¸ªç©ºæ ¼ç¼©è¿›è¿›è¡Œæ¢è¡Œï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Instrument i =</span><br><span class="line">        someLongExpression(that, wouldNotFit, on, one, line);</span><br></pre></td></tr></table></figure>
<h3 id="2-2-5-ä½¿ç”¨æ ‡å‡†èŠ±æ‹¬å·æ ·å¼"><a href="#2-2-5-ä½¿ç”¨æ ‡å‡†èŠ±æ‹¬å·æ ·å¼" class="headerlink" title="2.2.5 ä½¿ç”¨æ ‡å‡†èŠ±æ‹¬å·æ ·å¼"></a>2.2.5 ä½¿ç”¨æ ‡å‡†èŠ±æ‹¬å·æ ·å¼</h3><p>èŠ±æ‹¬å·ä¸å®ƒä»¬å‰é¢çš„ä»£ç åœ¨åŒä¸€è¡Œã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">func</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (something) &#123;</span><br><span class="line">            <span class="comment">// ...</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (somethingElse) &#123;</span><br><span class="line">            <span class="comment">// ...</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// ...</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é™¤éæ¡ä»¶å’Œä¸»ä½“åˆè€Œä¸ºä¸€ï¼Œå¦åˆ™å¿…é¡»åœ¨è¯­å¥å‘¨å›´ä½¿ç”¨å¤§æ‹¬å·ã€‚</p>
<p>å¦‚æœæ¡ä»¶å’Œä¸»ä½“åˆåœ¨ä¸€æ¡çº¿ä¸Šï¼Œå¹¶ä¸”é‚£æ¡çº¿æ¯”æœ€å¤§çº¿é•¿çŸ­ï¼Œåˆ™ä¸éœ€è¦å¤§æ‹¬å·ï¼Œä¾‹å¦‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (condition) body();</span><br></pre></td></tr></table></figure>
<p>ä¸å¥½çš„:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (condition)</span><br><span class="line">    body();  <span class="comment">// bad!</span></span><br></pre></td></tr></table></figure>
<h3 id="2-2-6-Annotations"><a href="#2-2-6-Annotations" class="headerlink" title="2.2.6 Annotations"></a>2.2.6 Annotations</h3><h4 id="2-2-6-1-Annotations"><a href="#2-2-6-1-Annotations" class="headerlink" title="2.2.6.1 Annotations"></a>2.2.6.1 Annotations</h4><ul>
<li><p>@Overrideï¼šå½“æŸä¸ªæ–¹æ³•æ›¿æ¢äº†è¶…ç±»ä¸­çš„å£°æ˜æˆ–å®ç°æ—¶ï¼Œå¿…é¡»ä½¿ç”¨ @Override æ³¨é‡Šã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨ä½¿ç”¨ @inheritdocs Javadoc æ ‡è®°ï¼Œå¹¶ä¸”æ´¾ç”ŸäºæŸä¸ªç±»ï¼ˆè€Œéæ¥å£ï¼‰ï¼Œåˆ™å¿…é¡»å†ä¸ºæ–¹æ³•æ·»åŠ  @Override æ³¨é‡Šï¼Œè¯´æ˜è¯¥æ–¹æ³•æ›¿æ¢äº†çˆ¶ç±»çš„æ–¹æ³•ã€‚</p>
</li>
<li><p>@SuppressWarningsï¼š@SuppressWarnings æ³¨é‡Šåº”è¯¥ä»…åœ¨æ— æ³•æ¶ˆé™¤è­¦å‘Šçš„æƒ…å†µä¸‹ä½¿ç”¨ã€‚å¦‚æœæŸä¸ªè­¦å‘Šé€šè¿‡äº†â€œæ— æ³•æ¶ˆé™¤â€æµ‹è¯•ï¼Œåˆ™å¿…é¡»ä½¿ç”¨ @SuppressWarnings æ³¨é‡Šï¼Œä»¥ç¡®ä¿æ‰€æœ‰è­¦å‘Šéƒ½ä¼šåæ˜ å‡ºä»£ç ä¸­çš„å®é™…é—®é¢˜ã€‚</p>
</li>
</ul>
<p>æœ‰å…³æ³¨é‡Šå‡†åˆ™çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§<a href="http://source.android.com/source/code-style.html#use-standard-java-annotations" target="_blank" rel="noopener">æ­¤å¤„</a>ã€‚</p>
<h4 id="2-2-6-2-Annotations-é£æ ¼"><a href="#2-2-6-2-Annotations-é£æ ¼" class="headerlink" title="2.2.6.2 Annotations é£æ ¼"></a>2.2.6.2 Annotations é£æ ¼</h4><p><strong>Classes, Methods and Constructors</strong></p>
<p>å°†Annotationåº”ç”¨äºç±»ï¼Œæ–¹æ³•æˆ–æ„é€ å‡½æ•°æ—¶ï¼Œæ¯è¡Œæ˜¾ç¤ºä¸€ä¸ªAnnotationã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* This is the documentation block about the class */</span></span><br><span class="line"><span class="meta">@AnnotationA</span></span><br><span class="line"><span class="meta">@AnnotationB</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyAnnotatedClass</span> </span>&#123; &#125;</span><br></pre></td></tr></table></figure>
<p><strong>Fields</strong></p>
<p>é™¤éè¡Œè¾¾åˆ°æœ€å¤§è¡Œé•¿ï¼Œå¦åˆ™åº”ç”¨äºå­—æ®µçš„ Annotationåº”åœ¨åŒä¸€è¡Œä¸Šåˆ—å‡ºã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Nullable</span> <span class="meta">@Mock</span> DataManager mDataManager;</span><br></pre></td></tr></table></figure>
<h3 id="2-2-7-é™åˆ¶å˜é‡çš„ä½œç”¨åŸŸ"><a href="#2-2-7-é™åˆ¶å˜é‡çš„ä½œç”¨åŸŸ" class="headerlink" title="2.2.7 é™åˆ¶å˜é‡çš„ä½œç”¨åŸŸ"></a>2.2.7 é™åˆ¶å˜é‡çš„ä½œç”¨åŸŸ</h3><p>å°½å¯èƒ½ç¼©å°å±€éƒ¨å˜é‡çš„ä½œç”¨åŸŸã€‚è¿™æ ·åšæœ‰åŠ©äºæé«˜ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œå¹¶é™ä½å‡ºé”™çš„å¯èƒ½æ€§ã€‚åœ¨åŒ…å«å˜é‡æ‰€æœ‰ä½¿ç”¨æƒ…å½¢çš„æœ€å†…å±‚çš„å—ä¸­å£°æ˜æ¯ä¸ªå˜é‡ã€‚</p>
<p>åœ¨é¦–æ¬¡ä½¿ç”¨çš„ä½ç½®å£°æ˜å±€éƒ¨å˜é‡ã€‚å‡ ä¹æ¯ä¸ªå±€éƒ¨å˜é‡å£°æ˜éƒ½åº”è¯¥åŒ…å«ä¸€ä¸ªåˆå§‹åŒ–ç¨‹åºã€‚å¦‚æœæ‚¨è¿˜æ²¡æœ‰è¶³å¤Ÿçš„ä¿¡æ¯æ¥åˆç†åœ°åˆå§‹åŒ–æŸä¸ªå˜é‡ï¼Œè¯·æ¨è¿Ÿåˆ°ä¿¡æ¯å……è¶³æ—¶å†å£°æ˜ã€‚ - (<a href="https://source.android.com/source/code-style.html#limit-variable-scope" target="_blank" rel="noopener">Android code style guidelines</a>)</p>
<h3 id="2-2-8-import-é¡ºåº"><a href="#2-2-8-import-é¡ºåº" class="headerlink" title="2.2.8 import é¡ºåº"></a>2.2.8 import é¡ºåº</h3><p>å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯Android Studioä¹‹ç±»çš„IDEï¼Œåˆ™ä¸å¿…æ‹…å¿ƒè¿™ä¸€ç‚¹ï¼Œå› ä¸ºæ‚¨çš„IDEå·²ç»éµå®ˆäº†è¿™äº›è§„åˆ™ã€‚å¦‚æœæ²¡æœ‰ï¼Œè¯·åœ¨ä¸‹é¢æŸ¥çœ‹ã€‚</p>
<p>å¯¼å…¥è¯­å¥çš„é¡ºåºä¸ºï¼š</p>
<ol>
<li>Androidå¯¼å…¥</li>
<li>ä»ç¬¬ä¸‰æ–¹ï¼ˆcomï¼Œjunitï¼Œnetï¼Œorgï¼‰å¯¼å…¥</li>
<li>javaå’Œjavax</li>
<li>åŒä¸€é¡¹ç›®è¿›å£</li>
</ol>
<p>ä¸ºäº†ä¸IDEè®¾ç½®å®Œå…¨åŒ¹é…ï¼Œå¯¼å…¥åº”ä¸ºï¼š</p>
<ul>
<li>åœ¨æ¯ä¸ªåˆ†ç»„ä¸­æŒ‰å­—æ¯é¡ºåºæ’åˆ—ï¼Œå¤§å†™å­—æ¯åœ¨å°å†™å­—æ¯ä¹‹å‰ï¼ˆä¾‹å¦‚Zåœ¨aä¹‹å‰ï¼‰ã€‚</li>
<li>æ¯ä¸ªä¸»è¦åˆ†ç»„ï¼ˆandroidï¼Œcomï¼Œjunitï¼Œnetï¼Œorgï¼Œjavaï¼Œjavaxï¼‰ä¹‹é—´åº”è¯¥æœ‰ä¸€ä¸ªç©ºç™½è¡Œã€‚<br>æ›´å¤šä¿¡æ¯å‚è€ƒ<a href="https://source.android.com/source/code-style.html#limit-variable-scope" target="_blank" rel="noopener">è¿™é‡Œ</a></li>
</ul>
<h3 id="2-2-9-Logging-æŒ‡å—"><a href="#2-2-9-Logging-æŒ‡å—" class="headerlink" title="2.2.9 Logging æŒ‡å—"></a>2.2.9 Logging æŒ‡å—</h3><p>ä½¿ç”¨Logè¯¥ç±»æä¾›çš„æ—¥å¿—è®°å½•æ–¹æ³•å¯ä»¥æ‰“å°å‡ºé”™è¯¯æ¶ˆæ¯æˆ–å…¶ä»–ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯å¯èƒ½å¯¹å¼€å‘äººå‘˜è¯†åˆ«é—®é¢˜å¾ˆæœ‰ç”¨ï¼š</p>
<ul>
<li><code>Log.v(String tag, String msg)</code> (verbose)</li>
<li><code>Log.d(String tag, String msg)</code> (debug)</li>
<li><code>Log.i(String tag, String msg)</code> (information)</li>
<li><code>Log.w(String tag, String msg)</code> (warning)</li>
<li><code>Log.e(String tag, String msg)</code> (error)</li>
</ul>
<p>é€šå¸¸ï¼Œæˆ‘ä»¬å°†ç±»åç§°ç”¨ä½œæ ‡è®°ï¼Œå¹¶å°†å…¶å®šä¹‰ä¸º<code>static final</code>æ–‡ä»¶é¡¶éƒ¨çš„å­—æ®µã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG = MyClass.class.getSimpleName();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">myMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Log.e(TAG, <span class="string">"My error message"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨å‘è¡Œç‰ˆæœ¬ä¸Šå¿…é¡»ç¦ç”¨VERBOSEå’ŒDEBUGæ—¥å¿—ã€‚è¿˜å»ºè®®ç¦ç”¨â€œä¿¡æ¯â€ï¼Œâ€œè­¦å‘Šâ€å’Œâ€œé”™è¯¯â€æ—¥å¿—ï¼Œä½†æ˜¯å¦‚æœæ‚¨è®¤ä¸ºå®ƒä»¬å¯¹äºç¡®å®šå‘è¡Œç‰ˆæœ¬ä¸­çš„é—®é¢˜å¯èƒ½æœ‰ç”¨ï¼Œåˆ™å¯èƒ½å¸Œæœ›ä½¿å…¶ä¿æŒå¯ç”¨çŠ¶æ€ã€‚å¦‚æœå†³å®šè®©å®ƒä»¬ä¿æŒå¯ç”¨çŠ¶æ€ï¼Œåˆ™å¿…é¡»ç¡®ä¿å®ƒä»¬æ²¡æœ‰æ³„æ¼ç§äººä¿¡æ¯ï¼Œä¾‹å¦‚ç”µå­é‚®ä»¶åœ°å€ï¼Œç”¨æˆ·IDç­‰ã€‚</p>
<p>ä»…åœ¨è°ƒè¯•ç‰ˆæœ¬ä¸Šæ˜¾ç¤ºæ—¥å¿—ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (BuildConfig.DEBUG) Log.d(TAG, <span class="string">"The value of x is "</span> + x);</span><br></pre></td></tr></table></figure>
<h3 id="2-2-10-ç±»æˆå‘˜æ’åº"><a href="#2-2-10-ç±»æˆå‘˜æ’åº" class="headerlink" title="2.2.10 ç±»æˆå‘˜æ’åº"></a>2.2.10 ç±»æˆå‘˜æ’åº</h3><p>ä½¿ç”¨é€»è¾‘å’Œä¸€è‡´çš„é¡ºåºå°†æé«˜ä»£ç çš„å¯å­¦ä¹ æ€§å’Œå¯è¯»æ€§ã€‚å»ºè®®ä½¿ç”¨ä»¥ä¸‹é¡ºåºï¼š</p>
<ol>
<li>Constants</li>
<li>Fields</li>
<li>Constructors</li>
<li>Override methods and callbacks (public or private)</li>
<li>Public methods</li>
<li>Private methods</li>
<li>Inner classes or interfaces</li>
</ol>
<p>ç¤ºä¾‹:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG = MainActivity.class.getSimpleName();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String mTitle;</span><br><span class="line">    <span class="keyword">private</span> TextView mTextViewTitle;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTitle</span><span class="params">(String title)</span> </span>&#123;</span><br><span class="line">    	mTitle = title;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setUpView</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">AnInnerClass</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæ‚¨çš„ç±»æ‰©å±•äº†è¯¸å¦‚Activityæˆ–Fragmentä¹‹ç±»çš„Androidç»„ä»¶ï¼Œåˆ™æœ€å¥½å¯¹è¦†ç›–æ–¹æ³•è¿›è¡Œæ’åºï¼Œä»¥ä½¿å…¶ä¸ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸç›¸åŒ¹é…ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ªæ´»åŠ¨å®ç°<code>onCreate()</code>ï¼Œ<code>onDestroy()</code>ï¼Œ<code>onPause()</code>å’Œ<code>onResume()</code>ï¼Œç„¶åæŒ‰ç…§æ­£ç¡®çš„é¡ºåºæ˜¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//Order matches Activity lifecycle</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onResume</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPause</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-2-11-æ–¹æ³•ä¸­çš„å‚æ•°æ’åº"><a href="#2-2-11-æ–¹æ³•ä¸­çš„å‚æ•°æ’åº" class="headerlink" title="2.2.11 æ–¹æ³•ä¸­çš„å‚æ•°æ’åº"></a>2.2.11 æ–¹æ³•ä¸­çš„å‚æ•°æ’åº</h3><p>åœ¨ä¸ºAndroidç¼–ç¨‹æ—¶ï¼Œå®šä¹‰å¸¦æœ‰çš„æ–¹æ³•æ˜¯å¾ˆæ™®éçš„Contextã€‚å¦‚æœè¦ç¼–å†™è¿™æ ·çš„æ–¹æ³•ï¼Œåˆ™Contextå¿…é¡»æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°ã€‚</p>
<p>ç›¸åçš„æƒ…å†µæ˜¯CallBackå§‹ç»ˆä¸ºæœ€åä¸€ä¸ªå‚æ•°ã€‚</p>
<p>ç¤ºä¾‹:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Context always goes first</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> User <span class="title">loadUser</span><span class="params">(Context context, <span class="keyword">int</span> userId)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Callbacks always go last</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadUserAsync</span><span class="params">(Context context, <span class="keyword">int</span> userId, UserCallback callback)</span></span>;</span><br></pre></td></tr></table></figure>
<h3 id="2-2-13-å­—ç¬¦ä¸²å¸¸é‡ï¼Œå‘½åå’Œå€¼"><a href="#2-2-13-å­—ç¬¦ä¸²å¸¸é‡ï¼Œå‘½åå’Œå€¼" class="headerlink" title="2.2.13 å­—ç¬¦ä¸²å¸¸é‡ï¼Œå‘½åå’Œå€¼"></a>2.2.13 å­—ç¬¦ä¸²å¸¸é‡ï¼Œå‘½åå’Œå€¼</h3><p>ä¾‹å¦‚Android SDKä¸­çš„è®¸å¤šå…ƒç´ SharedPreferencesï¼ŒBundleæˆ–Intentä½¿ç”¨ä¸€ä¸ªé”®å€¼å¯¹çš„æ–¹å¼ï¼Œå› æ­¤å¾ˆå¯èƒ½ï¼Œå³ä½¿æ˜¯ä¸€ä¸ªå°åº”ç”¨ç¨‹åºï¼Œä½ æœ€ç»ˆä¸å¾—ä¸å†™äº†å¾ˆå¤šå­—ç¬¦ä¸²å¸¸é‡ã€‚</p>
<p>ä½¿ç”¨è¿™äº›ç»„ä»¶ä¹‹ä¸€æ—¶ï¼Œå¿…é¡»å°†é”®å®šä¹‰ä¸ºstatic finalå­—æ®µï¼Œå¹¶ä¸”å®ƒä»¬çš„å‰ç¼€åº”å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<table>
<thead>
<tr>
<th>Element</th>
<th>Field Name Prefix</th>
</tr>
</thead>
<tbody>
<tr>
<td>SharedPreferences</td>
<td><code>PREF_</code></td>
</tr>
<tr>
<td>Bundle</td>
<td><code>BUNDLE_</code></td>
</tr>
<tr>
<td>Fragment Arguments</td>
<td><code>ARGUMENT_</code></td>
</tr>
<tr>
<td>Intent Extra</td>
<td><code>EXTRA_</code></td>
</tr>
<tr>
<td>Intent Action</td>
<td><code>ACTION_</code></td>
</tr>
</tbody>
</table>
<p>è¯·æ³¨æ„ï¼ŒFragmentçš„å‚æ•°Fragment.getArguments()ä¹Ÿæ˜¯Bundleã€‚ä½†æ˜¯ï¼Œç”±äºè¿™æ˜¯Bundleçš„éå¸¸æ™®éçš„ç”¨æ³•ï¼Œå› æ­¤æˆ‘ä»¬ä¸ºå®ƒä»¬å®šä¹‰äº†ä¸åŒçš„å‰ç¼€ã€‚</p>
<p>Example:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Note the value of the field is the same as the name to avoid duplication issues</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> String PREF_EMAIL = <span class="string">"PREF_EMAIL"</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> String BUNDLE_AGE = <span class="string">"BUNDLE_AGE"</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> String ARGUMENT_USER_ID = <span class="string">"ARGUMENT_USER_ID"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Intent-related items use full package name as value</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> String EXTRA_SURNAME = <span class="string">"com.myapp.extras.EXTRA_SURNAME"</span>;</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> String ACTION_OPEN_USER = <span class="string">"com.myapp.action.ACTION_OPEN_USER"</span>;</span><br></pre></td></tr></table></figure>
<h3 id="2-2-14-Fragments-å’Œ-Activities"><a href="#2-2-14-Fragments-å’Œ-Activities" class="headerlink" title="2.2.14  Fragments å’Œ Activities"></a>2.2.14  Fragments å’Œ Activities</h3><p>é€šè¿‡æˆ‘ä»¬ä¼šå®šä¹‰ä¸€ä¸ª <code>getStartIntent()</code>æ–¹æ³•ç”¨äºå¯åŠ¨Activity:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Intent <span class="title">getStartIntent</span><span class="params">(Context context, User user)</span> </span>&#123;</span><br><span class="line">	Intent intent = <span class="keyword">new</span> Intent(context, ThisActivity.class);</span><br><span class="line">	intent.putParcelableExtra(EXTRA_USER, user);</span><br><span class="line">	<span class="keyword">return</span> intent;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯¹äºFragmentsï¼Œå®ƒè¢«å‘½å<code>newInstance()</code>å¹¶ä½¿ç”¨æ­£ç¡®çš„å‚æ•°å¤„ç†Fragmentçš„åˆ›å»ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> UserFragment <span class="title">newInstance</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">	UserFragment fragment = <span class="keyword">new</span> UserFragment();</span><br><span class="line">	Bundle args = <span class="keyword">new</span> Bundle();</span><br><span class="line">	args.putParcelable(ARGUMENT_USER, user);</span><br><span class="line">	fragment.setArguments(args)</span><br><span class="line">	<span class="keyword">return</span> fragment;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>æ³¨æ„1</strong>ï¼šè¿™äº›æ–¹æ³•åº”è¯¥æ”¾åœ¨ç±»çš„é¡¶éƒ¨onCreate()ã€‚</p>
<p><strong>æ³¨æ„2</strong>ï¼šå¦‚æœæˆ‘ä»¬æä¾›ä¸Šè¿°æ–¹æ³•ï¼Œåˆ™Extraså’Œargumentsçš„é”®åº”è¯¥æ˜¯privateå› ä¸ºä¸éœ€è¦å°†å®ƒä»¬æš´éœ²åœ¨ç±»ä¹‹å¤–ã€‚</p>
<h3 id="2-2-15-ä»£ç è¡Œé•¿åº¦é™åˆ¶"><a href="#2-2-15-ä»£ç è¡Œé•¿åº¦é™åˆ¶" class="headerlink" title="2.2.15 ä»£ç è¡Œé•¿åº¦é™åˆ¶"></a>2.2.15 ä»£ç è¡Œé•¿åº¦é™åˆ¶</h3><p>ä»£ç è¡Œä¸å¾—è¶…è¿‡100ä¸ªå­—ç¬¦ã€‚å¦‚æœè¡Œçš„é•¿åº¦è¶…è¿‡æ­¤é™åˆ¶ï¼Œé€šå¸¸æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥å‡å°å…¶é•¿åº¦ï¼š</p>
<ul>
<li>æå–å±€éƒ¨å˜é‡æˆ–æ–¹æ³•ï¼ˆé¦–é€‰ï¼‰ã€‚</li>
<li>åº”ç”¨æ¢è¡Œå°†å•è¡Œåˆ†æˆå¤šè¡Œã€‚</li>
</ul>
<p>å¯èƒ½æœ‰è¶…è¿‡100è¡Œçš„è¡Œæœ‰ä¸¤ä¸ªä¾‹å¤–ï¼š</p>
<ul>
<li>ä¸èƒ½æ‹†åˆ†çš„è¡Œï¼Œä¾‹å¦‚æ³¨é‡Šä¸­çš„é•¿URLã€‚</li>
<li>packageå’Œimportå£°æ˜ã€‚</li>
</ul>
<h4 id="2-2-15-1-æ¢è¡Œç­–ç•¥"><a href="#2-2-15-1-æ¢è¡Œç­–ç•¥" class="headerlink" title="2.2.15.1 æ¢è¡Œç­–ç•¥"></a>2.2.15.1 æ¢è¡Œç­–ç•¥</h4><p>æ²¡æœ‰ä¸€ä¸ªç¡®åˆ‡çš„è§„åˆ™å¯ä»¥çº¦å®šæ¢è¡Œï¼Œé€šå¸¸æœ‰ä¸åŒçš„å®šä¹‰æ–¹å¼ã€‚ä½†æ˜¯ï¼Œæœ‰ä¸€äº›è§„åˆ™å¯ä»¥åº”ç”¨äºå¸¸è§æƒ…å†µ</p>
<p><strong>Break at operators</strong></p>
<p>å½“è¡Œçš„ç»“æŸæ˜¯æ“ä½œç¬¦æ—¶ï¼Œåœ¨æ“ä½œç¬¦ä¹‹å‰æ¢è¡Œï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> longName = anotherVeryLongVariable + anEvenLongerOne - thisRidiculousLongOne</span><br><span class="line">        + theFinalOne;</span><br></pre></td></tr></table></figure>
<p><strong>Assignment Operator Exception</strong></p>
<p><code>break at operators</code>è§„åˆ™çš„ä¸€ä¸ªä¾‹å¤–æ˜¯èµ‹å€¼è¿ç®—ç¬¦=ï¼Œå…¶ä¸­æ¢è¡Œç¬¦åº”åœ¨è¿ç®—ç¬¦ä¹‹åå‘ç”Ÿã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> longName =</span><br><span class="line">        anotherVeryLongVariable + anEvenLongerOne - thisRidiculousLongOne + theFinalOne;</span><br></pre></td></tr></table></figure>
<p><strong>æ–¹æ³•é“¾å¼è°ƒç”¨</strong></p>
<p>å½“å¤šä¸ªæ–¹æ³•é“¾æ¥åœ¨åŒä¸€è¡Œä¸­æ—¶ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨Buildersæ—¶ï¼‰ï¼Œå¯¹æ–¹æ³•çš„æ¯æ¬¡è°ƒç”¨éƒ½åº”åœ¨è‡ªå·±çš„è¡Œä¸­è¿›è¡Œï¼Œåœ¨  <code>.</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Picasso.with(context).load(<span class="string">"http://ribot.co.uk/images/sexyjoe.jpg"</span>).into(imageView);</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Picasso.with(context)</span><br><span class="line">        .load(<span class="string">"http://ribot.co.uk/images/sexyjoe.jpg"</span>)</span><br><span class="line">        .into(imageView);</span><br></pre></td></tr></table></figure>
<p><strong>é•¿å‚æ•°æƒ…å†µ</strong></p>
<p>å½“ä¸€ä¸ªæ–¹æ³•æœ‰å¾ˆå¤šå‚æ•°æˆ–å®ƒçš„å‚æ•°å¾ˆé•¿æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨æ¯ä¸ªé€—å·åæ¢è¡Œ <code>,</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">loadPicture(context, <span class="string">"http://ribot.co.uk/images/sexyjoe.jpg"</span>, mImageViewProfilePicture, clickListener, <span class="string">"Title of the picture"</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">loadPicture(context,</span><br><span class="line">        <span class="string">"http://ribot.co.uk/images/sexyjoe.jpg"</span>,</span><br><span class="line">        mImageViewProfilePicture,</span><br><span class="line">        clickListener,</span><br><span class="line">        <span class="string">"Title of the picture"</span>);</span><br></pre></td></tr></table></figure>
<h3 id="2-2-16-RxJava-é“¾å¼é£æ ¼"><a href="#2-2-16-RxJava-é“¾å¼é£æ ¼" class="headerlink" title="2.2.16 RxJava é“¾å¼é£æ ¼"></a>2.2.16 RxJava é“¾å¼é£æ ¼</h3><p>è¿ç®—ç¬¦çš„Rxé“¾éœ€è¦æ¢è¡Œã€‚æ¯ä¸ªæ“ä½œå‘˜éƒ½å¿…é¡»æ¢è¡Œï¼Œå¹¶ä¸”åœ¨æ¢è¡Œä¹‹å‰ç”¨<code>.</code>æ–­å¼€</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Observable&lt;Location&gt; <span class="title">syncLocations</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> mDatabaseHelper.getAllLocations()</span><br><span class="line">            .concatMap(<span class="keyword">new</span> Func1&lt;Location, Observable&lt;? extends Location&gt;&gt;() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                 <span class="keyword">public</span> Observable&lt;? extends Location&gt; call(Location location) &#123;</span><br><span class="line">                     <span class="keyword">return</span> mRetrofitService.getLocation(location.id);</span><br><span class="line">                 &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            .retry(<span class="keyword">new</span> Func2&lt;Integer, Throwable, Boolean&gt;() &#123;</span><br><span class="line">                 <span class="meta">@Override</span></span><br><span class="line">                 <span class="function"><span class="keyword">public</span> Boolean <span class="title">call</span><span class="params">(Integer numRetries, Throwable throwable)</span> </span>&#123;</span><br><span class="line">                     <span class="keyword">return</span> throwable <span class="keyword">instanceof</span> RetrofitError;</span><br><span class="line">                 &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-3-XML-æ ·å¼è§„åˆ™"><a href="#2-3-XML-æ ·å¼è§„åˆ™" class="headerlink" title="2.3 XML æ ·å¼è§„åˆ™"></a>2.3 XML æ ·å¼è§„åˆ™</h2><h3 id="2-3-1-ä½¿ç”¨è‡ªåŠ¨å…³é—­æ ‡ç­¾"><a href="#2-3-1-ä½¿ç”¨è‡ªåŠ¨å…³é—­æ ‡ç­¾" class="headerlink" title="2.3.1 ä½¿ç”¨è‡ªåŠ¨å…³é—­æ ‡ç­¾"></a>2.3.1 ä½¿ç”¨è‡ªåŠ¨å…³é—­æ ‡ç­¾</h3><p>å½“XMLå…ƒç´ æ²¡æœ‰ä»»ä½•å†…å®¹æ—¶ï¼Œå¿…é¡»ä½¿ç”¨è‡ªé—­æ ‡ç­¾.</p>
<p>å¥½çš„:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">	<span class="attr">android:id</span>=<span class="string">"@+id/text_view_profile"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>ä¸å¥½ :</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Don\'t do this! --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">"@+id/text_view_profile"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">TextView</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="2-3-2-Resources-åç§°"><a href="#2-3-2-Resources-åç§°" class="headerlink" title="2.3.2 Resources åç§°"></a>2.3.2 Resources åç§°</h3><p>èµ„æºIDå’Œåç§°å†™åœ¨ <strong>lowercase_underscore</strong>.</p>
<h4 id="2-3-2-1-ID-åç§°"><a href="#2-3-2-1-ID-åç§°" class="headerlink" title="2.3.2.1 ID åç§°"></a>2.3.2.1 ID åç§°</h4><p>IDåº”è¯¥åœ¨å…ƒç´ çš„åç§°å‰åŠ ä¸Šå°å†™çš„ä¸‹åˆ’çº¿ã€‚ä¾‹å¦‚ï¼š</p>
<table>
<thead>
<tr>
<th>Element</th>
<th>Prefix</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>TextView</code></td>
<td><code>text_</code></td>
</tr>
<tr>
<td><code>ImageView</code></td>
<td><code>image_</code></td>
</tr>
<tr>
<td><code>Button</code></td>
<td><code>button_</code></td>
</tr>
<tr>
<td><code>Menu</code></td>
<td><code>menu_</code></td>
</tr>
</tbody>
</table>
<p>Image view example:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">"@+id/image_profile"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>Menu example:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">menu</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">item</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/menu_done"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:title</span>=<span class="string">"Done"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">menu</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="2-3-2-2-Strings"><a href="#2-3-2-2-Strings" class="headerlink" title="2.3.2.2 Strings"></a>2.3.2.2 Strings</h4><p>å­—ç¬¦ä¸²åç§°ä»¥æ ‡è¯†å®ƒä»¬æ‰€å±éƒ¨åˆ†çš„å‰ç¼€å¼€å¤´ã€‚ä¾‹å¦‚<code>registration_email_hint</code>æˆ–<code>registration_name_hint</code>ã€‚å¦‚æœå­—ç¬¦ä¸²ä¸å±äºä»»ä½•éƒ¨åˆ†ï¼Œåˆ™åº”éµå¾ªä»¥ä¸‹è§„åˆ™ï¼š</p>
<table>
<thead>
<tr>
<th>Prefix</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>error_</code></td>
<td>An error message</td>
</tr>
<tr>
<td><code>msg_</code></td>
<td>A regular information message</td>
</tr>
<tr>
<td><code>title_</code></td>
<td>A title, i.e. a dialog title</td>
</tr>
<tr>
<td><code>action_</code></td>
<td>An action such as â€œSaveâ€ or â€œCreateâ€</td>
</tr>
</tbody>
</table>
<h4 id="2-3-2-3-æ ·å¼å’Œä¸»é¢˜"><a href="#2-3-2-3-æ ·å¼å’Œä¸»é¢˜" class="headerlink" title="2.3.2.3 æ ·å¼å’Œä¸»é¢˜"></a>2.3.2.3 æ ·å¼å’Œä¸»é¢˜</h4><p>ä¸å…¶ä»–èµ„æºä¸åŒï¼Œæ ·å¼åç§°æ˜¯ä½¿ç”¨ <strong>UpperCamelCase</strong> ç¼–å†™çš„</p>
<h3 id="2-3-3-å±æ€§æ’åº"><a href="#2-3-3-å±æ€§æ’åº" class="headerlink" title="2.3.3 å±æ€§æ’åº"></a>2.3.3 å±æ€§æ’åº</h3><p>é€šå¸¸ï¼Œæ‚¨åº”è¯¥å°è¯•å°†ç›¸ä¼¼çš„å±æ€§åˆ†ç»„åœ¨ä¸€èµ·ã€‚æ’åºæœ€å¸¸è§å±æ€§çš„ä¸€ç§å¥½æ–¹æ³•æ˜¯ï¼š</p>
<ol>
<li>View Id</li>
<li>Style</li>
<li>Layout width and layout height</li>
<li>Other layout attributes, sorted alphabetically</li>
<li>Remaining attributes, sorted alphabetically</li>
</ol>
<h2 id="2-4-æµ‹è¯•è§„åˆ™"><a href="#2-4-æµ‹è¯•è§„åˆ™" class="headerlink" title="2.4 æµ‹è¯•è§„åˆ™"></a>2.4 æµ‹è¯•è§„åˆ™</h2><h3 id="2-4-1-å•å…ƒæµ‹è¯•"><a href="#2-4-1-å•å…ƒæµ‹è¯•" class="headerlink" title="2.4.1 å•å…ƒæµ‹è¯•"></a>2.4.1 å•å…ƒæµ‹è¯•</h3><p>æµ‹è¯•ç±»åº”ä¸æµ‹è¯•æ‰€é’ˆå¯¹çš„ç±»çš„åç§°ç›¸åŒ¹é…ï¼Œåè·ŸTestã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåŒ…å«é’ˆå¯¹çš„æµ‹è¯•çš„æµ‹è¯•ç±»ï¼ŒDatabaseHelperåˆ™åº”å°†å…¶å‘½åä¸ºDatabaseHelperTestã€‚</p>
<p>æµ‹è¯•æ–¹æ³•å¸¦æœ‰æ³¨é‡Šï¼Œ@Testå¹¶ä¸”é€šå¸¸åº”ä»¥è¢«æµ‹è¯•æ–¹æ³•çš„åç§°å¼€å¤´ï¼Œåè·Ÿå‰ææ¡ä»¶å’Œ/æˆ–é¢„æœŸè¡Œä¸ºã€‚</p>
<p>æ¨¡æ¿ï¼š@Test void methodNamePreconditionExpectedBehaviour()</p>
<p>ä¾‹ï¼š @Test void signInWithEmptyEmailFails()</p>
<p>å¦‚æœæ²¡æœ‰å®ƒä»¬ï¼Œæµ‹è¯•å°±è¶³å¤Ÿæ¸…æ¥šï¼Œåˆ™ä¸ä¸€å®šæ€»æ˜¯éœ€è¦å‰ææ¡ä»¶å’Œ/æˆ–é¢„æœŸçš„è¡Œä¸ºã€‚</p>
<p>æœ‰æ—¶ï¼Œä¸€ä¸ªç±»å¯èƒ½åŒ…å«å¤§é‡æ–¹æ³•ï¼Œè€ŒåŒæ—¶æ¯ç§æ–¹æ³•éœ€è¦è¿›è¡Œå¤šæ¬¡æµ‹è¯•ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå»ºè®®å°†æµ‹è¯•ç±»åˆ†æˆå¤šä¸ªç±»ã€‚ä¾‹å¦‚ï¼Œå¦‚æœDataManageråŒ…å«äº†å¾ˆå¤šæˆ‘ä»¬å¯èƒ½éœ€è¦æŠŠå®ƒåˆ†æˆæ–¹æ³•DataManagerSignInTestï¼ŒDataManagerLoadUsersTestç­‰ç­‰ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œä½ å°†èƒ½å¤Ÿçœ‹åˆ°å“ªäº›æµ‹è¯•å±äºä¸€ä¸ªæ•´ä½“ï¼Œå› ä¸ºä»–ä»¬æœ‰å…±åŒçš„<a href="https://en.wikipedia.org/wiki/Test_fixture" target="_blank" rel="noopener">test fixtures</a>.</p>
<h3 id="2-4-2-Espresso-æµ‹è¯•"><a href="#2-4-2-Espresso-æµ‹è¯•" class="headerlink" title="2.4.2 Espresso æµ‹è¯•"></a>2.4.2 Espresso æµ‹è¯•</h3><p>æ¯ä¸ªEspressoæµ‹è¯•ç±»é€šå¸¸éƒ½ä»¥Activityä¸ºç›®æ ‡ï¼Œå› æ­¤åç§°åº”ä¸ç›®æ ‡Activityçš„åç§°åŒ¹é…ï¼Œåè·ŸTestï¼Œä¾‹å¦‚<code>SignInActivityTest</code></p>
<p>ä½¿ç”¨Espresso APIæ—¶ï¼Œé€šå¸¸å°†é“¾æ¥æ–¹æ³•æ”¾åœ¨æ–°è¡Œä¸­ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">onView(withId(R.id.view))</span><br><span class="line">        .perform(scrollTo())</span><br><span class="line">        .check(matches(isDisplayed()))</span><br></pre></td></tr></table></figure>
<h2 id="å…³äº"><a href="#å…³äº" class="headerlink" title="å…³äº"></a>å…³äº</h2><p><strong>æ¬¢è¿å…³æ³¨æˆ‘çš„ä¸ªäººå…¬ä¼—å·</strong></p>
<p>å¾®ä¿¡æœç´¢ï¼š<strong>ä¸€ç ä¸€æµ®ç”Ÿ</strong>ï¼Œæˆ–è€…æœç´¢å…¬ä¼—å·ID:<strong>life2code</strong></p>
<p><img src="https://note.youdao.com/yws/api/personal/file/WEBa96dfd23abb87ebdf59dd39d5081a7be?method=download&amp;shareKey=09bc64e9133e43f61c1651a59c9c92d7" alt></p>
<ul>
<li>ä½œè€…ï¼šé»„ä¿Šå½¬ </li>
<li><a href="https://junbin.tech/" target="_blank" rel="noopener">åšå®¢ï¼šjunbin.tech</a></li>
<li><a href="https://github.com/junbin1011" target="_blank" rel="noopener">GitHub: junbin1011 </a></li>
<li><a href="https://www.zhihu.com/people/junbin-9-77" target="_blank" rel="noopener">çŸ¥ä¹: @JunBin</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://junbin1011.github.io/2020/03/16/clean-code-java-ä½ éƒ½ä¼šäº†å—ï¼Ÿ/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="é»„ä¿Šå½¬">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://note.youdao.com/yws/api/personal/file/WEB917b08143504a6f8c96228312fcb5245?method=download&shareKey=03cb5c302c83b56bbb91668c5008444f">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JunBin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/03/16/clean-code-java-ä½ éƒ½ä¼šäº†å—ï¼Ÿ/" itemprop="url">
                  clean-code-java ä½ éƒ½ä¼šäº†å—ï¼Ÿ
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2020-03-16T08:38:32+08:00">
                2020-03-16
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/03/16/clean-code-java-ä½ éƒ½ä¼šäº†å—ï¼Ÿ/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2020/03/16/clean-code-java-ä½ éƒ½ä¼šäº†å—ï¼Ÿ/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="ä»£ç æ•´æ´çš„-Java"><a href="#ä»£ç æ•´æ´çš„-Java" class="headerlink" title="ä»£ç æ•´æ´çš„-Java"></a>ä»£ç æ•´æ´çš„-Java</h1><p><strong>Githubåœ°å€ï¼š</strong> <a href="https://github.com/junbin1011/clean-code-java" target="_blank" rel="noopener">https://github.com/junbin1011/clean-code-java</a></p>
<h2 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h2><ol>
<li><a href="#ç®€ä»‹">ç®€ä»‹</a></li>
<li><a href="#å˜é‡">å˜é‡</a></li>
<li><a href="#å‡½æ•°">å‡½æ•°</a></li>
<li><a href="#å¯¹è±¡å’Œæ•°æ®ç»“æ„">å¯¹è±¡å’Œæ•°æ®ç»“æ„</a></li>
<li><a href="#ç±»">ç±»</a></li>
<li><a href="#solid">SOLID</a></li>
<li><a href="#æµ‹è¯•">æµ‹è¯•</a></li>
<li><a href="#é”™è¯¯å¤„ç†">é”™è¯¯å¤„ç†</a></li>
<li><a href="#æ ¼å¼åŒ–">æ ¼å¼åŒ–</a></li>
<li><a href="#æ³¨é‡Š">æ³¨é‡Š</a></li>
<li><a href="#å·¥å…·">å·¥å…·</a></li>
</ol>
<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p><img src="https://user-gold-cdn.xitu.io/2020/3/1/17093d303918263e?w=500&amp;h=471&amp;f=jpeg&amp;s=45533" alt="ä¸€å¼ ç”¨ä½ é˜…è¯»ä»£ç æ—¶åæ§½çš„æ•°é‡æ¥è¯„ä¼°è½¯ä»¶è´¨é‡çš„æç¬‘å›¾ç‰‡"></p>
<p>å°†æºè‡ª Robert C. Martin çš„ <a href="https://www.amazon.com/Clean-Code-Handbook-Software-Craftsmanship/dp/0132350882" target="_blank" rel="noopener"><em>Clean Code</em></a><br>çš„è½¯ä»¶å·¥ç¨‹åŸåˆ™é€‚é…åˆ° Java ã€‚ è¿™ä¸æ˜¯ä¸€ä¸ªä»£ç é£æ ¼æŒ‡å—ï¼Œ å®ƒæ˜¯ä¸€ä¸ªä½¿ç”¨ Java æ¥ç”Ÿäº§<br>å¯è¯»çš„, å¯é‡ç”¨çš„, ä»¥åŠå¯é‡æ„çš„è½¯ä»¶çš„æŒ‡å—ã€‚</p>
<p>è¿™é‡Œçš„æ¯ä¸€é¡¹åŸåˆ™éƒ½ä¸æ˜¯å¿…é¡»éµå®ˆçš„ï¼Œ ç”šè‡³åªæœ‰æ›´å°‘çš„èƒ½å¤Ÿè¢«å¹¿æ³›è®¤å¯ã€‚ è¿™äº›ä»…ä»…æ˜¯æŒ‡å—è€Œå·²ï¼Œ ä½†æ˜¯å´æ˜¯<br><em>Clean Code</em> ä½œè€…å¤šå¹´ç»éªŒçš„ç»“æ™¶ã€‚</p>
<p>æˆ‘ä»¬çš„è½¯ä»¶å·¥ç¨‹è¡Œä¸šåªæœ‰çŸ­çŸ­çš„ 50 å¹´ï¼Œ ä¾ç„¶æœ‰å¾ˆå¤šè¦æˆ‘ä»¬å»å­¦ä¹ ã€‚ å½“è½¯ä»¶æ¶æ„ä¸å»ºç­‘æ¶æ„ä¸€æ ·å¤è€æ—¶ï¼Œ<br>ä¹Ÿè®¸æˆ‘ä»¬å°†ä¼šæœ‰ç¡¬æ€§çš„è§„åˆ™å»éµå®ˆã€‚ è€Œç°åœ¨ï¼Œ è®©è¿™äº›æŒ‡å—åšä¸ºä½ å’Œä½ çš„å›¢é˜Ÿç”Ÿäº§çš„ Java ä»£ç çš„<br>è´¨é‡çš„æ ‡å‡†ã€‚</p>
<p>è¿˜æœ‰ä¸€ä»¶äº‹ï¼š çŸ¥é“è¿™äº›æŒ‡å—å¹¶ä¸èƒ½é©¬ä¸Šè®©ä½ æˆä¸ºä¸€ä¸ªæ›´åŠ å‡ºè‰²çš„è½¯ä»¶å¼€å‘è€…ï¼Œ å¹¶ä¸”ä½¿ç”¨å®ƒä»¬å·¥ä½œå¤šå¹´ä¹Ÿå¹¶<br>ä¸æ„å‘³ç€ä½ ä¸å†ä¼šçŠ¯é”™è¯¯ã€‚ æ¯ä¸€æ®µä»£ç æœ€å¼€å§‹éƒ½æ˜¯è‰ç¨¿ï¼Œ åƒæ¹¿ç²˜åœŸä¸€æ ·è¢«æ‰“é€ æˆæœ€ç»ˆçš„å½¢æ€ã€‚ æœ€åå½“æˆ‘ä»¬<br>å’Œæ­æ¡£ä»¬ä¸€èµ·å®¡æŸ¥ä»£ç æ—¶æ¸…é™¤é‚£äº›ä¸å®Œå–„ä¹‹å¤„, ä¸è¦å› ä¸ºæœ€åˆéœ€è¦æ”¹å–„çš„è‰ç¨¿ä»£ç è€Œè‡ªè´£ï¼Œ è€Œæ˜¯å¯¹é‚£äº›ä»£<br>ç ä¸‹æ‰‹ã€‚</p>
<h2 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a><strong>å˜é‡</strong></h2><h3 id="ä½¿ç”¨æœ‰æ„ä¹‰å¹¶ä¸”å¯è¯»çš„å˜é‡åç§°"><a href="#ä½¿ç”¨æœ‰æ„ä¹‰å¹¶ä¸”å¯è¯»çš„å˜é‡åç§°" class="headerlink" title="ä½¿ç”¨æœ‰æ„ä¹‰å¹¶ä¸”å¯è¯»çš„å˜é‡åç§°"></a>ä½¿ç”¨æœ‰æ„ä¹‰å¹¶ä¸”å¯è¯»çš„å˜é‡åç§°</h3><p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String yyyymmdstr = new SimpleDateFormat(&quot;YYYY/MM/DD&quot;).format(new Date());</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String currentDate = new SimpleDateFormat(&quot;YYYY/MM/DD&quot;).format(new Date());</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h3 id="ä¸ºç›¸åŒç±»å‹çš„å˜é‡ä½¿ç”¨ç›¸åŒçš„è¯æ±‡"><a href="#ä¸ºç›¸åŒç±»å‹çš„å˜é‡ä½¿ç”¨ç›¸åŒçš„è¯æ±‡" class="headerlink" title="ä¸ºç›¸åŒç±»å‹çš„å˜é‡ä½¿ç”¨ç›¸åŒçš„è¯æ±‡"></a>ä¸ºç›¸åŒç±»å‹çš„å˜é‡ä½¿ç”¨ç›¸åŒçš„è¯æ±‡</h3><p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">getUserInfo();</span><br><span class="line">getClientData();</span><br><span class="line">getCustomerRecord();</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getUser();</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h3 id="ä½¿ç”¨å¯æœç´¢çš„åç§°"><a href="#ä½¿ç”¨å¯æœç´¢çš„åç§°" class="headerlink" title="ä½¿ç”¨å¯æœç´¢çš„åç§°"></a>ä½¿ç”¨å¯æœç´¢çš„åç§°</h3><p>æˆ‘ä»¬è¦é˜…è¯»çš„ä»£ç æ¯”è¦å†™çš„ä»£ç å¤šå¾—å¤šï¼Œ æ‰€ä»¥æˆ‘ä»¬å†™å‡ºçš„ä»£ç çš„å¯è¯»æ€§å’Œå¯æœç´¢æ€§æ˜¯å¾ˆé‡è¦çš„ã€‚ ä½¿ç”¨æ²¡æœ‰<br>æ„ä¹‰çš„å˜é‡åå°†ä¼šå¯¼è‡´æˆ‘ä»¬çš„ç¨‹åºéš¾äºç†è§£ï¼Œ å°†ä¼šä¼¤å®³æˆ‘ä»¬çš„è¯»è€…ï¼Œ æ‰€ä»¥è¯·ä½¿ç”¨å¯æœç´¢çš„å˜é‡åã€‚</p>
<p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// è‰¹ï¼Œ 86400000 æ˜¯ä»€ä¹ˆé¬¼ï¼Ÿ</span><br><span class="line"> setTimeout(blastOff, 86400000);</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// å°†å®ƒä»¬å£°æ˜ä¸ºå…¨å±€å¸¸é‡ã€‚</span><br><span class="line"> public static final int MILLISECONDS_IN_A_DAY = 86400000;</span><br><span class="line"> setTimeout(blastOff, MILLISECONDS_IN_A_DAY);</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h3 id="ä½¿ç”¨è§£é‡Šæ€§çš„å˜é‡"><a href="#ä½¿ç”¨è§£é‡Šæ€§çš„å˜é‡" class="headerlink" title="ä½¿ç”¨è§£é‡Šæ€§çš„å˜é‡"></a>ä½¿ç”¨è§£é‡Šæ€§çš„å˜é‡</h3><p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">String address = &quot;One Infinite Loop, Cupertino 95014&quot;;</span><br><span class="line">String cityZipCodeRegex = &quot;/^[^,\\\\]+[,\\\\\\s]+(.+?)\\s*(\\d&#123;5&#125;)?$/&quot;;</span><br><span class="line"></span><br><span class="line">saveCityZipCode(address.split(cityZipCodeRegex)[0],</span><br><span class="line">address.split(cityZipCodeRegex)[1]);</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">String address = &quot;One Infinite Loop, Cupertino 95014&quot;;</span><br><span class="line">String cityZipCodeRegex = &quot;/^[^,\\\\]+[,\\\\\\s]+(.+?)\\s*(\\d&#123;5&#125;)?$/&quot;;</span><br><span class="line"></span><br><span class="line">String city = address.split(cityZipCodeRegex)[0];</span><br><span class="line">String zipCode = address.split(cityZipCodeRegex)[1];</span><br><span class="line"></span><br><span class="line">saveCityZipCode(city, zipCode);</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h3 id="é¿å…å¿ƒç†æ˜ å°„"><a href="#é¿å…å¿ƒç†æ˜ å°„" class="headerlink" title="é¿å…å¿ƒç†æ˜ å°„"></a>é¿å…å¿ƒç†æ˜ å°„</h3><p>æ˜¾ç¤ºæ¯”éšå¼æ›´å¥½</p>
<p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">String [] l = &#123;&quot;Austin&quot;, &quot;New York&quot;, &quot;San Francisco&quot;&#125;;</span><br><span class="line"></span><br><span class="line">       for (int i = 0; i &lt; l.length; i++) &#123;</span><br><span class="line">           String li = l[i];</span><br><span class="line">           doStuff();</span><br><span class="line">           doSomeOtherStuff();</span><br><span class="line">           // ...</span><br><span class="line">           // ...</span><br><span class="line">           // ...</span><br><span class="line">           // Wait, what is `$li` for again?</span><br><span class="line">           dispatch(li);</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">String[] locations = &#123;&quot;Austin&quot;, &quot;New York&quot;, &quot;San Francisco&quot;&#125;;</span><br><span class="line"></span><br><span class="line">       for (String location : locations) &#123;</span><br><span class="line">           doStuff();</span><br><span class="line">           doSomeOtherStuff();</span><br><span class="line">           // ...</span><br><span class="line">           // ...</span><br><span class="line">           // ...</span><br><span class="line">           dispatch(location);</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h3 id="ä¸æ·»åŠ ä¸å¿…è¦çš„ä¸Šä¸‹æ–‡"><a href="#ä¸æ·»åŠ ä¸å¿…è¦çš„ä¸Šä¸‹æ–‡" class="headerlink" title="ä¸æ·»åŠ ä¸å¿…è¦çš„ä¸Šä¸‹æ–‡"></a>ä¸æ·»åŠ ä¸å¿…è¦çš„ä¸Šä¸‹æ–‡</h3><p>å¦‚æœä½ çš„ç±»å/å¯¹è±¡åæœ‰æ„ä¹‰ï¼Œ ä¸è¦åœ¨å˜é‡åä¸Šå†é‡å¤ã€‚</p>
<p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">class Car &#123;</span><br><span class="line">          public String carMake = &quot;Honda&quot;;</span><br><span class="line">          public String carModel = &quot;Accord&quot;;</span><br><span class="line">          public String carColor = &quot;Blue&quot;;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      void paintCar(Car car) &#123;</span><br><span class="line">          car.carColor = &quot;Red&quot;;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">class Car &#123;</span><br><span class="line">          public String make = &quot;Honda&quot;;</span><br><span class="line">          public String model = &quot;Accord&quot;;</span><br><span class="line">          public String color = &quot;Blue&quot;;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      void paintCar(Car car) &#123;</span><br><span class="line">          car.color = &quot;Red&quot;;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h2 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a><strong>å‡½æ•°</strong></h2><h3 id="å‡½æ•°å‚æ•°-ä¸¤ä¸ªä»¥ä¸‹æœ€ç†æƒ³"><a href="#å‡½æ•°å‚æ•°-ä¸¤ä¸ªä»¥ä¸‹æœ€ç†æƒ³" class="headerlink" title="å‡½æ•°å‚æ•° (ä¸¤ä¸ªä»¥ä¸‹æœ€ç†æƒ³)"></a>å‡½æ•°å‚æ•° (ä¸¤ä¸ªä»¥ä¸‹æœ€ç†æƒ³)</h3><p>é™åˆ¶å‡½æ•°å‚æ•°çš„ä¸ªæ•°æ˜¯éå¸¸é‡è¦çš„ï¼Œ å› ä¸ºè¿™æ ·å°†ä½¿ä½ çš„å‡½æ•°å®¹æ˜“è¿›è¡Œæµ‹è¯•ã€‚ ä¸€æ—¦è¶…è¿‡ä¸‰ä¸ªå‚æ•°å°†ä¼šå¯¼è‡´ç»„<br>åˆçˆ†ç‚¸ï¼Œ å› ä¸ºä½ ä¸å¾—ä¸ç¼–å†™å¤§é‡é’ˆå¯¹æ¯ä¸ªå‚æ•°çš„æµ‹è¯•ç”¨ä¾‹ã€‚</p>
<p>æ²¡æœ‰å‚æ•°æ˜¯æœ€ç†æƒ³çš„ï¼Œ ä¸€ä¸ªæˆ–è€…ä¸¤ä¸ªå‚æ•°ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œ ä¸‰ä¸ªå‚æ•°åº”è¯¥é¿å…ï¼Œ è¶…è¿‡ä¸‰ä¸ªåº”è¯¥è¢«é‡æ„ã€‚ é€šå¸¸ï¼Œ<br>å¦‚æœä½ æœ‰ä¸€ä¸ªè¶…è¿‡ä¸¤ä¸ªå‡½æ•°çš„å‚æ•°ï¼Œ é‚£å°±æ„å‘³ç€ä½ çš„å‡½æ•°å°è¯•åšå¤ªå¤šçš„äº‹æƒ…ã€‚ å¦‚æœä¸æ˜¯ï¼Œ å¤šæ•°æƒ…å†µä¸‹ä¸€ä¸ª<br>æ›´é«˜çº§å¯¹è±¡å¯èƒ½ä¼šæ»¡è¶³éœ€æ±‚ã€‚</p>
<p>å½“ä½ å‘ç°ä½ è‡ªå·±éœ€è¦å¤§é‡çš„å‚æ•°æ—¶ï¼Œ ä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå¯¹è±¡ã€‚</p>
<p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void createMenu(String title,String body,String buttonText,boolean cancellable)&#123;&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„</strong>ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">class MenuConfig&#123;</span><br><span class="line">           String title;</span><br><span class="line">           String body;</span><br><span class="line">           String buttonText;</span><br><span class="line">           boolean cancellable;</span><br><span class="line">       &#125;</span><br><span class="line">       void  createMenu(MenuConfig menuConfig)&#123;&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h3 id="å‡½æ•°åº”å½“åªåšä¸€ä»¶äº‹æƒ…"><a href="#å‡½æ•°åº”å½“åªåšä¸€ä»¶äº‹æƒ…" class="headerlink" title="å‡½æ•°åº”å½“åªåšä¸€ä»¶äº‹æƒ…"></a>å‡½æ•°åº”å½“åªåšä¸€ä»¶äº‹æƒ…</h3><p>è¿™æ˜¯è½¯ä»¶å·¥ç¨‹ä¸­æœ€é‡è¦çš„ä¸€æ¡è§„åˆ™ï¼Œ å½“å‡½æ•°éœ€è¦åšæ›´å¤šçš„äº‹æƒ…æ—¶ï¼Œ å®ƒä»¬å°†ä¼šæ›´éš¾è¿›è¡Œç¼–å†™ã€ æµ‹è¯•å’Œæ¨ç†ã€‚<br>å½“ä½ èƒ½å°†ä¸€ä¸ªå‡½æ•°éš”ç¦»åˆ°åªæœ‰ä¸€ä¸ªåŠ¨ä½œï¼Œ ä»–ä»¬å°†èƒ½å¤Ÿè¢«å®¹æ˜“çš„è¿›è¡Œé‡æ„å¹¶ä¸”ä½ çš„ä»£ç å°†ä¼šæ›´å®¹æ˜“é˜…è¯»ã€‚ å¦‚<br>æœä½ ä¸¥æ ¼éµå®ˆæœ¬æŒ‡å—ä¸­çš„è¿™ä¸€æ¡ï¼Œ ä½ å°†ä¼šé¢†å…ˆäºè®¸å¤šå¼€å‘è€…ã€‚</p>
<p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public void emailClients(List&lt;Client&gt; clients) &#123;</span><br><span class="line">           for (Client client : clients) &#123;</span><br><span class="line">               Client clientRecord = repository.findOne(client.getId());</span><br><span class="line">               if (clientRecord.isActive())&#123;</span><br><span class="line">                   email(client);</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public void emailClients(List&lt;Client&gt; clients) &#123;</span><br><span class="line">           for (Client client : clients) &#123;</span><br><span class="line">               if (isActiveClient(client)) &#123;</span><br><span class="line">                   email(client);</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">private boolean isActiveClient(Client client) &#123;</span><br><span class="line">           Client clientRecord = repository.findOne(client.getId());</span><br><span class="line">           return clientRecord.isActive();</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h3 id="å‡½æ•°åç§°åº”è¯¥è¯´æ˜å®ƒè¦åšä»€ä¹ˆ"><a href="#å‡½æ•°åç§°åº”è¯¥è¯´æ˜å®ƒè¦åšä»€ä¹ˆ" class="headerlink" title="å‡½æ•°åç§°åº”è¯¥è¯´æ˜å®ƒè¦åšä»€ä¹ˆ"></a>å‡½æ•°åç§°åº”è¯¥è¯´æ˜å®ƒè¦åšä»€ä¹ˆ</h3><p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">private void addToDate(Date date, int month)&#123;</span><br><span class="line">           //..</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       Date date = new Date();</span><br><span class="line"></span><br><span class="line">       // It&apos;s hard to to tell from the method name what is added</span><br><span class="line">       addToDate(date, 1);</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">private void addMonthToDate(Date date, int month)&#123;</span><br><span class="line">          //..</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      Date date = new Date();</span><br><span class="line">      addMonthToDate(1, date);</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h3 id="å‡½æ•°åº”è¯¥åªæœ‰ä¸€ä¸ªæŠ½è±¡çº§åˆ«"><a href="#å‡½æ•°åº”è¯¥åªæœ‰ä¸€ä¸ªæŠ½è±¡çº§åˆ«" class="headerlink" title="å‡½æ•°åº”è¯¥åªæœ‰ä¸€ä¸ªæŠ½è±¡çº§åˆ«"></a>å‡½æ•°åº”è¯¥åªæœ‰ä¸€ä¸ªæŠ½è±¡çº§åˆ«</h3><p>å½“åœ¨ä½ çš„å‡½æ•°ä¸­æœ‰å¤šäºä¸€ä¸ªæŠ½è±¡çº§åˆ«æ—¶ï¼Œ ä½ çš„å‡½æ•°é€šå¸¸åšäº†å¤ªå¤šäº‹æƒ…ã€‚ æ‹†åˆ†å‡½æ•°å°†ä¼šæå‡é‡ç”¨æ€§å’Œæµ‹è¯•æ€§ã€‚</p>
<p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">void parseBetterJSAlternative(String code)&#123;</span><br><span class="line">       String[] REGECES=&#123;&#125;;</span><br><span class="line">       String[] statements=code.split(&quot; &quot;);</span><br><span class="line">       String[] tokens=&#123;&#125;;</span><br><span class="line">       for(String regex: Arrays.asList(REGECES))&#123;</span><br><span class="line">              for(String statement:Arrays.asList(statements))&#123;</span><br><span class="line">                  //...</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       String[] ast=&#123;&#125;;</span><br><span class="line">       for(String token:Arrays.asList(tokens))&#123;</span><br><span class="line">               //lex ...</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">       for(String node:Arrays.asList(ast))&#123;</span><br><span class="line">               //parse ...</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">String[] tokenize(String code)&#123;</span><br><span class="line">       String[] REGECES=&#123;&#125;;</span><br><span class="line">       String[] statements=code.split(&quot; &quot;);</span><br><span class="line">       String[] tokens=&#123;&#125;;</span><br><span class="line">       for(String regex: Arrays.asList(REGECES))&#123;</span><br><span class="line">           for(String statement:Arrays.asList(statements))&#123;</span><br><span class="line">                   //tokens push</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       return tokens;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       String[] lexer(String[] tokens)&#123;</span><br><span class="line">       String[] ast=&#123;&#125;;</span><br><span class="line">       for(String token:Arrays.asList(tokens))&#123;</span><br><span class="line">               //ast push</span><br><span class="line">       &#125;</span><br><span class="line">       return ast;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       void parseBetterJSAlternative(String code)&#123;</span><br><span class="line">       String[] tokens=tokenize(code);</span><br><span class="line">       String[] ast=lexer(tokens);</span><br><span class="line">       for(String node:Arrays.asList(ast))&#123;</span><br><span class="line">               //parse ...</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h3 id="ç§»é™¤å†—ä½™ä»£ç "><a href="#ç§»é™¤å†—ä½™ä»£ç " class="headerlink" title="ç§»é™¤å†—ä½™ä»£ç "></a>ç§»é™¤å†—ä½™ä»£ç </h3><p>ç«­å°½ä½ çš„å…¨åŠ›å»é¿å…å†—ä½™ä»£ç ã€‚ å†—ä½™ä»£ç æ˜¯ä¸å¥½çš„ï¼Œ å› ä¸ºå®ƒæ„å‘³ç€å½“ä½ éœ€è¦ä¿®æ”¹ä¸€äº›é€»è¾‘æ—¶ä¼šæœ‰å¤šä¸ªåœ°æ–¹<br>éœ€è¦ä¿®æ”¹ã€‚</p>
<p>æƒ³è±¡ä¸€ä¸‹ä½ åœ¨ç»è¥ä¸€å®¶é¤é¦†ï¼Œ ä½ éœ€è¦è®°å½•æ‰€æœ‰çš„åº“å­˜è¥¿çº¢æŸ¿ï¼Œ æ´‹è‘±ï¼Œ å¤§è’œï¼Œ å„ç§é¦™æ–™ç­‰ç­‰ã€‚ å¦‚æœä½ æœ‰å¤š<br>ä¸ªè®°å½•åˆ—è¡¨ï¼Œ å½“ä½ ç”¨è¥¿çº¢æŸ¿åšä¸€é“èœæ—¶ä½ å¾—æ›´æ–°å¤šä¸ªåˆ—è¡¨ã€‚ å¦‚æœä½ åªæœ‰ä¸€ä¸ªåˆ—è¡¨ï¼Œ å°±åªæœ‰ä¸€ä¸ªåœ°æ–¹éœ€è¦æ›´<br>æ–°ï¼</p>
<p>ä½ æœ‰å†—ä½™ä»£ç é€šå¸¸æ˜¯å› ä¸ºä½ æœ‰ä¸¤ä¸ªæˆ–å¤šä¸ªç¨å¾®ä¸åŒçš„ä¸œè¥¿ï¼Œ å®ƒä»¬å…±äº«å¤§éƒ¨åˆ†ï¼Œ ä½†æ˜¯å®ƒä»¬çš„ä¸åŒä¹‹å¤„è¿«ä½¿ä½ ä½¿<br>ç”¨ä¸¤ä¸ªæˆ–æ›´å¤šç‹¬ç«‹çš„å‡½æ•°æ¥å¤„ç†å¤§éƒ¨åˆ†ç›¸åŒçš„ä¸œè¥¿ã€‚ ç§»é™¤å†—ä½™ä»£ç æ„å‘³ç€åˆ›å»ºä¸€ä¸ªå¯ä»¥å¤„ç†è¿™äº›ä¸åŒä¹‹å¤„çš„<br>æŠ½è±¡çš„å‡½æ•°/æ¨¡å—/ç±»ã€‚</p>
<p>è®©è¿™ä¸ªæŠ½è±¡æ­£ç¡®æ˜¯å…³é”®çš„ï¼Œ è¿™æ˜¯ä¸ºä»€ä¹ˆè¦ä½ éµå¾ª <em>Classes</em> é‚£ä¸€ç« çš„ SOLID çš„åŸå› ã€‚ ä¸å¥½çš„æŠ½è±¡æ¯”å†—<br>ä½™ä»£ç æ›´å·®ï¼Œ æ‰€ä»¥è¦è°¨æ…è¡Œäº‹ã€‚ æ—¢ç„¶å·²ç»è¿™ä¹ˆè¯´äº†ï¼Œ å¦‚æœä½ èƒ½å¤Ÿåšå‡ºä¸€ä¸ªå¥½çš„æŠ½è±¡ï¼Œ æ‰å»åšã€‚ ä¸è¦é‡å¤<br>ä½ è‡ªå·±ï¼Œ å¦åˆ™ä½ ä¼šå‘ç°å½“ä½ è¦ä¿®æ”¹ä¸€ä¸ªä¸œè¥¿æ—¶æ—¶åˆ»éœ€è¦ä¿®æ”¹å¤šä¸ªåœ°æ–¹ã€‚</p>
<p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">void showDeveloperList(List&lt;Developer&gt; developers)&#123;</span><br><span class="line">           for(Developer developer:developers)&#123;</span><br><span class="line">               render(new Data(developer.expectedSalary,developer.experience,developer.githubLink));</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">void showManagerrList(List&lt;Manager&gt; managers)&#123;</span><br><span class="line">           for(Manager manager:managers)&#123;</span><br><span class="line">               render(new Data(manager.expectedSalary,manager.experience,manager.portfolio));</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">void showList(List&lt;Employee&gt; employees)&#123;</span><br><span class="line">           for(Employee employee:employees)&#123;</span><br><span class="line">               Data data=new Data(employee.expectedSalary,employee.experience,employee.githubLink);</span><br><span class="line">               String portfolio=employee.portfolio;</span><br><span class="line">               if(&quot;manager&quot;.equals(employee))&#123;</span><br><span class="line">                   portfolio=employee.portfolio;</span><br><span class="line">               &#125;</span><br><span class="line">               data.portfolio=portfolio;</span><br><span class="line">               render(data);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h3 id="ä¸è¦ä½¿ç”¨æ ‡è®°ä½åšä¸ºå‡½æ•°å‚æ•°"><a href="#ä¸è¦ä½¿ç”¨æ ‡è®°ä½åšä¸ºå‡½æ•°å‚æ•°" class="headerlink" title="ä¸è¦ä½¿ç”¨æ ‡è®°ä½åšä¸ºå‡½æ•°å‚æ•°"></a>ä¸è¦ä½¿ç”¨æ ‡è®°ä½åšä¸ºå‡½æ•°å‚æ•°</h3><p>æ ‡è®°ä½æ˜¯å‘Šè¯‰ä½ çš„ç”¨æˆ·è¿™ä¸ªå‡½æ•°åšäº†ä¸åªä¸€ä»¶äº‹æƒ…ã€‚ å‡½æ•°åº”è¯¥åªåšä¸€ä»¶äº‹æƒ…ã€‚ å¦‚æœä½ çš„å‡½æ•°å› ä¸ºä¸€ä¸ªå¸ƒå°”å€¼<br>å‡ºç°ä¸åŒçš„ä»£ç è·¯å¾„ï¼Œ è¯·æ‹†åˆ†å®ƒä»¬ã€‚</p>
<p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">void createFile(String name,boolean temp)&#123;</span><br><span class="line">        if(temp)&#123;</span><br><span class="line">            new File(&quot;./temp&quot;+name);</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">           new File(name);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">void createFile(String name)&#123;</span><br><span class="line">        new File(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">void createTempFile(String name)&#123;</span><br><span class="line">        new File(&quot;./temp&quot;+name);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h3 id="é¿å…å‰¯ä½œç”¨"><a href="#é¿å…å‰¯ä½œç”¨" class="headerlink" title="é¿å…å‰¯ä½œç”¨"></a>é¿å…å‰¯ä½œç”¨</h3><p>å¦‚æœä¸€ä¸ªå‡½æ•°åšäº†é™¤æ¥å—ä¸€ä¸ªå€¼ç„¶åè¿”å›ä¸€ä¸ªå€¼æˆ–å¤šä¸ªå€¼ä¹‹å¤–çš„ä»»ä½•äº‹æƒ…ï¼Œ å®ƒå°†ä¼šäº§ç”Ÿå‰¯ä½œç”¨ï¼Œ å®ƒå¯èƒ½æ˜¯<br>å†™å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œ ä¿®æ”¹ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œ æˆ–è€…æ„å¤–çš„æŠŠä½ æ‰€æœ‰çš„é’±è¿æ¥åˆ°ä¸€ä¸ªé™Œç”Ÿäººé‚£é‡Œã€‚</p>
<p>ç°åœ¨åœ¨ä½ çš„ç¨‹åºä¸­ç¡®å®å¶å°”éœ€è¦å‰¯ä½œç”¨ï¼Œ å°±åƒä¸Šé¢çš„ä»£ç ï¼Œ ä½ ä¹Ÿè®¸éœ€è¦å†™å…¥åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œ ä½ éœ€è¦åšçš„æ˜¯é›†<br>ä¸­åŒ–ä½ è¦åšçš„äº‹æƒ…ï¼Œ ä¸è¦è®©å¤šä¸ªå‡½æ•°æˆ–è€…ç±»å†™å…¥ä¸€ä¸ªç‰¹å®šçš„æ–‡ä»¶ï¼Œ ç”¨ä¸€ä¸ªæœåŠ¡æ¥å®ç°å®ƒï¼Œ ä¸€ä¸ªå¹¶ä¸”åªæœ‰ä¸€<br>ä¸ªã€‚</p>
<p>é‡ç‚¹æ˜¯é¿å…è¿™äº›å¸¸è§çš„æ˜“çŠ¯çš„é”™è¯¯ï¼Œ æ¯”å¦‚åœ¨å¯¹è±¡ä¹‹é—´å…±äº«çŠ¶æ€è€Œä¸ä½¿ç”¨ä»»ä½•ç»“æ„ï¼Œ ä½¿ç”¨ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥å†™å…¥<br>çš„å¯å˜çš„æ•°æ®ç±»å‹ï¼Œ æ²¡æœ‰é›†ä¸­åŒ–å¯¼è‡´å‰¯ä½œç”¨ã€‚ å¦‚æœä½ èƒ½åšåˆ°è¿™äº›ï¼Œ é‚£ä¹ˆä½ å°†ä¼šæ¯”å…¶å®ƒçš„ç å†œå¤§å†›æ›´åŠ å¹¸ç¦ã€‚</p>
<p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">String name=&quot;Ryan McDermott&quot;;</span><br><span class="line">void splitIntoFirstAndLastName()&#123;</span><br><span class="line">        name=name.split(&quot; &quot;).toString();</span><br><span class="line">&#125;</span><br><span class="line">splitIntoFirstAndLastName();</span><br><span class="line">System.out.println(name);</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">String name=&quot;Ryan McDermott&quot;;</span><br><span class="line">String splitIntoFirstAndLastName()&#123;</span><br><span class="line">        return name.split(&quot; &quot;).toString();</span><br><span class="line">    &#125;</span><br><span class="line">String newName=splitIntoFirstAndLastName();</span><br><span class="line">System.out.println(name);</span><br><span class="line">System.out.println(newName);</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h3 id="å‡½æ•°å¼ç¼–ç¨‹ä¼˜äºæŒ‡ä»¤å¼ç¼–ç¨‹"><a href="#å‡½æ•°å¼ç¼–ç¨‹ä¼˜äºæŒ‡ä»¤å¼ç¼–ç¨‹" class="headerlink" title="å‡½æ•°å¼ç¼–ç¨‹ä¼˜äºæŒ‡ä»¤å¼ç¼–ç¨‹"></a>å‡½æ•°å¼ç¼–ç¨‹ä¼˜äºæŒ‡ä»¤å¼ç¼–ç¨‹</h3><p>å‡½æ•°å¼è¯­è¨€æ›´åŠ ç®€æ´<br>å¹¶ä¸”æ›´å®¹æ˜“è¿›è¡Œæµ‹è¯•ï¼Œ å½“ä½ å¯ä»¥ä½¿ç”¨å‡½æ•°å¼ç¼–ç¨‹é£æ ¼æ—¶è¯·å°½æƒ…ä½¿ç”¨ã€‚</p>
<p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; programmerOutput=new ArrayList&lt;&gt;();</span><br><span class="line">programmerOutput.add(500);</span><br><span class="line">programmerOutput.add(1500);</span><br><span class="line">programmerOutput.add(150);</span><br><span class="line">programmerOutput.add(1000);</span><br><span class="line">int totalOutput=0;</span><br><span class="line">for(int i=0;i&lt;programmerOutput.size();i++)&#123;</span><br><span class="line">    totalOutput+=programmerOutput.get(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; programmerOutput=new ArrayList&lt;&gt;();</span><br><span class="line">programmerOutput.add(500);</span><br><span class="line">programmerOutput.add(1500);</span><br><span class="line">programmerOutput.add(150);</span><br><span class="line">programmerOutput.add(1000);</span><br><span class="line">int totalOutput= programmerOutput.stream().filter(programmer -&gt; programmer &gt; 500).mapToInt(programmer -&gt; programmer).sum();</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h3 id="å°è£…æ¡ä»¶è¯­å¥"><a href="#å°è£…æ¡ä»¶è¯­å¥" class="headerlink" title="å°è£…æ¡ä»¶è¯­å¥"></a>å°è£…æ¡ä»¶è¯­å¥</h3><p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if(fsm.state.equals(&quot;fetching&quot;)&amp;&amp;listNode.isEmpty()&#123;</span><br><span class="line">        //...</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">void shouldShowSpinner(Fsm fsm, String listNode) &#123;</span><br><span class="line">        return fsm.state.equals(&quot;fetching&quot;)&amp;&amp;listNode.isEmpty();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">if (shouldShowSpinner(fsmInstance, listNodeInstance)) &#123;</span><br><span class="line">        // ...</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h3 id="é¿å…è´Ÿé¢æ¡ä»¶"><a href="#é¿å…è´Ÿé¢æ¡ä»¶" class="headerlink" title="é¿å…è´Ÿé¢æ¡ä»¶"></a>é¿å…è´Ÿé¢æ¡ä»¶</h3><p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">void isDOMNodeNotPresent(Node node) &#123;</span><br><span class="line">        // ...</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">if (!isDOMNodeNotPresent(node)) &#123;</span><br><span class="line">        // ...</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">void isDOMNodePresent(Node node) &#123;</span><br><span class="line">            // ...</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">if (isDOMNodePresent(node)) &#123;</span><br><span class="line">        // ...</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h3 id="é¿å…æ¡ä»¶è¯­å¥"><a href="#é¿å…æ¡ä»¶è¯­å¥" class="headerlink" title="é¿å…æ¡ä»¶è¯­å¥"></a>é¿å…æ¡ä»¶è¯­å¥</h3><p>è¿™çœ‹èµ·æ¥ä¼¼ä¹æ˜¯ä¸€ä¸ªä¸å¯èƒ½çš„ä»»åŠ¡ã€‚ ç¬¬ä¸€æ¬¡å¬åˆ°è¿™ä¸ªæ—¶ï¼Œ å¤šæ•°äººä¼šè¯´ï¼š â€œæ²¡æœ‰ <code>if</code> è¯­å¥è¿˜èƒ½æœŸæœ›æˆ‘å¹²<br>å•¥å‘¢â€ï¼Œ ç­”æ¡ˆæ˜¯å¤šæ•°æƒ…å†µä¸‹ä½ å¯ä»¥ä½¿ç”¨å¤šæ€æ¥å®ŒæˆåŒæ ·çš„ä»»åŠ¡ã€‚ ç¬¬äºŒä¸ªé—®é¢˜é€šå¸¸æ˜¯ â€œå¥½äº†ï¼Œ é‚£ä¹ˆåšå¾ˆæ£’ï¼Œ<br>ä½†æ˜¯æˆ‘ä¸ºä»€ä¹ˆæƒ³è¦é‚£æ ·åšå‘¢â€ï¼Œ ç­”æ¡ˆæ˜¯æˆ‘ä»¬å­¦åˆ°çš„ä¸Šä¸€æ¡ä»£ç æ•´æ´ä¹‹é“çš„ç†å¿µï¼š ä¸€ä¸ªå‡½æ•°åº”å½“åªåšä¸€ä»¶äº‹æƒ…ã€‚<br>å½“ä½ æœ‰ä½¿ç”¨ <code>if</code> è¯­å¥çš„ç±»/å‡½æ•°æ˜¯ï¼Œ ä½ åœ¨å‘Šè¯‰ä½ çš„ç”¨æˆ·ä½ çš„å‡½æ•°åšäº†ä¸æ­¢ä¸€ä»¶äº‹æƒ…ã€‚ è®°ä½ï¼š åªåšä¸€ä»¶<br>äº‹æƒ…ã€‚</p>
<p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">class Airplane&#123;</span><br><span class="line">       int getCurisingAltitude()&#123;</span><br><span class="line">           switch(this.type)&#123;</span><br><span class="line">               case &quot;777&quot;:</span><br><span class="line">                   return this.getMaxAltitude()-this.getPassengerCount();</span><br><span class="line">               case &quot;Air Force One&quot;:</span><br><span class="line">                   return this.getMaxAltitude();</span><br><span class="line">               case &quot;Cessna&quot;:</span><br><span class="line">                   return this.getMaxAltitude() - this.getFuelExpenditure();</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">class Airplane &#123;</span><br><span class="line">        // ...</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">class Boeing777 extends Airplane &#123;</span><br><span class="line">        // ...</span><br><span class="line">    int getCruisingAltitude() &#123;</span><br><span class="line">        return this.getMaxAltitude() - this.getPassengerCount();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class AirForceOne extends Airplane &#123;</span><br><span class="line">    // ...</span><br><span class="line">    int getCruisingAltitude() &#123;</span><br><span class="line">        return this.getMaxAltitude();</span><br><span class="line">       &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Cessna extends Airplane &#123;</span><br><span class="line">    // ...</span><br><span class="line">    int getCruisingAltitude() &#123;</span><br><span class="line">        return this.getMaxAltitude() - this.getFuelExpenditure();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h3 id="ç§»é™¤åƒµå°¸ä»£ç "><a href="#ç§»é™¤åƒµå°¸ä»£ç " class="headerlink" title="ç§»é™¤åƒµå°¸ä»£ç "></a>ç§»é™¤åƒµå°¸ä»£ç </h3><p>åƒµæ­»ä»£ç å’Œå†—ä½™ä»£ç åŒæ ·ç³Ÿç³•ã€‚ æ²¡æœ‰ç†ç”±åœ¨ä»£ç åº“ä¸­ä¿å­˜å®ƒã€‚ å¦‚æœå®ƒä¸ä¼šè¢«è°ƒç”¨ï¼Œ å°±åˆ æ‰å®ƒã€‚ å½“ä½ éœ€è¦<br>å®ƒæ—¶ï¼Œ å®ƒä¾ç„¶ä¿å­˜åœ¨ç‰ˆæœ¬å†å²è®°å½•ä¸­ã€‚</p>
<p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">void  oldRequestModule(String url) &#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void  newRequestModule(String url) &#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">String  req = newRequestModule;</span><br><span class="line">inventoryTracker(&quot;apples&quot;, req, &quot;www.inventory-awesome.io&quot;);</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">void  newRequestModule(String url) &#123;</span><br><span class="line">    // ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">String  req = newRequestModule;</span><br><span class="line">inventoryTracker(&quot;apples&quot;, req, &quot;www.inventory-awesome.io&quot;);</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h2 id="å¯¹è±¡å’Œæ•°æ®ç»“æ„"><a href="#å¯¹è±¡å’Œæ•°æ®ç»“æ„" class="headerlink" title="å¯¹è±¡å’Œæ•°æ®ç»“æ„"></a><strong>å¯¹è±¡å’Œæ•°æ®ç»“æ„</strong></h2><h3 id="ä½¿ç”¨-getters-å’Œ-setters"><a href="#ä½¿ç”¨-getters-å’Œ-setters" class="headerlink" title="ä½¿ç”¨ getters å’Œ setters"></a>ä½¿ç”¨ getters å’Œ setters</h3><p> ä½¿ç”¨ getters å’Œ setters æ¥è®¿é—®å¯¹è±¡ä¸Šçš„æ•°æ®æ¯”ç®€å•çš„åœ¨ä¸€ä¸ªå¯¹è±¡ä¸ŠæŸ¥æ‰¾å±æ€§<br>è¦å¥½å¾—å¤šã€‚ â€œä¸ºä»€ä¹ˆï¼Ÿâ€ ä½ å¯èƒ½ä¼šé—®ï¼Œ å¥½å§ï¼Œ åŸå› è¯·çœ‹ä¸‹é¢çš„åˆ—è¡¨ï¼š</p>
<ul>
<li>å½“ä½ æƒ³åœ¨è·å–ä¸€ä¸ªå¯¹è±¡å±æ€§çš„èƒŒååšæ›´å¤šçš„äº‹æƒ…æ—¶ï¼Œ ä½ ä¸éœ€è¦åœ¨ä»£ç åº“ä¸­æŸ¥æ‰¾å’Œä¿®æ”¹æ¯ä¸€å¤„è®¿é—®ï¼›</li>
<li>ä½¿ç”¨ <code>set</code> å¯ä»¥è®©æ·»åŠ éªŒè¯å˜å¾—å®¹æ˜“ï¼›</li>
<li>å°è£…å†…éƒ¨å®ç°ï¼›</li>
<li>ä½¿ç”¨ getting å’Œ setting æ—¶ï¼Œ å®¹æ˜“æ·»åŠ æ—¥å¿—å’Œé”™è¯¯å¤„ç†ï¼›</li>
<li>ç»§æ‰¿è¿™ä¸ªç±»ï¼Œ ä½ å¯ä»¥é‡å†™é»˜è®¤åŠŸèƒ½ï¼›</li>
<li>ä½ å¯ä»¥å»¶è¿ŸåŠ è½½å¯¹è±¡çš„å±æ€§ï¼Œ æ¯”å¦‚è¯´ä»æœåŠ¡å™¨è·å–ã€‚</li>
</ul>
<p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">class BankAccount&#123;</span><br><span class="line">        public int balance=1000;</span><br><span class="line">    &#125;</span><br><span class="line">BankAccount bankAccount=new BankAccount();</span><br><span class="line">bankAccount.balance-=100;</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">class BankAccount&#123;</span><br><span class="line">    private int blance=1000;</span><br><span class="line">    public int getBlance() &#123;</span><br><span class="line">         return blance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setBlance(int blance) &#123;</span><br><span class="line">        if(verifyIfAmountCanBeSetted(blance))&#123;</span><br><span class="line">                this.blance = blance;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        void verifyIfAmountCanBeSetted(int amount)&#123;</span><br><span class="line">            //...</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    BankAccount bankAccount=new BankAccount();</span><br><span class="line">    bankAccount.setBlance(2000);</span><br><span class="line">    int balance=bankAccount.getBlance();</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h2 id="ç±»"><a href="#ç±»" class="headerlink" title="ç±»"></a><strong>ç±»</strong></h2><h3 id="ä½¿ç”¨æ–¹æ³•é“¾"><a href="#ä½¿ç”¨æ–¹æ³•é“¾" class="headerlink" title="ä½¿ç”¨æ–¹æ³•é“¾"></a>ä½¿ç”¨æ–¹æ³•é“¾</h3><p>è¿™ä¸ªæ¨¡å¼åœ¨ Java ä¸­æ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œ å¹¶ä¸”ä½ å¯ä»¥åœ¨è®¸å¤šç±»åº“æ¯”å¦‚ Glide å’Œ OkHttp ä¸­è§åˆ°ã€‚<br>å®ƒä½¿ä½ çš„ä»£ç å˜å¾—å¯Œæœ‰è¡¨ç°åŠ›ï¼Œ å¹¶å‡å°‘å•°å—¦ã€‚ å› ä¸ºè¿™ä¸ªåŸå› ï¼Œ æˆ‘è¯´ï¼Œ ä½¿ç”¨æ–¹æ³•é“¾ç„¶åå†çœ‹çœ‹ä½ çš„ä»£ç <br>ä¼šå˜å¾—å¤šä¹ˆç®€æ´ã€‚ åœ¨ä½ çš„ç±»ï¼æ–¹æ³•ä¸­ï¼Œ ç®€å•çš„åœ¨æ¯ä¸ªæ–¹æ³•çš„æœ€åè¿”å› <code>this</code> ï¼Œ ç„¶åä½ å°±èƒ½æŠŠè¿™ä¸ªç±»çš„<br>å…¶å®ƒæ–¹æ³•é“¾åœ¨ä¸€èµ·ã€‚</p>
<p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">class Car&#123;</span><br><span class="line">    private String make;</span><br><span class="line">    private String model;</span><br><span class="line">    private String color;</span><br><span class="line"></span><br><span class="line">    public void setMake(String make) &#123;</span><br><span class="line">        this.make = make;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     public void setModel(String model) &#123;</span><br><span class="line">        this.model = model;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setColor(String color) &#123;</span><br><span class="line">        this.color = color;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void save()&#123;</span><br><span class="line">        console.log(this.make, this.model, this.color);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Car car=new Car();</span><br><span class="line">car.setColor(&quot;pink&quot;);</span><br><span class="line">car.setMake(&quot;Ford&quot;);</span><br><span class="line">car.setModel(&quot;F-150&quot;);</span><br><span class="line">car.save();</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">class Car&#123;</span><br><span class="line">    private String make;</span><br><span class="line">    private String model;</span><br><span class="line">    private String color;</span><br><span class="line"></span><br><span class="line">    public Car setMake(String make) &#123;</span><br><span class="line">        this.make = make;</span><br><span class="line">        return this;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Car setModel(String model) &#123;</span><br><span class="line">        this.model = model;</span><br><span class="line">        return this;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Car setColor(String color) &#123;</span><br><span class="line">        this.color = color;</span><br><span class="line">        return this;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Car save()&#123;</span><br><span class="line">        console.log(this.make, this.model, this.color);</span><br><span class="line">        return this;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Car car=new Car()</span><br><span class="line">.setColor(&quot;pink&quot;)</span><br><span class="line">.setMake(&quot;Ford&quot;)</span><br><span class="line">.setModel(&quot;F-150&quot;)</span><br><span class="line">.save();</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h3 id="ç»„åˆä¼˜å…ˆäºç»§æ‰¿"><a href="#ç»„åˆä¼˜å…ˆäºç»§æ‰¿" class="headerlink" title="ç»„åˆä¼˜å…ˆäºç»§æ‰¿"></a>ç»„åˆä¼˜å…ˆäºç»§æ‰¿</h3><p>æ­£å¦‚<a href="https://en.wikipedia.org/wiki/Design_Patterns" target="_blank" rel="noopener"><em>è®¾è®¡æ¨¡å¼å››äººå¸®</em></a>æ‰€è¿°ï¼Œ å¦‚æœå¯èƒ½ï¼Œ<br>ä½ åº”è¯¥ä¼˜å…ˆä½¿ç”¨ç»„åˆè€Œä¸æ˜¯ç»§æ‰¿ã€‚ æœ‰è®¸å¤šå¥½çš„ç†ç”±å»ä½¿ç”¨ç»§æ‰¿ï¼Œ ä¹Ÿæœ‰è®¸å¤šå¥½çš„ç†ç”±å»ä½¿ç”¨ç»„åˆã€‚è¿™ä¸ªæ ¼è¨€<br>çš„é‡ç‚¹æ˜¯ï¼Œ å¦‚æœä½ æœ¬èƒ½çš„è§‚ç‚¹æ˜¯ç»§æ‰¿ï¼Œ é‚£ä¹ˆè¯·æƒ³ä¸€ä¸‹ç»„åˆèƒ½å¦æ›´å¥½çš„ä¸ºä½ çš„é—®é¢˜å»ºæ¨¡ã€‚ å¾ˆå¤šæƒ…å†µä¸‹å®ƒçœŸçš„<br>å¯ä»¥ã€‚</p>
<p>é‚£ä¹ˆä½ ä¹Ÿè®¸ä¼šè¿™æ ·æƒ³ï¼Œ â€œæˆ‘ä»€ä¹ˆæ—¶å€™æ”¹ä½¿ç”¨ç»§æ‰¿ï¼Ÿâ€ è¿™å–å†³äºä½ æ‰‹ä¸Šçš„é—®é¢˜ï¼Œ ä¸è¿‡è¿™å„¿æœ‰ä¸€ä¸ªåƒæ ·çš„åˆ—è¡¨è¯´<br>æ˜ä»€ä¹ˆæ—¶å€™ç»§æ‰¿æ¯”ç»„åˆæ›´å¥½ç”¨ï¼š</p>
<ol>
<li>ä½ çš„ç»§æ‰¿è¡¨ç¤ºâ€æ˜¯ä¸€ä¸ªâ€çš„å…³ç³»è€Œä¸æ˜¯â€æœ‰ä¸€ä¸ªâ€çš„å…³ç³»ï¼ˆäººç±»-&gt;åŠ¨ç‰© vs ç”¨æˆ·-&gt;ç”¨æˆ·è¯¦æƒ…ï¼‰ï¼›</li>
<li>ä½ å¯ä»¥é‡ç”¨æ¥è‡ªåŸºç±»çš„ä»£ç ï¼ˆäººå¯ä»¥åƒæ‰€æœ‰åŠ¨ç‰©ä¸€æ ·è¡ŒåŠ¨ï¼‰ï¼›</li>
<li>ä½ æƒ³é€šè¿‡åŸºç±»å¯¹å­ç±»è¿›è¡Œå…¨å±€çš„ä¿®æ”¹ï¼ˆæ”¹å˜æ‰€æœ‰åŠ¨ç‰©è¡ŒåŠ¨æ—¶çš„çƒ­é‡æ¶ˆè€—ï¼‰ï¼›</li>
</ol>
<p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">class Employee&#123;</span><br><span class="line">    private String name;</span><br><span class="line">    private String email;</span><br><span class="line">&#125;</span><br><span class="line">// ä¸å¥½æ˜¯å› ä¸ºé›‡å‘˜â€œæœ‰â€ç¨ç‡æ•°æ®ï¼Œ EmployeeTaxData ä¸æ˜¯ä¸€ä¸ª Employee ç±»å‹ã€‚</span><br><span class="line">class EmployeeTaxData extends Employee&#123;</span><br><span class="line">    private String ssn;</span><br><span class="line">    private String salary;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> class EmployeeTaxData&#123;</span><br><span class="line">        private String ssn;</span><br><span class="line">        private String salary;</span><br><span class="line"></span><br><span class="line">        public EmployeeTaxData(String ssn, String salary) &#123;</span><br><span class="line">            this.ssn = ssn;</span><br><span class="line">            this.salary = salary;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">class Employee&#123;</span><br><span class="line">        private String name;</span><br><span class="line">        private String email;</span><br><span class="line">        private EmployeeTaxData taxData;</span><br><span class="line">        void setTaxData(String ssn,String salary)&#123;</span><br><span class="line">            this.taxData=new EmployeeTaxData(ssn,salary);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h2 id="SOLID"><a href="#SOLID" class="headerlink" title="SOLID"></a><strong>SOLID</strong></h2><h3 id="å•ä¸€èŒè´£åŸåˆ™-SRP"><a href="#å•ä¸€èŒè´£åŸåˆ™-SRP" class="headerlink" title="å•ä¸€èŒè´£åŸåˆ™ (SRP)"></a>å•ä¸€èŒè´£åŸåˆ™ (SRP)</h3><p>æ­£å¦‚ä»£ç æ•´æ´ä¹‹é“æ‰€è¿°ï¼Œ â€œæ°¸è¿œä¸è¦æœ‰è¶…è¿‡ä¸€ä¸ªç†ç”±æ¥ä¿®æ”¹ä¸€ä¸ªç±»â€ã€‚ ç»™ä¸€ä¸ªç±»å¡æ»¡è®¸å¤šåŠŸèƒ½ï¼Œ å°±åƒä½ åœ¨èˆª<br>ç­ä¸Šåªèƒ½å¸¦ä¸€ä¸ªè¡Œæç®±ä¸€æ ·ï¼Œ è¿™æ ·åšçš„é—®é¢˜ä½ çš„ç±»ä¸ä¼šæœ‰ç†æƒ³çš„å†…èšæ€§ï¼Œ å°†ä¼šæœ‰å¤ªå¤šçš„ç†ç”±æ¥å¯¹å®ƒè¿›è¡Œä¿®æ”¹ã€‚<br>æœ€å°åŒ–éœ€è¦ä¿®æ”¹ä¸€ä¸ªç±»çš„æ¬¡æ•°æ—¶å¾ˆé‡è¦çš„ï¼Œ å› ä¸ºå¦‚æœä¸€ä¸ªç±»æ‹¥æœ‰å¤ªå¤šçš„åŠŸèƒ½ï¼Œ ä¸€æ—¦ä½ ä¿®æ”¹å®ƒçš„ä¸€å°éƒ¨åˆ†ï¼Œ<br>å°†ä¼šå¾ˆéš¾å¼„æ¸…æ¥šä¼šå¯¹ä»£ç åº“ä¸­çš„å…¶å®ƒæ¨¡å—é€ æˆä»€ä¹ˆå½±å“ã€‚</p>
<p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">class UserSettings &#123;</span><br><span class="line">       User user;</span><br><span class="line"></span><br><span class="line">       void changeSettings(UserSettings settings) &#123;</span><br><span class="line">           if (this.verifyCredentials()) &#123;</span><br><span class="line">               // ...</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       void verifyCredentials() &#123;</span><br><span class="line">           // ...</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">User user;</span><br><span class="line">UserAuth auth;</span><br><span class="line"></span><br><span class="line">public UserSettings(User user) &#123;</span><br><span class="line">    this.user = user;</span><br><span class="line">    this.auth = new UserAuth(user);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void changeSettings(UserSettings settings) &#123;</span><br><span class="line">    if (this.auth.verifyCredentials()) &#123;</span><br><span class="line">        // ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h3 id="å¼€é—­åŸåˆ™-OCP"><a href="#å¼€é—­åŸåˆ™-OCP" class="headerlink" title="å¼€é—­åŸåˆ™ (OCP)"></a>å¼€é—­åŸåˆ™ (OCP)</h3><p>Bertrand Meyer è¯´è¿‡ï¼Œ â€œè½¯ä»¶å®ä½“ (ç±»ï¼Œ æ¨¡å—ï¼Œ å‡½æ•°ç­‰) åº”è¯¥ä¸ºæ‰©å±•å¼€æ”¾ï¼Œ ä½†æ˜¯ä¸ºä¿®æ”¹å…³é—­ã€‚â€ è¿™<br>æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ è¿™ä¸ªåŸåˆ™åŸºæœ¬ä¸Šè¯´æ˜äº†ä½ åº”è¯¥å…è®¸ç”¨æˆ·æ·»åŠ åŠŸèƒ½è€Œä¸å¿…ä¿®æ”¹ç°æœ‰çš„ä»£ç ã€‚</p>
<p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">class AjaxAdapter extends Adapter &#123;</span><br><span class="line">    private String name;</span><br><span class="line">    public  AjaxAdapter() &#123;</span><br><span class="line">        this.name = &quot;ajaxAdapter&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class NodeAdapter extends Adapter &#123;</span><br><span class="line">    private String name;</span><br><span class="line">    public NodeAdapter() &#123;</span><br><span class="line">        this.name = &quot;nodeAdapter&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class HttpRequester &#123;</span><br><span class="line">    public HttpRequester(Adapter adapter) &#123;</span><br><span class="line">        this.adapter = adapter;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    void fetch(String url) &#123;</span><br><span class="line">        if (&quot;ajaxAdapter&quot;.equals(this.adapter.name)) &#123;</span><br><span class="line">            makeAjaxCall(url);</span><br><span class="line">        &#125; else if (&quot;httpNodeAdapter&quot;.equals(this.adapter.name)) &#123;</span><br><span class="line">            makeHttpCall(url);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    void  makeAjaxCall(String url) &#123;</span><br><span class="line">    // request and return promise</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    void  makeHttpCall(String url) &#123;</span><br><span class="line">    // request and return promise</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">class AjaxAdapter extends Adapter &#123;</span><br><span class="line">    private String name;</span><br><span class="line">    public  AjaxAdapter() &#123;</span><br><span class="line">        this.name = &quot;ajaxAdapter&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    void request(String url)&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class NodeAdapter extends Adapter &#123;</span><br><span class="line">    private String name;</span><br><span class="line">    public NodeAdapter() &#123;</span><br><span class="line">        this.name = &quot;nodeAdapter&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    void request(String url)&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class HttpRequester &#123;</span><br><span class="line">    public  HttpRequester(Adapter adapter) &#123;</span><br><span class="line">        this.adapter = adapter;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    void fetch(String url) &#123;</span><br><span class="line">        this.adapter.request(url);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h3 id="é‡Œæ°ä»£æ¢åŸåˆ™-LSP"><a href="#é‡Œæ°ä»£æ¢åŸåˆ™-LSP" class="headerlink" title="é‡Œæ°ä»£æ¢åŸåˆ™ (LSP)"></a>é‡Œæ°ä»£æ¢åŸåˆ™ (LSP)</h3><p>è¿™æ˜¯é’ˆå¯¹ä¸€ä¸ªéå¸¸ç®€å•çš„é‡Œé¢çš„ä¸€ä¸ªææ€–æ„å›¾ï¼Œ å®ƒçš„æ­£å¼å®šä¹‰æ˜¯ï¼š â€œå¦‚æœ S æ˜¯ T çš„ä¸€ä¸ªå­ç±»å‹ï¼Œ é‚£ä¹ˆç±»<br>å‹ä¸º T çš„å¯¹è±¡å¯ä»¥è¢«ç±»å‹ä¸º S çš„å¯¹è±¡æ›¿æ¢ï¼ˆä¾‹å¦‚ï¼Œ ç±»å‹ä¸º S çš„å¯¹è±¡å¯ä½œä¸ºç±»å‹ä¸º T çš„æ›¿ä»£å“ï¼‰å„¿ä¸éœ€<br>è¦ä¿®æ”¹ç›®æ ‡ç¨‹åºçš„æœŸæœ›æ€§è´¨ ï¼ˆæ­£ç¡®æ€§ã€ ä»»åŠ¡æ‰§è¡Œæ€§ç­‰ï¼‰ã€‚â€ è¿™ç”šè‡³æ˜¯ä¸ªææ€–çš„å®šä¹‰ã€‚</p>
<p>æœ€å¥½çš„è§£é‡Šæ˜¯ï¼Œ å¦‚æœä½ åˆä¸€ä¸ªåŸºç±»å’Œä¸€ä¸ªå­ç±»ï¼Œ é‚£ä¸ªåŸºç±»å’Œå­—ç±»å¯ä»¥äº’æ¢è€Œä¸ä¼šäº§ç”Ÿä¸æ­£ç¡®çš„ç»“æœã€‚ è¿™å¯<br>èƒ½è¿˜æœ‰æœ‰äº›ç–‘æƒ‘ï¼Œ è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™ä¸ªç»å…¸çš„æ­£æ–¹å½¢ä¸çŸ©å½¢çš„ä¾‹å­ã€‚ ä»æ•°å­¦ä¸Šè¯´ï¼Œ ä¸€ä¸ªæ­£æ–¹å½¢æ˜¯ä¸€ä¸ªçŸ©å½¢ï¼Œ<br>ä½†æ˜¯ä½ ç”¨ â€œis-aâ€ çš„å…³ç³»ç”¨ç»§æ‰¿æ¥å®ç°ï¼Œ ä½ å°†å¾ˆå¿«é‡åˆ°éº»çƒ¦ã€‚</p>
<p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">class Rectangle &#123;</span><br><span class="line">    protected int width;</span><br><span class="line">    protected int height;</span><br><span class="line">    public Rectangle() &#123;</span><br><span class="line">        this.width = 0;</span><br><span class="line">        this.height = 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    void setColor(String color) &#123;</span><br><span class="line">       // ...</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    void render(int  area) &#123;</span><br><span class="line">        // ...</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    void setWidth(int width) &#123;</span><br><span class="line">        this.width = width;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    void setHeight(int height) &#123;</span><br><span class="line">        this.height = height;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    int getArea() &#123;</span><br><span class="line">        return this.width * this.height;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Square extends Rectangle &#123;</span><br><span class="line">    void setWidth(int width) &#123;</span><br><span class="line">        this.width = width;</span><br><span class="line">        this.height = width;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    void setHeight(int height) &#123;</span><br><span class="line">        this.width = height;</span><br><span class="line">        this.height = height;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void  renderLargeRectangles(List&lt;Rectangle&gt; rectangles) &#123;</span><br><span class="line">    for(Rectangle rectangle:rectangles) &#123;</span><br><span class="line">        rectangle.setWidth(4);</span><br><span class="line">        rectangle.setHeight(5);</span><br><span class="line">        int area = rectangle.getArea(); // BAD: Will return 25 for Square. Should be 20.</span><br><span class="line">        rectangle.render(area);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">List&lt;Rectangle&gt; rectangles=new ArrayList&lt;&gt;();</span><br><span class="line">rectangles.add(new Rectangle());</span><br><span class="line">rectangles.add(new Rectangle());</span><br><span class="line">rectangles.add(new Square());</span><br><span class="line">renderLargeRectangles(rectangles);</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">class Shape &#123;</span><br><span class="line">    void setColor(String color) &#123;</span><br><span class="line">        // ...</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    int getArea() &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    void render(int area) &#123;</span><br><span class="line">        // ...</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Rectangle extends Shape &#123;</span><br><span class="line">    private int width;</span><br><span class="line">    private int height;</span><br><span class="line">    public Rectangle(int width, int height) &#123;</span><br><span class="line">        super();</span><br><span class="line">        this.width = width;</span><br><span class="line">        this.height = height;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    int getArea() &#123;</span><br><span class="line">        return this.width * this.height;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">class Square extends Shape &#123;</span><br><span class="line">    private int length;</span><br><span class="line">    public Square(int length) &#123;</span><br><span class="line">        super();</span><br><span class="line">        this.length = length;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    int getArea() &#123;</span><br><span class="line">        return this.length * this.length;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void  renderLargeShapes(List&lt;Shape&gt; shapes) &#123;</span><br><span class="line">    for(Shape shape:shapes) &#123;</span><br><span class="line">        int area = shape.getArea();</span><br><span class="line">        shape.render(area);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">List&lt;Shape&gt; shapes=new ArrayList&lt;&gt;();</span><br><span class="line">shapes.add(new Rectangle(4,5));</span><br><span class="line">shapes.add(new Rectangle(4,5));</span><br><span class="line">shapes.add(new Square(5));</span><br><span class="line">renderLargeShapes(shapes);</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h3 id="æ¥å£éš”ç¦»åŸåˆ™-ISP"><a href="#æ¥å£éš”ç¦»åŸåˆ™-ISP" class="headerlink" title="æ¥å£éš”ç¦»åŸåˆ™ (ISP)"></a>æ¥å£éš”ç¦»åŸåˆ™ (ISP)</h3><p>æ¥å£éš”ç¦»åŸåˆ™è¯´çš„æ˜¯ â€œå®¢æˆ·ç«¯ä¸åº”è¯¥å¼ºåˆ¶ä¾èµ–ä»–ä»¬ä¸éœ€è¦çš„æ¥å£ã€‚â€</p>
<p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">interface I &#123;</span><br><span class="line">          public void method1();</span><br><span class="line">          public void method2();</span><br><span class="line">          public void method3();</span><br><span class="line">          public void method4();</span><br><span class="line">          public void method5();</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      class A&#123;</span><br><span class="line">          public void depend1(I i)&#123;</span><br><span class="line">              i.method1();</span><br><span class="line">          &#125;</span><br><span class="line">          public void depend2(I i)&#123;</span><br><span class="line">              i.method2();</span><br><span class="line">          &#125;</span><br><span class="line">          public void depend3(I i)&#123;</span><br><span class="line">              i.method3();</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      class B&#123;</span><br><span class="line">          public void depend1(I i)&#123;</span><br><span class="line">              i.method1();</span><br><span class="line">          &#125;</span><br><span class="line">          public void depend2(I i)&#123;</span><br><span class="line">              i.method4();</span><br><span class="line">          &#125;</span><br><span class="line">          public void depend3(I i)&#123;</span><br><span class="line">              i.method5();</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      class C implements I&#123;</span><br><span class="line">          public void method1() &#123;</span><br><span class="line">              System.out.println(&quot;ç±»Bå®ç°æ¥å£Içš„æ–¹æ³•1&quot;);</span><br><span class="line">          &#125;</span><br><span class="line">          public void method2() &#123;</span><br><span class="line">              System.out.println(&quot;ç±»Bå®ç°æ¥å£Içš„æ–¹æ³•2&quot;);</span><br><span class="line">          &#125;</span><br><span class="line">          public void method3() &#123;</span><br><span class="line">              System.out.println(&quot;ç±»Bå®ç°æ¥å£Içš„æ–¹æ³•3&quot;);</span><br><span class="line">          &#125;</span><br><span class="line">          //å¯¹äºç±»Bæ¥è¯´ï¼Œmethod4å’Œmethod5ä¸æ˜¯å¿…éœ€çš„ï¼Œä½†æ˜¯ç”±äºæ¥å£Aä¸­æœ‰è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œ</span><br><span class="line">          //æ‰€ä»¥åœ¨å®ç°è¿‡ç¨‹ä¸­å³ä½¿è¿™ä¸¤ä¸ªæ–¹æ³•çš„æ–¹æ³•ä½“ä¸ºç©ºï¼Œä¹Ÿè¦å°†è¿™ä¸¤ä¸ªæ²¡æœ‰ä½œç”¨çš„æ–¹æ³•è¿›è¡Œå®ç°ã€‚</span><br><span class="line">          public void method4() &#123;&#125;</span><br><span class="line">          public void method5() &#123;&#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      class D implements I&#123;</span><br><span class="line">          public void method1() &#123;</span><br><span class="line">              System.out.println(&quot;ç±»Då®ç°æ¥å£Içš„æ–¹æ³•1&quot;);</span><br><span class="line">          &#125;</span><br><span class="line">          //å¯¹äºç±»Dæ¥è¯´ï¼Œmethod2å’Œmethod3ä¸æ˜¯å¿…éœ€çš„ï¼Œä½†æ˜¯ç”±äºæ¥å£Aä¸­æœ‰è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œ</span><br><span class="line">          //æ‰€ä»¥åœ¨å®ç°è¿‡ç¨‹ä¸­å³ä½¿è¿™ä¸¤ä¸ªæ–¹æ³•çš„æ–¹æ³•ä½“ä¸ºç©ºï¼Œä¹Ÿè¦å°†è¿™ä¸¤ä¸ªæ²¡æœ‰ä½œç”¨çš„æ–¹æ³•è¿›è¡Œå®ç°ã€‚</span><br><span class="line">          public void method2() &#123;&#125;</span><br><span class="line">          public void method3() &#123;&#125;</span><br><span class="line"></span><br><span class="line">          public void method4() &#123;</span><br><span class="line">              System.out.println(&quot;ç±»Då®ç°æ¥å£Içš„æ–¹æ³•4&quot;);</span><br><span class="line">          &#125;</span><br><span class="line">          public void method5() &#123;</span><br><span class="line">              System.out.println(&quot;ç±»Då®ç°æ¥å£Içš„æ–¹æ³•5&quot;);</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">interface I1 &#123;</span><br><span class="line">         public void method1();</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     interface I2 &#123;</span><br><span class="line">         public void method2();</span><br><span class="line">         public void method3();</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     interface I3 &#123;</span><br><span class="line">         public void method4();</span><br><span class="line">         public void method5();</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     class A&#123;</span><br><span class="line">         public void depend1(I1 i)&#123;</span><br><span class="line">             i.method1();</span><br><span class="line">         &#125;</span><br><span class="line">         public void depend2(I2 i)&#123;</span><br><span class="line">             i.method2();</span><br><span class="line">         &#125;</span><br><span class="line">         public void depend3(I2 i)&#123;</span><br><span class="line">             i.method3();</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     class B&#123;</span><br><span class="line">         public void depend1(I1 i)&#123;</span><br><span class="line">             i.method1();</span><br><span class="line">         &#125;</span><br><span class="line">         public void depend2(I3 i)&#123;</span><br><span class="line">             i.method4();</span><br><span class="line">         &#125;</span><br><span class="line">         public void depend3(I3 i)&#123;</span><br><span class="line">             i.method5();</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">     class C implements I1, I2&#123;</span><br><span class="line">         public void method1() &#123;</span><br><span class="line">             System.out.println(&quot;ç±»Bå®ç°æ¥å£I1çš„æ–¹æ³•1&quot;);</span><br><span class="line">         &#125;</span><br><span class="line">         public void method2() &#123;</span><br><span class="line">             System.out.println(&quot;ç±»Bå®ç°æ¥å£I2çš„æ–¹æ³•2&quot;);</span><br><span class="line">         &#125;</span><br><span class="line">         public void method3() &#123;</span><br><span class="line">             System.out.println(&quot;ç±»Bå®ç°æ¥å£I2çš„æ–¹æ³•3&quot;);</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">     class D implements I1, I3&#123;</span><br><span class="line">         public void method1() &#123;</span><br><span class="line">             System.out.println(&quot;ç±»Då®ç°æ¥å£I1çš„æ–¹æ³•1&quot;);</span><br><span class="line">         &#125;</span><br><span class="line">         public void method4() &#123;</span><br><span class="line">             System.out.println(&quot;ç±»Då®ç°æ¥å£I3çš„æ–¹æ³•4&quot;);</span><br><span class="line">         &#125;</span><br><span class="line">         public void method5() &#123;</span><br><span class="line">             System.out.println(&quot;ç±»Då®ç°æ¥å£I3çš„æ–¹æ³•5&quot;);</span><br><span class="line">         &#125;</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h3 id="ä¾èµ–åè½¬åŸåˆ™-DIP"><a href="#ä¾èµ–åè½¬åŸåˆ™-DIP" class="headerlink" title="ä¾èµ–åè½¬åŸåˆ™ (DIP)"></a>ä¾èµ–åè½¬åŸåˆ™ (DIP)</h3><p>è¿™ä¸ªåŸåˆ™é˜è¿°äº†ä¸¤ä¸ªé‡è¦çš„äº‹æƒ…ï¼š</p>
<ol>
<li>é«˜çº§æ¨¡å—ä¸åº”è¯¥ä¾èµ–äºä½çº§æ¨¡å—ï¼Œ ä¸¤è€…éƒ½åº”è¯¥ä¾èµ–ä¸æŠ½è±¡ï¼›</li>
<li>æŠ½è±¡ä¸åº”å½“ä¾èµ–äºå…·ä½“å®ç°ï¼Œ å…·ä½“å®ç°åº”å½“ä¾èµ–äºæŠ½è±¡ã€‚</li>
</ol>
<p>è¿™ä¸ªä¸€å¼€å§‹ä¼šå¾ˆéš¾ç†è§£ï¼Œ ä½†æ˜¯å¦‚æœä½ ä½¿ç”¨è¿‡ Angular.js ï¼Œ ä½ åº”è¯¥å·²ç»çœ‹åˆ°è¿‡é€šè¿‡ä¾èµ–æ³¨å…¥æ¥å®ç°çš„è¿™<br>ä¸ªåŸåˆ™ï¼Œ è™½ç„¶ä»–ä»¬ä¸æ˜¯ç›¸åŒçš„æ¦‚å¿µï¼Œ ä¾èµ–åè½¬åŸåˆ™è®©é«˜çº§æ¨¡å—è¿œç¦»ä½çº§æ¨¡å—çš„ç»†èŠ‚å’Œåˆ›å»ºï¼Œ å¯ä»¥é€šè¿‡ DI<br>æ¥å®ç°ã€‚ è¿™æ ·åšçš„å·¨å¤§ç›Šå¤„æ˜¯é™ä½æ¨¡å—é—´çš„è€¦åˆã€‚ è€¦åˆæ˜¯ä¸€ä¸ªéå¸¸ç³Ÿç³•çš„å¼€å‘æ¨¡å¼ï¼Œ å› ä¸ºä¼šå¯¼è‡´ä»£ç éš¾äº<br>é‡æ„ã€‚</p>
<p>å¦‚ä¸Šæ‰€è¿°ï¼Œ JavaScript æ²¡æœ‰æ¥å£ï¼Œ æ‰€ä»¥è¢«ä¾èµ–çš„æŠ½è±¡æ˜¯éšå¼å¥‘çº¦ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œ ä¸€ä¸ªå¯¹è±¡/ç±»çš„æ–¹æ³•å’Œ<br>å±æ€§ç›´æ¥æš´éœ²ç»™å¦å¤–ä¸€ä¸ªå¯¹è±¡/ç±»ã€‚ åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œ ä»»ä½•ä¸€ä¸ª Request æ¨¡å—çš„éšå¼å¥‘çº¦ <code>InventoryTracker</code><br>å°†æœ‰ä¸€ä¸ª <code>requestItems</code> æ–¹æ³•ã€‚</p>
<p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">class InventoryRequester &#123;</span><br><span class="line">      private String REQ_METHODS;</span><br><span class="line">      public InventoryRequester() &#123;</span><br><span class="line">          this.REQ_METHODS = &quot;HTTP&quot;;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      void requestItem(String item) &#123;</span><br><span class="line">          // ...</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  class InventoryTracker &#123;</span><br><span class="line">      private List&lt;String&gt; items;</span><br><span class="line">      private InventoryRequester requester;</span><br><span class="line">      public InventoryTracker(List&lt;String&gt; items) &#123;</span><br><span class="line">          this.items = items;</span><br><span class="line"></span><br><span class="line">          // ä¸å¥½çš„ï¼š æˆ‘ä»¬å·²ç»åˆ›å»ºäº†ä¸€ä¸ªå¯¹è¯·æ±‚çš„å…·ä½“å®ç°çš„ä¾èµ–ï¼Œ æˆ‘ä»¬åªæœ‰ä¸€ä¸ª requestItems æ–¹æ³•ä¾</span><br><span class="line">          // èµ–ä¸€ä¸ªè¯·æ±‚æ–¹æ³• &apos;request&apos;</span><br><span class="line">          this.requester = new InventoryRequester();</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      void requestItems() &#123;</span><br><span class="line">          this.items.stream().forEach(item-&gt;this.requester.requestItem(item));</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  List&lt;String&gt; items=new ArrayList&lt;&gt;();</span><br><span class="line">  items.add(&quot;apples&quot;);</span><br><span class="line">  items.add(&quot;bananas&quot;);</span><br><span class="line">  InventoryTracker inventoryTracker = new InventoryTracker(items);</span><br><span class="line">  inventoryTracker.requestItems();</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">interface Requester&#123;</span><br><span class="line">          void requestItem(String item);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  class InventoryTracker &#123;</span><br><span class="line">      List&lt;String&gt; items;</span><br><span class="line">      Requester requester;</span><br><span class="line">      public InventoryTracker(List&lt;String&gt; items, Requester requester) &#123;</span><br><span class="line">          this.items = items;</span><br><span class="line">          this.requester = requester;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      void requestItems() &#123;</span><br><span class="line">          this.items.stream().forEach(item-&gt;requester.requestItem(item));</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  class InventoryRequesterV1 implements Requester&#123;</span><br><span class="line">      String REQ_METHODS;</span><br><span class="line">      public InventoryRequesterV1() &#123;</span><br><span class="line">          this.REQ_METHODS=&quot;HTTP&quot;;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      @Override</span><br><span class="line">      public void requestItem(String item) &#123;</span><br><span class="line">          // ...</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  class InventoryRequesterV2 implements Requester&#123;</span><br><span class="line">      String REQ_METHODS;</span><br><span class="line">      public InventoryRequesterV2() &#123;</span><br><span class="line">          this.REQ_METHODS=&quot;WS&quot;;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      @Override</span><br><span class="line">      public void requestItem(String item) &#123;</span><br><span class="line">          // ...</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  // é€šè¿‡å¤–éƒ¨åˆ›å»ºä¾èµ–é¡¹å¹¶å°†å®ƒä»¬æ³¨å…¥ï¼Œ æˆ‘ä»¬å¯ä»¥è½»æ¾çš„ç”¨ä¸€ä¸ªå´­æ–°çš„ä½¿ç”¨ WebSockets çš„è¯·æ±‚æ¨¡å—è¿›è¡Œæ›¿æ¢ã€‚</span><br><span class="line">  List&lt;String&gt; items=new ArrayList&lt;&gt;();</span><br><span class="line">  items.add(&quot;apples&quot;);</span><br><span class="line">  items.add(&quot;bananas&quot;);</span><br><span class="line">  InventoryTracker inventoryTracker = new InventoryTracker(items, new InventoryRequesterV2());</span><br><span class="line">  inventoryTracker.requestItems();</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a><strong>æµ‹è¯•</strong></h2><p>æµ‹è¯•æ¯”å‘å¸ƒæ›´åŠ é‡è¦ã€‚ å¦‚æœä½ æ²¡æœ‰æµ‹è¯•æˆ–è€…æµ‹è¯•ä¸å¤Ÿå……åˆ†ï¼Œ æ¯æ¬¡å‘å¸ƒæ—¶ä½ å°±ä¸èƒ½ç¡®è®¤æ²¡æœ‰ç ´åä»»ä½•äº‹æƒ…ã€‚<br>æµ‹è¯•çš„é‡ç”±ä½ çš„å›¢é˜Ÿå†³å®šï¼Œ ä½†æ˜¯æ‹¥æœ‰ 100% çš„è¦†ç›–ç‡(åŒ…æ‹¬æ‰€æœ‰çš„è¯­å¥å’Œåˆ†æ”¯)æ˜¯ä½ ä¸ºä»€ä¹ˆèƒ½è¾¾åˆ°é«˜åº¦è‡ªä¿¡<br>å’Œå†…å¿ƒçš„å¹³é™ã€‚ è¿™æ„å‘³ç€éœ€è¦ä¸€ä¸ªé¢å¤–çš„ä¼Ÿå¤§çš„æµ‹è¯•æ¡†æ¶ï¼Œ ä¹Ÿéœ€è¦ä¸€ä¸ªå¥½çš„<a href="http://gotwarlost.github.io/istanbul/" target="_blank" rel="noopener">è¦†ç›–ç‡å·¥å…·</a>ã€‚</p>
<p>æ²¡æœ‰ç†ç”±ä¸å†™æµ‹è¯•ã€‚ è¿™é‡Œæœ‰<a href="http://jstherightway.org/#testing-tools" target="_blank" rel="noopener">å¤§é‡çš„ä¼˜ç§€çš„ JS æµ‹è¯•æ¡†æ¶</a>ï¼Œ<br>é€‰ä¸€ä¸ªé€‚åˆä½ çš„å›¢é˜Ÿçš„å³å¯ã€‚ å½“ä¸ºå›¢é˜Ÿé€‰æ‹©äº†æµ‹è¯•æ¡†æ¶ä¹‹åï¼Œ æ¥ä¸‹æ¥çš„ç›®æ ‡æ˜¯ä¸ºç”Ÿäº§çš„æ¯ä¸€ä¸ªæ–°çš„åŠŸèƒ½ï¼æ¨¡<br>å—ç¼–å†™æµ‹è¯•ã€‚ å¦‚æœä½ å€¾å‘äºæµ‹è¯•é©±åŠ¨å¼€å‘(TDD)ï¼Œ é‚£å°±å¤ªæ£’äº†ï¼Œ ä½†æ˜¯è¦ç‚¹æ˜¯ç¡®è®¤ä½ åœ¨ä¸Šçº¿ä»»ä½•åŠŸèƒ½æˆ–è€…é‡<br>æ„ä¸€ä¸ªç°æœ‰åŠŸèƒ½ä¹‹å‰ï¼Œ è¾¾åˆ°äº†éœ€è¦çš„ç›®æ ‡è¦†ç›–ç‡ã€‚</p>
<h3 id="ä¸€ä¸ªæµ‹è¯•ä¸€ä¸ªæ¦‚å¿µ"><a href="#ä¸€ä¸ªæµ‹è¯•ä¸€ä¸ªæ¦‚å¿µ" class="headerlink" title="ä¸€ä¸ªæµ‹è¯•ä¸€ä¸ªæ¦‚å¿µ"></a>ä¸€ä¸ªæµ‹è¯•ä¸€ä¸ªæ¦‚å¿µ</h3><p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">void testMakeMomentJSGreatAgain()&#123;</span><br><span class="line">        Date date;</span><br><span class="line">        date = new MakeMomentJSGreatAgain(&quot;1/1/2015&quot;);</span><br><span class="line">        date.addDays(30);</span><br><span class="line">        Assert.equal(date.getString(),&quot;1/31/2015&quot;).</span><br><span class="line"></span><br><span class="line">        date = new MakeMomentJSGreatAgain(&quot;2/1/2016&quot;);</span><br><span class="line">        date.addDays(28);</span><br><span class="line">        Assert.equal(date.getString(),&quot;02/29/2016&quot;);</span><br><span class="line"></span><br><span class="line">        date = new MakeMomentJSGreatAgain(&quot;2/1/2015&quot;);</span><br><span class="line">        date.addDays(28);</span><br><span class="line">        Assert.equal(date.getString(),&quot;03/01/2015&quot;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">void testThirtyDayMonths()&#123;</span><br><span class="line">        Date date = new MakeMomentJSGreatAgain(&quot;1/1/2015&quot;);</span><br><span class="line">        date.addDays(30);</span><br><span class="line">        Assert.equal(date.getString(),&quot;1/31/2015&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">void testLeapYear()&#123;</span><br><span class="line">        Date date = new MakeMomentJSGreatAgain(&quot;2/1/2016&quot;);</span><br><span class="line">        date.addDays(28);</span><br><span class="line">        Assert.equal(date.getString(),&quot;02/29/2016&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">void testNonLeapYear()&#123;</span><br><span class="line">        Date date = new MakeMomentJSGreatAgain(&quot;2/1/2015&quot;);</span><br><span class="line">        date.addDays(28);</span><br><span class="line">        Assert.equal(date.getString(),&quot;03/01/2015&quot;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h2 id="é”™è¯¯å¤„ç†"><a href="#é”™è¯¯å¤„ç†" class="headerlink" title="é”™è¯¯å¤„ç†"></a><strong>é”™è¯¯å¤„ç†</strong></h2><p>æŠ›å‡ºé”™è¯¯æ˜¯ä¸€ä»¶å¥½äº‹æƒ…ï¼ ä»–ä»¬æ„å‘³ç€å½“ä½ çš„ç¨‹åºæœ‰é”™æ—¶è¿è¡Œæ—¶å¯ä»¥æˆåŠŸç¡®è®¤ï¼Œ å¹¶ä¸”é€šè¿‡åœæ­¢æ‰§è¡Œå½“å‰å †æ ˆ<br>ä¸Šçš„å‡½æ•°æ¥è®©ä½ çŸ¥é“ï¼Œ ç»“æŸå½“å‰è¿›ç¨‹ï¼ˆåœ¨ Node ä¸­ï¼‰ï¼Œ åœ¨æ§åˆ¶å°ä¸­ç”¨ä¸€ä¸ªå †æ ˆè·Ÿè¸ªæç¤ºä½ ã€‚</p>
<h3 id="ä¸è¦å¿½ç•¥æ•æ‰åˆ°çš„é”™è¯¯"><a href="#ä¸è¦å¿½ç•¥æ•æ‰åˆ°çš„é”™è¯¯" class="headerlink" title="ä¸è¦å¿½ç•¥æ•æ‰åˆ°çš„é”™è¯¯"></a>ä¸è¦å¿½ç•¥æ•æ‰åˆ°çš„é”™è¯¯</h3><p>å¯¹æ•æ‰åˆ°çš„é”™è¯¯ä¸åšä»»ä½•å¤„ç†ä¸èƒ½ç»™ä½ ä¿®å¤é”™è¯¯æˆ–è€…å“åº”é”™è¯¯çš„èƒ½åŠ›ã€‚ å‘æ§åˆ¶å°è®°å½•é”™è¯¯ (<code>console.log</code>)<br>ä¹Ÿä¸æ€ä¹ˆå¥½ï¼Œ å› ä¸ºå¾€å¾€ä¼šä¸¢å¤±åœ¨æµ·é‡çš„æ§åˆ¶å°è¾“å‡ºä¸­ã€‚ å¦‚æœä½ æŠŠä»»æ„ä¸€æ®µä»£ç ç”¨ <code>try/catch</code> åŒ…è£…é‚£å°±<br>æ„å‘³ç€ä½ æƒ³åˆ°è¿™é‡Œå¯èƒ½ä¼šé”™ï¼Œ å› æ­¤ä½ åº”è¯¥æœ‰ä¸ªä¿®å¤è®¡åˆ’ï¼Œ æˆ–è€…å½“é”™è¯¯å‘ç”Ÿæ—¶æœ‰ä¸€ä¸ªä»£ç è·¯å¾„ã€‚</p>
<p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line">      functionThatMightThrow();</span><br><span class="line">  &#125; catch (Exception error) &#123;</span><br><span class="line">      console.log(error);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line">       functionThatMightThrow();</span><br><span class="line">   &#125; catch (Exception error) &#123;</span><br><span class="line">       // One option (more noisy than console.log):</span><br><span class="line">       console.error(error);</span><br><span class="line">       // Another option:</span><br><span class="line">       notifyUserOfError(error);</span><br><span class="line">       // Another option:</span><br><span class="line">       reportErrorToService(error);</span><br><span class="line">       // OR do all three!</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="æ ¼å¼åŒ–"><a href="#æ ¼å¼åŒ–" class="headerlink" title="æ ¼å¼åŒ–"></a><strong>æ ¼å¼åŒ–</strong></h2><p>æ ¼å¼åŒ–æ˜¯ä¸»è§‚çš„ã€‚ å°±åƒå…¶å®ƒè§„åˆ™ä¸€æ ·ï¼Œ æ²¡æœ‰å¿…é¡»è®©ä½ éµå®ˆçš„ç¡¬æ€§è§„åˆ™ã€‚ é‡ç‚¹æ˜¯ä¸è¦å› ä¸ºæ ¼å¼å»äº‰è®ºï¼Œ è¿™<br>é‡Œæœ‰<a href="http://standardjs.com/rules.html" target="_blank" rel="noopener">å¤§é‡çš„å·¥å…·</a>æ¥è‡ªåŠ¨æ ¼å¼åŒ–ï¼Œ ä½¿ç”¨å…¶ä¸­çš„ä¸€ä¸ªå³å¯ï¼ å› <br>ä¸ºåšä¸ºå·¥ç¨‹å¸ˆå»äº‰è®ºæ ¼å¼åŒ–å°±æ˜¯åœ¨æµªè´¹æ—¶é—´å’Œé‡‘é’±ã€‚</p>
<p>é’ˆå¯¹è‡ªåŠ¨æ ¼å¼åŒ–å·¥å…·ä¸èƒ½æ¶µç›–çš„é—®é¢˜ï¼ˆç¼©è¿›ã€ åˆ¶è¡¨ç¬¦è¿˜æ˜¯ç©ºæ ¼ã€ åŒå¼•å·è¿˜æ˜¯å•å¼•å·ç­‰ï¼‰ï¼Œ è¿™é‡Œæœ‰ä¸€äº›æŒ‡å—ã€‚</p>
<h3 id="ä½¿ç”¨ä¸€è‡´çš„å¤§å°å†™"><a href="#ä½¿ç”¨ä¸€è‡´çš„å¤§å°å†™" class="headerlink" title="ä½¿ç”¨ä¸€è‡´çš„å¤§å°å†™"></a>ä½¿ç”¨ä¸€è‡´çš„å¤§å°å†™</h3><p>JavaScript æ˜¯æ— ç±»å‹çš„ï¼Œ æ‰€ä»¥å¤§å°å†™å‘Šè¯‰ä½ å…³äºä½ çš„å˜é‡ã€ å‡½æ•°ç­‰çš„å¾ˆå¤šäº‹æƒ…ã€‚ è¿™äº›è§„åˆ™æ˜¯ä¸»è§‚çš„ï¼Œ<br>æ‰€ä»¥ä½ çš„å›¢é˜Ÿå¯ä»¥é€‰æ‹©ä»–ä»¬æƒ³è¦çš„ã€‚ é‡ç‚¹æ˜¯ï¼Œ ä¸ç®¡ä½ ä»¬é€‰æ‹©äº†ä»€ä¹ˆï¼Œ è¦ä¿æŒä¸€è‡´ã€‚</p>
<p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">int DAYS_IN_WEEK = 7;</span><br><span class="line">int  daysInMonth = 30;</span><br><span class="line"></span><br><span class="line">String[] songs = &#123;&quot;Back In Black&quot;, &quot;Stairway to Heaven&quot;, &quot;Hey Jude&quot;&#125;;</span><br><span class="line">String[] Artists = &#123;&quot;ACDC&quot;, &quot;Led Zeppelin&quot;, &quot;The Beatles&quot;&#125;;</span><br><span class="line"></span><br><span class="line">void eraseDatabase() &#123;&#125;</span><br><span class="line">void restore_database() &#123;&#125;</span><br><span class="line"></span><br><span class="line">class animal &#123;&#125;</span><br><span class="line">class Alpaca &#123;&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">int DAYS_IN_WEEK = 7;</span><br><span class="line">int DAYS_IN_MONTH = 30;</span><br><span class="line"></span><br><span class="line">String[] songs = &#123;&quot;Back In Black&quot;, &quot;Stairway to Heaven&quot;, &quot;Hey Jude&quot;&#125;;</span><br><span class="line">String[] artists = &#123;&quot;ACDC&quot;, &quot;Led Zeppelin&quot;, &quot;The Beatles&quot;&#125;;</span><br><span class="line"></span><br><span class="line">void eraseDatabase() &#123;&#125;</span><br><span class="line">void restoreDatabase() &#123;&#125;</span><br><span class="line"></span><br><span class="line">class Animal &#123;&#125;</span><br><span class="line">class Alpaca &#123;&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h3 id="å‡½æ•°çš„è°ƒç”¨æ–¹ä¸è¢«è°ƒç”¨æ–¹åº”è¯¥é è¿‘"><a href="#å‡½æ•°çš„è°ƒç”¨æ–¹ä¸è¢«è°ƒç”¨æ–¹åº”è¯¥é è¿‘" class="headerlink" title="å‡½æ•°çš„è°ƒç”¨æ–¹ä¸è¢«è°ƒç”¨æ–¹åº”è¯¥é è¿‘"></a>å‡½æ•°çš„è°ƒç”¨æ–¹ä¸è¢«è°ƒç”¨æ–¹åº”è¯¥é è¿‘</h3><p>å¦‚æœä¸€ä¸ªå‡½æ•°è°ƒç”¨å¦ä¸€ä¸ªï¼Œ åˆ™åœ¨ä»£ç ä¸­è¿™ä¸¤ä¸ªå‡½æ•°çš„ç«–ç›´ä½ç½®åº”è¯¥é è¿‘ã€‚ ç†æƒ³æƒ…å†µä¸‹ï¼Œä¿æŒè¢«è°ƒç”¨å‡½æ•°åœ¨è¢«<br>è°ƒç”¨å‡½æ•°çš„æ­£ä¸Šæ–¹ã€‚ æˆ‘ä»¬å€¾å‘äºä»ä¸Šåˆ°ä¸‹é˜…è¯»ä»£ç ï¼Œ å°±åƒè¯»ä¸€ç« æŠ¥çº¸ã€‚ ç”±äºè¿™ä¸ªåŸå› ï¼Œ ä¿æŒä½ çš„ä»£ç å¯<br>ä»¥æŒ‰ç…§è¿™ç§æ–¹å¼é˜…è¯»ã€‚</p>
<p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">class PerformanceReview &#123;</span><br><span class="line">       String employee;</span><br><span class="line">       public PerformanceReview(String employee) &#123;</span><br><span class="line">           this.employee = employee;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       String lookupPeers() &#123;</span><br><span class="line">           return db.lookup(this.employee, &quot;peers&quot;);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       String lookupManager() &#123;</span><br><span class="line">           return db.lookup(this.employee, &quot;manager&quot;);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       void getPeerReviews() &#123;</span><br><span class="line">           String  peers = this.lookupPeers();</span><br><span class="line">           // ...</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       public void perfReview() &#123;</span><br><span class="line">           this.getPeerReviews();</span><br><span class="line">           this.getManagerReview();</span><br><span class="line">           this.getSelfReview();</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       void getManagerReview() &#123;</span><br><span class="line">           String  manager = this.lookupManager();</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       void getSelfReview() &#123;</span><br><span class="line">           // ...</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   PerformanceReview  review = new PerformanceReview(&quot;user&quot;);</span><br><span class="line">   review.perfReview();</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">class PerformanceReview &#123;</span><br><span class="line">        String employee;</span><br><span class="line">        public PerformanceReview(String employee) &#123;</span><br><span class="line">            this.employee = employee;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        void perfReview() &#123;</span><br><span class="line">            this.getPeerReviews();</span><br><span class="line">            this.getManagerReview();</span><br><span class="line">            this.getSelfReview();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        void getPeerReviews() &#123;</span><br><span class="line">            String  peers = this.lookupPeers();</span><br><span class="line">            // ...</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        String lookupPeers() &#123;</span><br><span class="line">            return db.lookup(this.employee, &quot;peers&quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        void getManagerReview() &#123;</span><br><span class="line">            String  manager = this.lookupManager();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        String lookupManager() &#123;</span><br><span class="line">            return db.lookup(this.employee, &quot;manager&quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public void getSelfReview() &#123;</span><br><span class="line">            // ...</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    PerformanceReview review = new PerformanceReview(&quot;user&quot;);</span><br><span class="line">    review.perfReview();</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h2 id="æ³¨é‡Š"><a href="#æ³¨é‡Š" class="headerlink" title="æ³¨é‡Š"></a><strong>æ³¨é‡Š</strong></h2><h3 id="ä»…ä»…å¯¹åŒ…å«å¤æ‚ä¸šåŠ¡é€»è¾‘çš„ä¸œè¥¿è¿›è¡Œæ³¨é‡Š"><a href="#ä»…ä»…å¯¹åŒ…å«å¤æ‚ä¸šåŠ¡é€»è¾‘çš„ä¸œè¥¿è¿›è¡Œæ³¨é‡Š" class="headerlink" title="ä»…ä»…å¯¹åŒ…å«å¤æ‚ä¸šåŠ¡é€»è¾‘çš„ä¸œè¥¿è¿›è¡Œæ³¨é‡Š"></a>ä»…ä»…å¯¹åŒ…å«å¤æ‚ä¸šåŠ¡é€»è¾‘çš„ä¸œè¥¿è¿›è¡Œæ³¨é‡Š</h3><p>æ³¨é‡Šæ˜¯ä»£ç çš„è¾©è§£ï¼Œ ä¸æ˜¯è¦æ±‚ã€‚ å¤šæ•°æƒ…å†µä¸‹ï¼Œ å¥½çš„ä»£ç å°±æ˜¯æ–‡æ¡£ã€‚</p>
<p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">void hashIt(String data) &#123;</span><br><span class="line">        // The hash</span><br><span class="line">        long hash = 0;</span><br><span class="line"></span><br><span class="line">        // Length of string</span><br><span class="line">        int length = data.length();</span><br><span class="line"></span><br><span class="line">        // Loop through every character in data</span><br><span class="line">        for (int i = 0; i &lt; length; i++) &#123;</span><br><span class="line">            // Get character code.</span><br><span class="line">            char mChar = data.charAt(i);</span><br><span class="line">            // Make the hash</span><br><span class="line">            hash = ((hash &lt;&lt; 5) - hash) + mChar;</span><br><span class="line">            // Convert to 32-bit integer</span><br><span class="line">            hash &amp;= hash;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">void hashIt(String data) &#123;</span><br><span class="line">       long hash = 0;</span><br><span class="line">       int length = data.length();</span><br><span class="line"></span><br><span class="line">       for (int i = 0; i &lt; length; i++) &#123;</span><br><span class="line">           char mchar = data.charAt(i);</span><br><span class="line">           hash = ((hash &lt;&lt; 5) - hash) + mchar;</span><br><span class="line"></span><br><span class="line">           // Convert to 32-bit integer</span><br><span class="line">           hash &amp;= hash;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h3 id="ä¸è¦åœ¨ä»£ç åº“ä¸­ä¿å­˜æ³¨é‡Šæ‰çš„ä»£ç "><a href="#ä¸è¦åœ¨ä»£ç åº“ä¸­ä¿å­˜æ³¨é‡Šæ‰çš„ä»£ç " class="headerlink" title="ä¸è¦åœ¨ä»£ç åº“ä¸­ä¿å­˜æ³¨é‡Šæ‰çš„ä»£ç "></a>ä¸è¦åœ¨ä»£ç åº“ä¸­ä¿å­˜æ³¨é‡Šæ‰çš„ä»£ç </h3><p>å› ä¸ºæœ‰ç‰ˆæœ¬æ§åˆ¶ï¼Œ æŠŠæ—§çš„ä»£ç ç•™åœ¨å†å²è®°å½•å³å¯ã€‚</p>
<p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">doStuff();</span><br><span class="line">// doOtherStuff();</span><br><span class="line">// doSomeMoreStuff();</span><br><span class="line">// doSoMuchStuff();</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">doStuff();</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h3 id="ä¸è¦æœ‰æ—¥å¿—å¼çš„æ³¨é‡Š"><a href="#ä¸è¦æœ‰æ—¥å¿—å¼çš„æ³¨é‡Š" class="headerlink" title="ä¸è¦æœ‰æ—¥å¿—å¼çš„æ³¨é‡Š"></a>ä¸è¦æœ‰æ—¥å¿—å¼çš„æ³¨é‡Š</h3><p>è®°ä½ï¼Œ ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶ï¼ ä¸éœ€è¦åƒµå°¸ä»£ç ï¼Œ æ³¨é‡Šæ‰çš„ä»£ç ï¼Œ å°¤å…¶æ˜¯æ—¥å¿—å¼çš„æ³¨é‡Šã€‚ ä½¿ç”¨ <code>git log</code> æ¥<br>è·å–å†å²è®°å½•ã€‚</p>
<p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 2016-12-20: Removed monads, didn&apos;t understand them (RM)</span><br><span class="line"> * 2016-10-01: Improved using special monads (JP)</span><br><span class="line"> * 2016-02-03: Removed type-checking (LI)</span><br><span class="line"> * 2015-03-14: Added combine with type-checking (JR)</span><br><span class="line"> */</span><br><span class="line"> </span><br><span class="line">void combine(String a, String b) &#123;</span><br><span class="line">    return a + b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">void combine(String a, String b) &#123;</span><br><span class="line">        return a + b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></p>
<h3 id="é¿å…å ä½ç¬¦"><a href="#é¿å…å ä½ç¬¦" class="headerlink" title="é¿å…å ä½ç¬¦"></a>é¿å…å ä½ç¬¦</h3><p>å®ƒä»¬ä»…ä»…æ·»åŠ äº†å¹²æ‰°ã€‚ è®©å‡½æ•°å’Œå˜é‡åç§°ä¸åˆé€‚çš„ç¼©è¿›å’Œæ ¼å¼åŒ–ä¸ºä½ çš„ä»£ç æä¾›è§†è§‰ç»“æ„ã€‚</p>
<p><strong>ä¸å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">////////////////////////////////////////////////////////////////////////////////</span><br><span class="line">// Scope Model Instantiation</span><br><span class="line">////////////////////////////////////////////////////////////////////////////////</span><br><span class="line">String[] model = &#123;&quot;foo&quot;,&quot;bar&quot;&#125;;</span><br><span class="line"></span><br><span class="line">////////////////////////////////////////////////////////////////////////////////</span><br><span class="line">// Action setup</span><br><span class="line">////////////////////////////////////////////////////////////////////////////////</span><br><span class="line">void action()&#123;</span><br><span class="line">    //...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>å¥½çš„ï¼š</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">String[] model = &#123;&quot;foo&quot;,&quot;bar&quot;&#125;;</span><br><span class="line">      void action()&#123;</span><br><span class="line">          //...</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="â¬†-è¿”å›é¡¶éƒ¨"><a href="#â¬†-è¿”å›é¡¶éƒ¨" class="headerlink" title="â¬† è¿”å›é¡¶éƒ¨"></a><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></h2><h2 id="å·¥å…·"><a href="#å·¥å…·" class="headerlink" title="å·¥å…·"></a><strong>å·¥å…·</strong></h2><h3 id="Lint"><a href="#Lint" class="headerlink" title="Lint"></a><a href="https://developer.android.google.cn/studio/write/lint" target="_blank" rel="noopener">Lint</a></h3><p>Android Studio æä¾›äº†ä¸€ä¸ªåä¸º Lint çš„ä»£ç æ‰«æå·¥å…·ï¼Œå¯å¸®åŠ©æ‚¨å‘ç°å¹¶æ›´æ­£ä»£ç ç»“æ„è´¨é‡çš„é—®é¢˜ï¼Œè€Œæ— éœ€æ‚¨å®é™…æ‰§è¡Œåº”ç”¨ï¼Œä¹Ÿä¸å¿…ç¼–å†™æµ‹è¯•ç”¨ä¾‹ã€‚ç³»ç»Ÿä¼šæŠ¥å‘Šè¯¥å·¥å…·æ£€æµ‹åˆ°çš„æ¯ä¸ªé—®é¢˜å¹¶æä¾›é—®é¢˜çš„æè¿°æ¶ˆæ¯å’Œä¸¥é‡çº§åˆ«ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥å¿«é€Ÿç¡®å®šéœ€è¦ä¼˜å…ˆè¿›è¡Œçš„å…³é”®æ”¹è¿›ã€‚æ­¤å¤–ï¼Œæ‚¨è¿˜å¯ä»¥é™ä½é—®é¢˜çš„ä¸¥é‡çº§åˆ«ä»¥å¿½ç•¥ä¸é¡¹ç›®æ— å…³çš„é—®é¢˜ï¼Œæˆ–è€…æé«˜ä¸¥é‡çº§åˆ«ä»¥çªå‡ºç‰¹å®šé—®é¢˜ã€‚</p>
<p>Lint å·¥å…·å¯ä»¥æ£€æŸ¥æ‚¨çš„ Android é¡¹ç›®æºæ–‡ä»¶æ˜¯å¦æœ‰æ½œåœ¨çš„é”™è¯¯ï¼Œä»¥åŠåœ¨æ­£ç¡®æ€§ã€å®‰å…¨æ€§ã€æ€§èƒ½ã€æ˜“ç”¨æ€§ã€æ— éšœç¢æ€§å’Œå›½é™…åŒ–æ–¹é¢æ˜¯å¦éœ€è¦ä¼˜åŒ–æ”¹è¿›ã€‚</p>
<p><img src="https://user-gold-cdn.xitu.io/2020/3/4/170a34230f1219ec?w=604&amp;h=287&amp;f=png&amp;s=29918" alt></p>
<p>Lintä¸ä»…æ”¯æŒJavaè¯­è¨€ï¼ŒåŒæ˜¯æ”¯æŒKotlinã€C/C++ç­‰çš„è§„èŒƒæ€§æ£€æŸ¥ï¼ŒAndroidå®˜æ–¹æ¨èçš„ä»£ç æ‰«æå·¥å…·ã€‚</p>
<h3 id="CheckStyle"><a href="#CheckStyle" class="headerlink" title="CheckStyle"></a><a href="https://checkstyle.org/" target="_blank" rel="noopener">CheckStyle</a></h3><p>CheckStyleä½œä¸ºæ£€éªŒä»£ç è§„èŒƒçš„æ’ä»¶ï¼Œé™¤äº†å¯ä»¥ä½¿ç”¨é…ç½®é»˜è®¤ç»™å®šçš„å¼€å‘è§„èŒƒï¼Œå¦‚Sunçš„ï¼ŒGoogleçš„å¼€å‘è§„èŒƒå•Šï¼Œä¹Ÿå¯ä»¥å¯¼å…¥åƒé˜¿é‡Œçš„å¼€å‘è§„èŒƒçš„æ’ä»¶ã€‚äº‹å®ä¸Šï¼Œæ¯ä¸€ä¸ªå…¬å¸éƒ½å­˜åœ¨ä¸åŒçš„å¼€å‘è§„èŒƒè¦æ±‚ï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†å…¬å¸ä¼šç»™å®šè‡ªå·±çš„checkè§„èŒƒï¼Œä¸€èˆ¬å¯¼å…¥ç»™å®šçš„checkstyle.xmlæ–‡ä»¶å³å¯å®ç°ã€‚CheckStyleæ¥è¾…åŠ©åˆ¤æ–­ä»£ç æ ¼å¼æ˜¯å¦æ»¡è¶³è§„èŒƒï¼Œä¿è¯å›¢é˜Ÿæˆå‘˜å¼€å‘çš„codeé£æ ¼ä¸€è‡´ã€‚</p>
<p>CheckStyleæ£€éªŒçš„ä¸»è¦å†…å®¹</p>
<ul>
<li>Javadocæ³¨é‡Š</li>
<li>å‘½åçº¦å®š</li>
<li>æ ‡é¢˜</li>
<li>Importè¯­å¥</li>
<li>ä½“ç§¯å¤§å°</li>
<li>ç©ºç™½</li>
<li>ä¿®é¥°ç¬¦</li>
<li>å—</li>
<li>ä»£ç é—®é¢˜</li>
<li>ç±»è®¾è®¡</li>
<li>æ··åˆæ£€æŸ¥ï¼ˆåŒ…æ‹¬ä¸€äº›æœ‰ç”¨çš„æ¯”å¦‚éå¿…é¡»çš„System.outå’ŒprintstackTraceï¼‰</li>
</ul>
<p>ä»ä¸Šé¢å¯ä»¥çœ‹å‡ºï¼ŒCheckStyleæä¾›äº†å¤§éƒ¨åˆ†åŠŸèƒ½éƒ½æ˜¯å¯¹äºä»£ç è§„èŒƒçš„æ£€æŸ¥ã€‚ä½†CheckStyleç›®å‰åªæ”¯æŒæ£€æŸ¥Javaè¯­è¨€ã€‚</p>
<p><img src="https://user-gold-cdn.xitu.io/2020/3/4/170a3a215261376c?w=1510&amp;h=778&amp;f=png&amp;s=223360" alt></p>
<h3 id="SonarLint"><a href="#SonarLint" class="headerlink" title="SonarLint"></a><a href="https://www.sonarlint.org/" target="_blank" rel="noopener">SonarLint</a></h3><p>SonarLintæ˜¯ä¸€ä¸ªIDEæ‰©å±•ï¼Œå¯å¸®åŠ©æ‚¨åœ¨ç¼–å†™ä»£ç æ—¶æ£€æµ‹å’Œä¿®å¤è´¨é‡é—®é¢˜ï¼Œåœ¨æäº¤ä»£ç ä¹‹å‰è¿›è¡Œä¿®å¤ã€‚</p>
<ul>
<li>é”™è¯¯æ£€æµ‹</li>
</ul>
<p>å—ç›Šäºå·²æœ‰çš„æ•°åƒæ¡è§„åˆ™ ; å¯ä»¥æ£€æµ‹å¸¸è§é”™è¯¯ï¼Œæ£˜æ‰‹é”™è¯¯å’Œå·²çŸ¥æ¼æ´</p>
<ul>
<li>å³æ—¶åé¦ˆ</li>
</ul>
<p>å°±åƒæ‹¼å†™æ£€æŸ¥å™¨ä¸€æ ·ï¼Œåœ¨ç¼–ç æ—¶ä¼šæ£€æµ‹åˆ°å¹¶æŠ¥å‘Šé—®é¢˜</p>
<ul>
<li>ä¸°å¯Œçš„æ–‡æ¡£</li>
</ul>
<p>ç²¾ç¡®åœ°æŒ‡å‡ºäº†é—®é¢˜æ‰€åœ¨ï¼Œå¹¶ä¸ºæ‚¨æä¾›äº†è§£å†³æ–¹æ³•çš„å»ºè®®</p>
<p><img src="https://user-gold-cdn.xitu.io/2020/3/4/170a47f863d2a8ef?w=2746&amp;h=1306&amp;f=png&amp;s=389802" alt></p>
<h3 id="Alibaba-Java-Coding-Guidelines"><a href="#Alibaba-Java-Coding-Guidelines" class="headerlink" title="Alibaba Java Coding Guidelines"></a><a href="https://github.com/alibaba/p3c" target="_blank" rel="noopener">Alibaba Java Coding Guidelines</a></h3><p>é˜¿é‡Œå·´å·´äº10æœˆ14å·åœ¨æ­å·äº‘æ –å¤§ä¼šä¸Šï¼Œæ­£å¼å‘å¸ƒã€Šé˜¿é‡Œå·´å·´Javaå¼€å‘è§„çº¦ã€‹çš„æ‰«ææ’ä»¶ã€‚è¯¥æ’ä»¶åœ¨æ‰«æä»£ç åï¼Œå°†ä¸ç¬¦åˆè§„çº¦çš„ä»£ç æŒ‰Blocker/Critical/Majorä¸‰ä¸ªç­‰çº§æ˜¾ç¤ºåœ¨ä¸‹æ–¹ï¼Œç”šè‡³åœ¨IDEAä¸Šï¼Œè¯¥æ’ä»¶è¿˜åŸºäºInspectionæœºåˆ¶æä¾›äº†å®æ—¶æ£€æµ‹åŠŸèƒ½ï¼Œç¼–å†™ä»£ç çš„åŒæ—¶ä¹Ÿèƒ½å¿«é€Ÿå‘ç°é—®é¢˜æ‰€åœ¨ã€‚å¯¹äºå†å²ä»£ç ï¼Œéƒ¨åˆ†è§„åˆ™å®ç°äº†æ‰¹é‡ä¸€é”®ä¿®å¤çš„åŠŸèƒ½ã€‚</p>
<ul>
<li>Blocker</li>
</ul>
<p>å³ç³»ç»Ÿæ— æ³•æ‰§è¡Œã€å´©æºƒæˆ–ä¸¥é‡èµ„æºä¸è¶³ã€åº”ç”¨æ¨¡å—æ— æ³•å¯åŠ¨æˆ–å¼‚å¸¸é€€å‡ºã€æ— æ³•æµ‹è¯•ã€é€ æˆç³»ç»Ÿä¸ç¨³å®šã€‚<br>ä¸¥é‡èŠ±å±ã€å†…å­˜æ³„æ¼ã€ç”¨æˆ·æ•°æ®ä¸¢å¤±æˆ–ç ´åã€ç³»ç»Ÿå´©æºƒ/æ­»æœº/å†»ç»“ã€æ¨¡å—æ— æ³•å¯åŠ¨æˆ–å¼‚å¸¸é€€å‡ºã€ä¸¥é‡çš„æ•°å€¼è®¡ç®—é”™è¯¯ã€åŠŸèƒ½è®¾è®¡ä¸éœ€æ±‚ä¸¥é‡ä¸ç¬¦ã€å…¶å®ƒå¯¼è‡´æ— æ³•æµ‹è¯•çš„é”™è¯¯, å¦‚æœåŠ¡å™¨500é”™è¯¯</p>
<ul>
<li>Critical</li>
</ul>
<p>å³å½±å“ç³»ç»ŸåŠŸèƒ½æˆ–æ“ä½œï¼Œä¸»è¦åŠŸèƒ½å­˜åœ¨ä¸¥é‡ç¼ºé™·ï¼Œä½†ä¸ä¼šå½±å“åˆ°ç³»ç»Ÿç¨³å®šæ€§ã€‚<br>åŠŸèƒ½æœªå®ç°ã€åŠŸèƒ½é”™è¯¯ã€ç³»ç»Ÿåˆ·æ–°é”™è¯¯ã€æ•°æ®é€šè®¯é”™è¯¯ã€è½»å¾®çš„æ•°å€¼è®¡ç®—é”™è¯¯ã€å½±å“åŠŸèƒ½åŠç•Œé¢çš„é”™è¯¯å­—æˆ–æ‹¼å†™é”™è¯¯ã€å®‰å…¨æ€§é—®é¢˜</p>
<ul>
<li>Major</li>
</ul>
<p>å³ç•Œé¢ã€æ€§èƒ½ç¼ºé™·ã€å…¼å®¹æ€§ã€‚æ“ä½œç•Œé¢é”™è¯¯ï¼ˆåŒ…æ‹¬æ•°æ®çª—å£å†…åˆ—åå®šä¹‰ã€å«ä¹‰æ˜¯å¦ä¸€è‡´ï¼‰ã€è¾¹ç•Œæ¡ä»¶ä¸‹é”™è¯¯ã€æç¤ºä¿¡æ¯é”™è¯¯ï¼ˆåŒ…æ‹¬æœªç»™å‡ºä¿¡æ¯ã€ä¿¡æ¯æç¤ºé”™è¯¯ç­‰ï¼‰ã€é•¿æ—¶é—´æ“ä½œæ— è¿›åº¦æç¤ºã€ç³»ç»Ÿæœªä¼˜åŒ–ï¼ˆæ€§èƒ½é—®é¢˜ï¼‰ã€å…‰æ ‡è·³è½¬è®¾ç½®ä¸å¥½ï¼Œé¼ æ ‡ï¼ˆå…‰æ ‡ï¼‰å®šä½é”™è¯¯ã€å…¼å®¹æ€§é—®é¢˜</p>
<p><img src="https://user-gold-cdn.xitu.io/2020/3/4/170a39d986563f1b?w=635&amp;h=308&amp;f=png&amp;s=13685" alt></p>
<p><strong>ä¸åŒçš„ä»£ç æ£€æŸ¥å·¥å…·åŸç†ç›¸åŒï¼Œä½†ä¾§é‡ç‚¹ä¸ä¸€æ ·ï¼Œåœ¨å®é™…çš„é¡¹ç›®å¼€å‘ä¸­ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„å›¢é˜ŸåŠé¡¹ç›®æƒ…å†µè¿›è¡Œé€‰æ‹©åŠç»„åˆï¼Œå®šä¹‰è‡ªå·±çš„å›¢é˜Ÿè§„èŒƒã€‚</strong></p>
<h2 id="â¬†-è¿”å›é¡¶éƒ¨-1"><a href="#â¬†-è¿”å›é¡¶éƒ¨-1" class="headerlink" title="â¬† è¿”å›é¡¶éƒ¨"></a><strong><a href="#ä»£ç æ•´æ´çš„-Java">â¬† è¿”å›é¡¶éƒ¨</a></strong></h2><h1 id="è°œé¢˜"><a href="#è°œé¢˜" class="headerlink" title="è°œé¢˜"></a>è°œé¢˜</h1><p>ç¨‹åºå‘˜åœ¨èƒŒè´ŸæœŸé™çš„å‹åŠ›ä¸‹ï¼Œåªå¥½è¿½æ±‚å¿«é€Ÿçš„å¼€å‘é€Ÿåº¦ï¼Œäºæ˜¯ä¸ºä»£ç åˆ¶é€ äº†æ·· ä¹±ï¼Œå´è®¤ä¸ºè‡ªå·±å› æ­¤æ²¡æ³•åšåˆ°æ›´å¿«ã€‚</p>
<p>åˆ¶é€ æ··ä¹±åªä¼šç«‹åˆ»æ‹–æ…¢ä½ ï¼Œå«ä½ é”™è¿‡æœŸé™ã€‚èµ¶ä¸ŠæœŸé™çš„å”¯ä¸€æ–¹æ³•ã€åšå¾—å¿«çš„å”¯ä¸€æ–¹æ³•å°±æ˜¯å§‹ç»ˆå°½å¯èƒ½ä¿æŒä»£ç æ•´æ´ã€‚</p>
<h2 id="å…³äº"><a href="#å…³äº" class="headerlink" title="å…³äº"></a>å…³äº</h2><p><strong>æ¬¢è¿å…³æ³¨æˆ‘çš„ä¸ªäººå…¬ä¼—å·</strong></p>
<p>å¾®ä¿¡æœç´¢ï¼š<strong>ä¸€ç ä¸€æµ®ç”Ÿ</strong>ï¼Œæˆ–è€…æœç´¢å…¬ä¼—å·ID:<strong>life2code</strong></p>
<p><img src="https://user-gold-cdn.xitu.io/2020/3/16/170e0c3c64a3f0ff?w=1066&amp;h=386&amp;f=png&amp;s=117806" alt></p>
<ul>
<li>ä½œè€…ï¼šé»„ä¿Šå½¬ </li>
<li><a href="https://junbin.tech/" target="_blank" rel="noopener">åšå®¢ï¼šjunbin.tech</a></li>
<li><a href="https://github.com/junbin1011" target="_blank" rel="noopener">GitHub: junbin1011 </a></li>
<li><a href="https://www.zhihu.com/people/junbin-9-77" target="_blank" rel="noopener">çŸ¥ä¹: @JunBin</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://junbin1011.github.io/2020/02/23/å¦‚ä½•å¿«é€Ÿä¸ºä½ çš„Githubé¡¹ç›®æ­å»ºCICD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="é»„ä¿Šå½¬">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://note.youdao.com/yws/api/personal/file/WEB917b08143504a6f8c96228312fcb5245?method=download&shareKey=03cb5c302c83b56bbb91668c5008444f">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JunBin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/02/23/å¦‚ä½•å¿«é€Ÿä¸ºä½ çš„Githubé¡¹ç›®æ­å»ºCICD/" itemprop="url">
                  å¦‚ä½•å¿«é€Ÿä¸ºä½ çš„Githubé¡¹ç›®æ­å»ºCICD
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2020-02-23T11:55:56+08:00">
                2020-02-23
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/02/23/å¦‚ä½•å¿«é€Ÿä¸ºä½ çš„Githubé¡¹ç›®æ­å»ºCICD/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2020/02/23/å¦‚ä½•å¿«é€Ÿä¸ºä½ çš„Githubé¡¹ç›®æ­å»ºCICD/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>ä½œä¸ºä¸€ä¸ªç¨‹åºå‘˜ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šåœ¨Githubä¸Šå¼€æºè‡ªå·±çš„é¡¹ç›®ï¼Œæœ¬æ–‡å°†ä»‹ç»å¦‚ä½•é€šè¿‡Travis CIè¿›è¡ŒæŒç»­é›†æˆï¼Œå¹¶é€šè¿‡è’²å…¬è‹±è¿›è¡Œé¡¹ç›®çš„éƒ¨ç½²ã€‚ä»‹ç»å¦‚ä½•ç®€å•å¿«é€Ÿçš„ä¸ºä½ çš„Githubé¡¹ç›®æ·»åŠ CICDï¼Œæé«˜é¡¹ç›®çš„æ„å»ºã€è´¨é‡åŠæµ‹è¯•çš„æ•ˆç‡ã€‚</p>
<p>æœ¬æ–‡å°†é€šè¿‡ä¸€ä¸ªAndroidé¡¹ç›®è¿›è¡Œç¤ºä¾‹è¯´æ˜ã€‚å…·ä½“ä¸åŒçš„å¹³å°çš„å‘½ä»¤é…ç½®ä¸ä¸€æ ·ï¼Œä½†æ•´ä½“çš„æµç¨‹ä¸€è‡´ã€‚</p>
<h1 id="é›†æˆ"><a href="#é›†æˆ" class="headerlink" title="é›†æˆ"></a>é›†æˆ</h1><h2 id="è´¦å·"><a href="#è´¦å·" class="headerlink" title="è´¦å·"></a>è´¦å·</h2><h3 id="Travis-CI"><a href="#Travis-CI" class="headerlink" title="Travis CI"></a>Travis CI</h3><p><a href="https://travis-ci.org/" target="_blank" rel="noopener">Travis CI</a> æ˜¯ç›®å‰æ¯”è¾ƒæµè¡Œçš„æŒç»­é›†æˆå·¥å…·ä¹‹ä¸€ï¼Œç”¨æ¥æ„å»ºåŠæµ‹è¯•åœ¨ Github æ‰˜ç®¡çš„ä»£ç ï¼Œä½¿ç”¨å®ƒå¯ä»¥æå¤§çš„ç®€åŒ–å·¥ä½œæµç¨‹ã€‚</p>
<h3 id="è’²å…¬è‹±"><a href="#è’²å…¬è‹±" class="headerlink" title="è’²å…¬è‹±"></a>è’²å…¬è‹±</h3><p><a href="https://www.pgyer.com/" target="_blank" rel="noopener">è’²å…¬è‹±</a>æä¾›ä¸“ä¸šçš„æ‰‹æœºåº”ç”¨å†…æµ‹æœåŠ¡ï¼Œæ‚¨åªéœ€å°†éœ€è¦å†…æµ‹çš„åº”ç”¨ä¸Šä¼ è‡³è’²å…¬è‹±ï¼Œç”ŸæˆäºŒç»´ç ï¼Œå†…æµ‹ç”¨æˆ·é€šè¿‡åœ¨æ‰‹æœºä¸Šæ‰«æäºŒç»´ç ï¼Œå³å¯å°†å†…æµ‹åº”ç”¨å®‰è£…è‡³æ‰‹æœºç­‰è®¾å¤‡ä¸­è¿›è¡Œæµ‹è¯•</p>
<h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><ol>
<li>æˆæƒåŠå¼€å¯æƒé™</li>
</ol>
<p>é€šè¿‡Githubè´¦å·æˆæƒTravisè¿›è¡Œç™»å½•ã€‚åœ¨Travisçš„<a href="https://travis-ci.org/account/repositories" target="_blank" rel="noopener">Settings</a>ä¸­å¼€å¯repositoriesçš„æˆæƒå¼€å…³</p>
<ol start="2">
<li>åœ¨å·¥ç¨‹æ ¹ç›®å½•ä¸‹æ·»åŠ  .travis.ymlæ–‡ä»¶</li>
</ol>
<p>Travis-CI æœ¬èº«æä¾›åŸºæœ¬çš„æ„å»ºå’Œæ”¯æŒè¯­è¨€ï¼ŒåŒæ—¶å¼€å‘è€…å¯ä»¥é€šè¿‡.travis.ymlæ–‡ä»¶è®¾ç½®è‡ªå·±çš„æ„å»ºæ“ä½œï¼ŒåŒæ—¶éœ€è¦éµä» Travis-CI è‡ªå·±è§„å®šçš„æ„å»ºç”Ÿå‘½å‘¨æœŸã€‚å…·ä½“å¯å‚<a href="https://docs.travis-ci.com/user/customizing-the-build/" target="_blank" rel="noopener">Traviså®˜ç½‘ä»‹ç»</a>ã€‚</p>
<p>3.è·å–è’²å…¬è‹±çš„tokenç”¨äºå‘å¸ƒé¡¹ç›®</p>
<p>è’²å…¬è‹±çš„ API_KEY å¯ä»¥é€šè¿‡è¿™é‡ŒæŸ¥çœ‹:<a href="https://www.pgyer.com/account/api" target="_blank" rel="noopener">https://www.pgyer.com/account/api</a></p>
<p>4.é…ç½®åŸºç¡€çš„æ¨¡æ¿<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">language: android        #è¯­è¨€è¯´æ˜</span><br><span class="line">dist: trusty</span><br><span class="line">jdk: oraclejdk8          #jdkç‰ˆæœ¬</span><br><span class="line">sudo: required           #æƒé™è¦æ±‚</span><br><span class="line">env:                 #ç¯å¢ƒå˜é‡</span><br><span class="line">global:</span><br><span class="line">  - ANDROID_BUILD_TOOLS=29.0.1</span><br><span class="line">  - ADB_INSTALL_TIMEOUT=5 # minutes</span><br><span class="line">android:             #Android ç¯å¢ƒè¦æ±‚</span><br><span class="line">components:</span><br><span class="line">  - tools</span><br><span class="line">  - platform-tools</span><br><span class="line">  - build-tools-$ANDROID_BUILD_TOOLS</span><br><span class="line">  - android-29</span><br><span class="line">  - android-21</span><br><span class="line">  - extra-google-m2repository</span><br><span class="line">  - extra-android-m2repository        # é…ç½®design åº“</span><br><span class="line">  - extra-android-support</span><br><span class="line">  - extra-google-google_play_services</span><br><span class="line">  - addon-google_apis-google-19       # é…ç½®google play services</span><br><span class="line">  - sys-img-armeabi-v7a-android-29</span><br><span class="line">  - sys-img-armeabi-v7a-android-21</span><br><span class="line">licenses:               #å†…å®¹è®¸å¯æ·»åŠ </span><br><span class="line">  - android-sdk-preview-license-.+</span><br><span class="line">  - android-sdk-license-.+</span><br><span class="line">  - google-gdk-license-.+</span><br></pre></td></tr></table></figure></p>
<p>5.æ‰§è¡Œå¯¹åº”çš„ä»£ç æ£€æŸ¥ã€å•å…ƒæµ‹è¯•ã€çœŸæœºæµ‹è¯•<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">before_script:</span><br><span class="line">  ##æ‰§è¡Œä»£ç è§„èŒƒæ‰«æ</span><br><span class="line">  - ./gradlew apm:lint</span><br><span class="line">    ##æ‰§è¡ŒDemoæµ‹è¯•è„šæœ¬</span><br><span class="line">  - ./gradlew apm:test</span><br><span class="line">  #æ‰§è¡Œæµ‹è¯•demoçš„æµ‹è¯•</span><br><span class="line">  ##æ‰§è¡Œä»£ç è§„èŒƒæ‰«æ</span><br><span class="line">  - ./gradlew lint</span><br><span class="line">  ##æ‰§è¡ŒDemoæµ‹è¯•è„šæœ¬</span><br><span class="line">  - ./gradlew test</span><br><span class="line">  - ./gradlew connectedAndroidTest</span><br></pre></td></tr></table></figure></p>
<p>6.æ„å»ºå‘å¸ƒ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">script:</span><br><span class="line">  #æ„å»ºç‰ˆæœ¬</span><br><span class="line">  - ./gradlew assembleRelease</span><br><span class="line">after_script:</span><br><span class="line">  #å‘å¸ƒè’²å…¬è‹±</span><br><span class="line">  - set -e</span><br><span class="line">  - $TRAVIS_BUILD_DIR/pgyer_upload.sh &quot;$&#123;TRAVIS_BUILD_DIR&#125;/app/build/outputs/apk/release/app-release-unsigned.apk&quot; 1ffafb3680dc6131e41428163082c76a</span><br></pre></td></tr></table></figure>
<h2 id="å¡«å‘"><a href="#å¡«å‘" class="headerlink" title="å¡«å‘"></a>å¡«å‘</h2><p>1.æ¨¡æ‹Ÿå™¨å¯åŠ¨å¤±è´¥ï¼ˆError:Target id is not vaild.Use â€˜android list targetsâ€™ to get the target idsï¼‰</p>
<p>è§„å®šçš„æ¨¡æ‹Ÿå™¨ android ç‰ˆæœ¬éœ€è¦åœ¨ .travis.yml android éƒ¨åˆ†å£°æ˜åˆ°ç›¸å…³çš„ç‰ˆæœ¬,å¹¶ä¸”éœ€è¦æ·»åŠ å¯¹åº”çš„é…ç½®ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">before_install:</span><br><span class="line">  - yes | sdkmanager &quot;platforms;android-29&quot;</span><br><span class="line">  - yes | sdkmanager &quot;platforms;android-21&quot;</span><br><span class="line">  - echo yes | android update sdk --all --filter sys-img-armeabi-v7a-android-21 --no-ui --force &gt; /dev/null</span><br></pre></td></tr></table></figure></p>
<p>2.NDKæ”¯æŒ</p>
<p>å¦‚æœé¡¹ç›®ä¸­ä½¿ç”¨cmakeï¼Œéœ€è¦æ·»åŠ å¯¹åº”çš„å‚æ•°é…ç½®ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">before_install:</span><br><span class="line">  - echo y | sdkmanager &quot;ndk-bundle&quot;</span><br><span class="line">  - echo y | sdkmanager &quot;ndk;20.1.5948944&quot;</span><br><span class="line">  - echo y | sdkmanager &quot;cmake;3.10.2.4988404&quot;</span><br><span class="line">before_script:</span><br><span class="line">  - export ANDROID_NDK_ROOT=$ANDROID_HOME/ndk-bundle</span><br><span class="line">  - export ANDROID_NDK_HOME=$ANDROID_NDK_ROOT</span><br></pre></td></tr></table></figure>
<h2 id="å…³äº"><a href="#å…³äº" class="headerlink" title="å…³äº"></a>å…³äº</h2><p><strong>æ¬¢è¿å…³æ³¨æˆ‘çš„ä¸ªäººå…¬ä¼—å·</strong></p>
<p>å¾®ä¿¡æœç´¢ï¼š<strong>ä¸€ç ä¸€æµ®ç”Ÿ</strong>ï¼Œæˆ–è€…æœç´¢å…¬ä¼—å·ID:<strong>life2code</strong></p>
<p><img src="https://note.youdao.com/yws/api/personal/file/WEBa96dfd23abb87ebdf59dd39d5081a7be?method=download&amp;shareKey=09bc64e9133e43f61c1651a59c9c92d7" alt></p>
<ul>
<li>ä½œè€…ï¼šé»„ä¿Šå½¬ </li>
<li><a href="https://junbin.tech/" target="_blank" rel="noopener">åšå®¢ï¼šjunbin.tech</a></li>
<li><a href="https://github.com/junbin1011" target="_blank" rel="noopener">GitHub: junbin1011 </a></li>
<li><a href="https://www.zhihu.com/people/junbin-9-77" target="_blank" rel="noopener">çŸ¥ä¹: @JunBin</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://junbin1011.github.io/2019/04/24/å¦‚ä½•é«˜æ•ˆå®Œæˆé¡¹ç›®äº¤ä»˜/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="é»„ä¿Šå½¬">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://note.youdao.com/yws/api/personal/file/WEB917b08143504a6f8c96228312fcb5245?method=download&shareKey=03cb5c302c83b56bbb91668c5008444f">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JunBin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/04/24/å¦‚ä½•é«˜æ•ˆå®Œæˆé¡¹ç›®äº¤ä»˜/" itemprop="url">
                  å¦‚ä½•é«˜æ•ˆå®Œæˆé¡¹ç›®äº¤ä»˜
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-04-24T21:54:44+08:00">
                2019-04-24
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/04/24/å¦‚ä½•é«˜æ•ˆå®Œæˆé¡¹ç›®äº¤ä»˜/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2019/04/24/å¦‚ä½•é«˜æ•ˆå®Œæˆé¡¹ç›®äº¤ä»˜/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ€è¿‘996å¾ˆç«ï¼Œä½†æŠ›å¼€ä¼ä¸šçš„å¼ºåˆ¶æ€§æ–‡åŒ–å¤–ï¼Œæ˜¯å¦è¿˜æœ‰å…¶ä»–çš„å„ç§å› ç´ å¯¼è‡´æˆ‘ä»¬æ•ˆç‡ä½ä¸‹ã€‚æˆ‘ä»¬èƒ½å¦‚ä½•å»æé«˜ç¼–ç¨‹çš„æ•ˆç‡ï¼Œå¦‚ä½•æœ‰æ•ˆå»è§„é¿é¡¹ç›®ä¸­çš„é£é™©ï¼Œä½¿å¾—é¡¹ç›®çš„è¿­ä»£è®¡åˆ’èƒ½æ­£å¸¸çš„æ‰§è¡Œï¼Œé¡¹ç›®èƒ½æŒ‰æœŸäº¤ä»˜ã€‚</p>
<p>ä¸‹é¢å…ˆè°ˆè°ˆå‡ ä¸ªå…³äºé¡¹ç›®äº¤ä»˜çš„é—®é¢˜ã€‚</p>
<p>1ã€å¦‚ä½•é‡åŒ–è¯„åˆ¤ç¼–ç¨‹æ˜¯å¦é«˜æ•ˆï¼Ÿ</p>
<p>2ã€åœ¨é¡¹ç›®å¼€å±•è¿‡ç¨‹ä¸­ï¼Œæ˜¯å¦é‡åˆ°éæŠ€æœ¯æˆ–è‡ªèº«çš„åŸå› ï¼Œå¯¼è‡´æ•ˆç‡ä½ä¸‹ï¼Ÿ</p>
<p>3ã€æ˜¯å¦æ›¾ç»å› ä¸ºè‡ªèº«çš„åŸå› å¯¼è‡´é¡¹ç›®æ‹–å»¶ï¼Œä½ å°†ä¼šæ€ä¹ˆæ ·è¿›è¡Œè°ƒæ•´ï¼Ÿ</p>
<p>4ã€ä½ æœ‰ä»€ä¹ˆé¡¹ç›®ä¸­çš„å®è·µç»éªŒï¼Œä½¿å¾—æ•ˆç‡æ›´é«˜å‘¢ï¼Ÿ</p>
<p>ä¸‹é¢å°†è°ˆè°ˆè‡ªå·±çš„ä¸€äº›ç»éªŒåŠæ€»ç»“ã€‚æ¬¢è¿å¤§å®¶æœ‰å…´è¶£ä¸€èµ·æ¢è®¨ã€‚</p>
<h1 id="é—®é¢˜åˆ†æ"><a href="#é—®é¢˜åˆ†æ" class="headerlink" title="é—®é¢˜åˆ†æ"></a>é—®é¢˜åˆ†æ</h1><p><img src="http://upload-images.jianshu.io/upload_images/5125122-f19017f2b632a952?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<h2 id="1ã€è¯„åˆ¤æ ‡å‡†"><a href="#1ã€è¯„åˆ¤æ ‡å‡†" class="headerlink" title="1ã€è¯„åˆ¤æ ‡å‡†"></a>1ã€è¯„åˆ¤æ ‡å‡†</h2><p>ä¸ºä»€ä¹ˆé¦–å…ˆè°ˆè¯„åˆ¤æ ‡å‡†ï¼Œæ˜¯å› ä¸ºè¿™ä¸ªæ˜¯è¡¡é‡çš„åŸºå‡†ã€‚å¦‚ä½•å»è¡¡é‡ç¼–ç¨‹å·¥ä½œæ˜¯å¦é«˜æ•ˆï¼Œç›¸ä¿¡ä¸åŒçš„å…¬å¸æœ‰ä¸åŒçš„æ–¹æ³•ï¼Œä½†é€šå¸¸éƒ½æ²¡æœ‰åŠæ³•è¾¾åˆ°å¯é‡åŒ–ã€‚å¾€å¾€æ˜¯é€šè¿‡ä¸ªäººçš„ç»éªŒè¯„åˆ¤ï¼Œæˆ–è€…æ˜¯æ¨ªå‘çš„å¯¹æ¯”ï¼Œä»è€Œå»è¿›è¡Œä¸€ä¸ªè¯„å®šã€‚</p>
<p>å½“ç„¶å¦‚æœå…¬å¸æœ‰å®Œå–„çš„è€ƒæ ¸æ ‡å‡†æ˜¯æœ€å¥½ä¸è¿‡ã€‚ä½†æ˜¯åœ¨æ²¡æœ‰çš„æƒ…å†µä¸‹ï¼Œé€šå¸¸é¡¹ç›®éƒ½ä¼šæœ‰ä¸€ä¸ªå¤§çš„æ—¶é—´èŒƒå›´åŠèŠ‚ç‚¹ã€‚æˆ‘ä»¬éœ€è¦ä¿éšœè‡ªå·±çš„å·¥ä½œä¸ä¼šå½±å“åˆ°æ•´ä½“çš„é¡¹ç›®è¿›åº¦ã€‚</p>
<h2 id="2ã€å¤–éƒ¨å› ç´ "><a href="#2ã€å¤–éƒ¨å› ç´ " class="headerlink" title="2ã€å¤–éƒ¨å› ç´ "></a>2ã€å¤–éƒ¨å› ç´ </h2><p>ç›¸ä¿¡å¾ˆå¤šåšæŠ€æœ¯çš„åŒå­¦é€šå¸¸æŠ±æ€¨éƒ½æ˜¯æŠ€æœ¯å¤–çš„å› ç´ å¯¼è‡´é¡¹ç›®ä¸èƒ½å¦‚æœŸè¿›è¡Œã€‚ä¾‹å¦‚éœ€æ±‚å˜æ›´ï¼ˆé€šå¸¸è¿˜ä¸ä¼šç»™åŠ æ—¶é—´ï¼‰ã€æ²Ÿé€šå±‚çº§å¤æ‚ã€é¡¹ç›®éœ€æ±‚ä¼°ç‚¹ä¸æŒ‰å¸¸ç†å‡ºç‰Œç­‰ç­‰ã€‚å„ç§å„æ ·çš„å¤–éƒ¨å› ç´ ï¼Œæœ€ç»ˆå¯¼è‡´é¡¹ç›®ä¸èƒ½å¦‚æœŸæ­£å¸¸äº¤ä»˜ï¼Œä½†æœ€åå¾€å¾€éƒ½æ˜¯ç ”å‘çš„åŒå­¦è¦èƒŒé”…ã€‚æ€»ç»“ä¸€ä¸‹ï¼Œé€šå¸¸æœ‰å¦‚ä¸‹å‡ ç§æƒ…å†µï¼š</p>
<p>1ã€éœ€æ±‚é—®é¢˜ ï¼ˆæ— è¾¹é™…ã€é¢‘ç¹å˜æ›´ï¼‰</p>
<p>2ã€æ²Ÿé€šé—®é¢˜ï¼ˆæ²¡æœ‰ç»Ÿä¸€é«˜æ•ˆçš„æ²Ÿé€šæ¸ é“ï¼‰</p>
<p>3ã€ç®¡ç†é—®é¢˜ ï¼ˆæ²¡æœ‰è§„èŒƒçš„æµç¨‹ï¼Œæ˜ç¡®çš„åˆ†å·¥ï¼Œè¯¦ç»†çš„è¿­ä»£è®¡åˆ’ï¼‰</p>
<h2 id="3ã€è‡ªèº«å› ç´ "><a href="#3ã€è‡ªèº«å› ç´ " class="headerlink" title="3ã€è‡ªèº«å› ç´ "></a>3ã€è‡ªèº«å› ç´ </h2><p>ç”±äºè‡ªèº«çš„å› ç´ å¯¼è‡´é¡¹ç›®å»¶æœŸä¹Ÿéå¸¸å¸¸è§ã€‚å¯¹äºä¸šåŠ¡éœ€æ±‚æ²¡æœ‰æ·±åˆ»çš„ç†è§£å¯¼è‡´è¿”å·¥ã€ç¼ºä¹ä¸»åŠ¨çš„æ²Ÿé€šã€æ•´ä½“çš„æ—¶é—´è§„åˆ’ã€è‰¯å¥½çš„ç¼–ç è§„èŒƒï¼ˆåæœŸfixé—®é¢˜å ç”¨éœ€æ±‚å¼€å‘æ—¶é—´ï¼‰ç­‰ç­‰ã€‚éƒ½ä¼šæ˜¯å¯¼è‡´æ•ˆç‡ä½ä¸‹ã€é¡¹ç›®å»¶æœŸäº¤ä»˜çš„è¯±å› ã€‚æ€»ç»“ä¸€ä¸‹ï¼Œé€šå¸¸æœ‰å¦‚ä¸‹å‡ ç§æƒ…å†µï¼š</p>
<p>1ã€ç¼ºä¹å…¨å±€æ€ç»´ï¼Œè€ƒè™‘é—®é¢˜ä¸å¤Ÿå…¨é¢ï¼Œä¸èƒ½é¢„æœŸé£é™©</p>
<p>2ã€ç¼ºä¹ç§¯æä¸»åŠ¨çš„æ²Ÿé€šï¼ŒåŸ‹å¤´è‹¦å¹²</p>
<p>3ã€ç¼ºä¹è‰¯å¥½çš„æ—¶é—´è§„åˆ’åŠè‡ªæˆ‘ç®¡ç†èƒ½åŠ›</p>
<p>4ã€ç¼ºä¹è‰¯å¥½çš„ç¼–ç è§„èŒƒåŠæ¶æ„è®¾è®¡ã€ç»„ä»¶è®¾è®¡èƒ½åŠ›</p>
<h1 id="ç»éªŒæ€»ç»“"><a href="#ç»éªŒæ€»ç»“" class="headerlink" title="ç»éªŒæ€»ç»“"></a>ç»éªŒæ€»ç»“</h1><p><img src="http://upload-images.jianshu.io/upload_images/5125122-c16a6f03503b2c9b?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<h2 id="æ—¶é—´è§„åˆ’"><a href="#æ—¶é—´è§„åˆ’" class="headerlink" title="æ—¶é—´è§„åˆ’"></a>æ—¶é—´è§„åˆ’</h2><p>1ã€å·¥ä½œçš„8å°æ—¶ä¸­ä¿æŒä¸“æ³¨</p>
<p>ä¿æŒå·¥ä½œæ—¶é—´çš„ä¸“æ³¨ï¼Œè¿™æ˜¯åŸºç¡€ï¼Œä½†å¾€å¾€åˆå¾ˆéš¾ã€‚ç‰¹åˆ«æ˜¯å„ç§ä¼šè®®ã€é‚®ä»¶ã€èŠå¤©è½¯ä»¶æ¶ˆæ¯ï¼Œå¾€å¾€ä¼šæ‰“æ–­ä½ ã€‚æˆ‘ä»¬éœ€è¦å°½é‡æ§åˆ¶è‡ªå·±ä¸“æ³¨ï¼Œå‡å°‘å¤–éƒ¨å› ç´ çš„å¹²æ‰°ã€‚</p>
<p>2ã€å……åˆ†ç†è§£é¡¹ç›®éœ€æ±‚ï¼Œå¯¹é½ç›®æ ‡æ„¿æ™¯</p>
<p>æ¸…æ™°çš„ç›®æ ‡åŠä¸éœ€æ±‚æ–¹å¯¹é½ç›®æ ‡ä¿¡æ¯ï¼Œè¿™ç‚¹å°¤ä¸ºé‡è¦ã€‚å¯ä»¥æœ‰æ•ˆé¿å…åœ¨ä¸€å¼€å§‹å°±èµ°é”™è·¯ï¼Œå¯¼è‡´è¿”å·¥ã€‚åŒæ—¶éœ€è¦ä»æŠ€æœ¯çš„è§’åº¦è¿›è¡Œæ•´ä½“çš„è§„åˆ’è¯„ä¼°ï¼Œé‚£äº›æ˜¯æŠ€æœ¯éš¾ç‚¹éœ€è¦é¢„ç ”ï¼ˆå¾€å¾€ç»™æ—¶é—´ä¹Ÿä¸ä¸€å®šèƒ½å®Œæˆï¼‰ã€é‚£äº›æ˜¯éœ€è¦å¤§é‡çš„åŠ³åŠ¨åŠ›æŠ•å…¥ã€‚</p>
<p>3ã€å……åˆ†çš„åˆ©ç”¨è¾¹è§’æ—¶é—´</p>
<p>æœ‰äº›æŠ€æœ¯æ–¹æ¡ˆå¾€å¾€æ˜¯éœ€è¦æ—¶é—´å»æ€è€ƒï¼Œå……åˆ†åˆ©ç”¨è¾¹è§’æ—¶é—´ï¼ˆä¾‹å¦‚åœ°é“æ—¶é—´ã€åƒé¥­é—´éš™æ—¶é—´ç­‰ï¼‰è¿›è¡Œä¸€äº›æ€è€ƒï¼Œå¾€å¾€å¯èƒ½æœ‰æ„å‘ä¸åˆ°çš„æ”¶è·ã€‚</p>
<p>4ã€åˆ¶å®šè¯¦ç»†çš„è®¡åˆ’</p>
<p>æˆ‘å§‹ç»ˆç›¸ä¿¡è¦è¾¾åˆ°ç›®æ ‡ï¼Œä¸€å®šè¦æœ‰è¯¦ç»†çš„å¯æ‰§è¡Œè®¡åˆ’ã€‚åœ¨é¡¹ç›®å¼€å±•çš„è¿‡ç¨‹ä¸­ï¼Œåº”å°½å¯èƒ½é¿å…æ²¡æœ‰æ—¶é—´èŠ‚ç‚¹æ¦‚å¿µï¼Œç”šè‡³å‡ºç°å¹²åˆ°é‚£æ˜¯é‚£å¾—æƒ…å†µã€‚å°½å¯èƒ½å°†ç›®æ ‡åˆ†è§£ï¼Œå½¢æˆæœˆã€å‘¨ã€å¤©çš„è®¡åˆ’ã€‚</p>
<p> 5ã€ä¿æŒé£é™©æ„è¯†</p>
<p>å‰é¢è¯´åˆ°çš„éœ€è¦å¯¹æŠ€æœ¯æœ‰æ•´ä½“çš„è¯„ä¼°ï¼Œè¿™å…¶å®ä¹Ÿæ˜¯é£é™©æ„è¯†çš„ä¸€ç§ä½“ç°ã€‚æˆ‘ä»¬éœ€è¦è¯„ä¼°é‚£äº›æ˜¯æŠ€æœ¯éš¾ç‚¹ã€é‚£äº›æ˜¯éœ€è¦åŠ³åŠ¨åŠ›æŠ•å…¥ã€‚åœ¨é¡¹ç›®å‰æœŸå°½å¯èƒ½æå‡ºæ¥ï¼Œä»æŠ€æœ¯æˆ–ä¸šåŠ¡ä¸Šå°½å¯èƒ½é¿å…å…¥å‘ã€‚</p>
<h2 id="æ²Ÿé€šèƒ½åŠ›"><a href="#æ²Ÿé€šèƒ½åŠ›" class="headerlink" title="æ²Ÿé€šèƒ½åŠ›"></a>æ²Ÿé€šèƒ½åŠ›</h2><p>1ã€åŠæ—¶æœ‰æ•ˆçš„æ²Ÿé€š</p>
<p>é¡¹ç›®å¾€å¾€åœ¨æ¨è¿›çš„è¿‡ç¨‹ä¸­ï¼Œä¼šæœ‰å„ç§å„æ ·çš„å› ç´ äº§ç”Ÿå˜åŒ–ã€‚æ‰€ä»¥åŠæ—¶æœ‰æ•ˆçš„æ²Ÿé€šè¿™ç‚¹åº”è¯¥ä¼´éšæ•´ä¸ªé¡¹ç›®çš„å‘¨æœŸã€‚</p>
<p>2ã€ç»Ÿä¸€çš„æ²Ÿé€šé€šé“</p>
<p>ä¿æŒç»Ÿä¸€çš„æ²Ÿé€šé€šé“èƒ½æœ‰æ•ˆé¿å…ä¿¡æ¯ä¸å¯¹ç§°ï¼Œå‡å°‘ä¸å¿…è¦çš„æ²Ÿé€šæˆæœ¬åŠä¿¡æ¯é”™è¯¯ï¼ŒåŠæ—¶æœ‰æ•ˆçš„åŒæ­¥æœ€æ–°çš„ä¿¡æ¯ã€‚é€šå¸¸å¯é‡‡ç”¨ç«™ä¼šã€ç»Ÿä¸€é¡¹ç›®ç¾¤ç»„ã€å®æ—¶åŒæ­¥åä½œå¹³å°ç­‰å½¢å¼ï¼ŒåŠæ—¶ä¿æŒä¿¡æ¯çš„åŒæ­¥ã€‚</p>
<h2 id="ä¼˜ç§€ç¼–ç èƒ½åŠ›"><a href="#ä¼˜ç§€ç¼–ç èƒ½åŠ›" class="headerlink" title="ä¼˜ç§€ç¼–ç èƒ½åŠ›"></a>ä¼˜ç§€ç¼–ç èƒ½åŠ›</h2><p>1ã€è‰¯å¥½çš„ç¼–ç¨‹ä¹ æƒ¯</p>
<p>åœ¨å›¢é˜Ÿå¼€å‘ï¼Œè‰¯å¥½çš„ç¼–ç¨‹ä¹ æƒ¯åŠç»Ÿä¸€çš„è§„èŒƒå°¤ä¸ºé‡è¦ï¼Œè¿™å¯ä»¥é¿å…å¾ˆå¤šä¸å¿…è¦çš„æ²Ÿé€šï¼Œå‡å°‘æ²Ÿé€šåŠåæœŸç»´æŠ¤çš„æˆæœ¬ã€‚</p>
<p>2ã€è‰¯å¥½çš„æ¶æ„è®¾è®¡ã€ç»„ä»¶è®¾è®¡</p>
<p>ä¿æŒä»£ç å¯æ‰©å±•æ€§ï¼Œè®©æˆ‘ä»¬å¯ä»¥æ›´ä»å®¹åº”å¯¹éœ€æ±‚çš„å˜åŒ–ã€‚ç»„ä»¶åŒ–çš„è®¾è®¡èƒ½è®©æˆ‘ä»¬çš„ä»£ç æ›´æ˜“äºå¤ç”¨ï¼Œå¤§å¤§çš„æé«˜äº§å‡ºã€‚</p>
<h1 id="æ€è€ƒ"><a href="#æ€è€ƒ" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h1><p>è¿™äº›å¹´çš„ç»éªŒï¼Œä¸€ä¸ªé¡¹ç›®çš„æˆè´¥ï¼Œå¾€å¾€ä¸æ˜¯å› ä¸ºæŠ€æœ¯çš„åŸå› ï¼Œé€šå¸¸éƒ½æ˜¯ç®¡ç†ä¸Šå‡ºäº†é—®é¢˜ã€‚å¯¹äºä¸€ä¸ªç¨‹åºå‘˜ï¼Œåœ¨ä¿æŒä¼˜ç§€çš„ç¼–ç èƒ½åŠ›å¤–ï¼Œè¿˜è¦é‡è§†é¡¹ç›®ä¸Šçš„è½¯æŠ€èƒ½ã€‚æå‡æ²Ÿé€šã€é£é™©æ„è¯†ã€åˆ¶å®šè®¡åˆ’ã€è‡ªæˆ‘ç®¡ç†ç­‰çš„èƒ½åŠ›ã€‚</p>
<p>æ€»ç»“é—®é¢˜ï¼Œåˆ¶å®šè®¡åˆ’ã€‚ä¸æ–­å®è·µï¼Œä¸æ–­è¶…è¶Šè‡ªå·±ï¼</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://junbin1011.github.io/2019/04/24/å›é¡¾2018ï¼Œå±•æœ›2019/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="é»„ä¿Šå½¬">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://note.youdao.com/yws/api/personal/file/WEB917b08143504a6f8c96228312fcb5245?method=download&shareKey=03cb5c302c83b56bbb91668c5008444f">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JunBin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2019/04/24/å›é¡¾2018ï¼Œå±•æœ›2019/" itemprop="url">
                  å›é¡¾2018ï¼Œå±•æœ›2019
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-04-24T16:20:05+08:00">
                2019-04-24
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/04/24/å›é¡¾2018ï¼Œå±•æœ›2019/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2019/04/24/å›é¡¾2018ï¼Œå±•æœ›2019/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="å›é¡¾2018"><a href="#å›é¡¾2018" class="headerlink" title="å›é¡¾2018"></a>å›é¡¾2018</h1><p>2018å³å°†ç»“æŸï¼Œåˆåˆ°äº†ä¾‹è¡Œå¹´åº¦æ€»ç»“çš„æ—¶åˆ»äº†ã€‚ä¸‹é¢é€šè¿‡å­¦ä¹ ã€å·¥ä½œã€ç”Ÿæ´»ã€è¿˜æœ‰æ„Ÿæ‚Ÿæ¥å›é¡¾å³å°†è¿‡å»çš„2018ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5125122-936920284be34f2a?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<h2 id="å­¦ä¹ "><a href="#å­¦ä¹ " class="headerlink" title="å­¦ä¹ "></a>å­¦ä¹ </h2><h3 id="è‹±è¯­"><a href="#è‹±è¯­" class="headerlink" title="è‹±è¯­"></a>è‹±è¯­</h3><p>ä¸çŸ¥ä¸è§‰ç”¨æ‰‡è´å·²ç»2å¹´å¤šäº†ï¼Œ2018å¹´ä¹Ÿå…¨å‹¤æ‰“å¡ã€‚å‘ç°åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸ä»…å­¦ä¹ äº†è‹±è¯­çš„çŸ¥è¯†ï¼Œä¹Ÿæ…¢æ…¢ç»ƒæˆäº†ä¸€äº›ä¹ æƒ¯ï¼ŒåšæŒã€ä¸æ”¾å¼ƒã€‚è¿™é‡Œæ¨èä¸€ä¸‹æ‰‡è´è‹±è¯­ï¼Œä¸€ç›´åœ¨ç”¨å¾ˆä¸é”™ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5125122-f1fa811f20117b79?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<h3 id="åšå®¢"><a href="#åšå®¢" class="headerlink" title="åšå®¢"></a>åšå®¢</h3><p>2018å¹´æ€»å…±è¾“å‡ºäº†13ç¯‡åšæ–‡ï¼Œè™½ç„¶åªè¾¾åˆ°æœˆå‡ä¸€ç¯‡ã€‚ä½†è‡ªå·±æ„Ÿè§‰è¾“å‡ºçš„è´¨é‡è¾ƒä¸Šä¸€å¹´è¿˜æ˜¯æœ‰è¿›æ­¥çš„ã€‚ä¸»è¦ä¸ºå·¥ä½œä¸Šçš„ä¸€äº›æç‚¼æ€»ç»“åŠæºç å­¦ä¹ ã€‚</p>
<h4 id="å·¥ä½œæç‚¼æ€»ç»“"><a href="#å·¥ä½œæç‚¼æ€»ç»“" class="headerlink" title="å·¥ä½œæç‚¼æ€»ç»“"></a>å·¥ä½œæç‚¼æ€»ç»“</h4><ul>
<li><a href="https://www.jianshu.com/p/ccfc28128d68" target="_blank" rel="noopener">Androidåº”ç”¨æ¶æ„å‰ä¸–ä»Šç”Ÿ</a></li>
<li><a href="https://www.jianshu.com/p/c8e691a69086" target="_blank" rel="noopener">è®°ä¸€æ¬¡Androidå†…å­˜æ³„æ¼çš„ä¼˜åŒ–ç»å†</a></li>
<li><a href="https://www.jianshu.com/p/9e9e902ea039" target="_blank" rel="noopener">Android P å…¼å®¹ä¸é€‚é…</a></li>
<li><a href="https://www.jianshu.com/p/25688ed4777f" target="_blank" rel="noopener">é¡¹ç›®æ¨¡å—é‡æ„åˆ†äº«ä¸æ€è€ƒ</a></li>
<li><a href="https://www.jianshu.com/p/6ae1e09ebbf5" target="_blank" rel="noopener">Androidçƒ­ä¿®å¤æŠ€æœ¯ï¼Œä½ ä¼šæ€ä¹ˆé€‰ï¼Ÿ</a></li>
<li><a href="https://www.jianshu.com/p/24eb823edebc" target="_blank" rel="noopener">APKç˜¦èº«ä¸‰æ­¥æ›²</a></li>
</ul>
<h4 id="å¼€æºæ¡†æ¶æºç å­¦ä¹ ç³»åˆ—"><a href="#å¼€æºæ¡†æ¶æºç å­¦ä¹ ç³»åˆ—" class="headerlink" title="å¼€æºæ¡†æ¶æºç å­¦ä¹ ç³»åˆ—"></a>å¼€æºæ¡†æ¶æºç å­¦ä¹ ç³»åˆ—</h4><ul>
<li><a href="https://www.jianshu.com/p/72172703cc3f" target="_blank" rel="noopener">OkHttpæºç å­¦ä¹ éšç¬”</a></li>
<li><a href="https://www.jianshu.com/p/8b44a76197e1" target="_blank" rel="noopener">Retrofitæºç å­¦ä¹ éšç¬”</a></li>
<li><a href="https://www.jianshu.com/p/e01f68802604" target="_blank" rel="noopener">Glideæºç å­¦ä¹ éšç¬”</a></li>
<li><a href="https://www.jianshu.com/p/1b9671fb0ebe" target="_blank" rel="noopener">EventBusæºç å­¦ä¹ éšç¬”</a></li>
<li><a href="https://www.jianshu.com/p/ea075570dc3d" target="_blank" rel="noopener">leakcanaryæºç å­¦ä¹ éšç¬”</a></li>
<li><a href="https://www.jianshu.com/p/5602ca1322b2" target="_blank" rel="noopener">blockcanaryæºç å­¦ä¹ éšç¬”</a></li>
<li><a href="https://www.jianshu.com/p/26b922d72d7b" target="_blank" rel="noopener">rxjava2.xæºç å­¦ä¹ éšç¬”</a></li>
</ul>
<h4 id="åšæ–‡åœ°å€"><a href="#åšæ–‡åœ°å€" class="headerlink" title="åšæ–‡åœ°å€"></a>åšæ–‡åœ°å€</h4><ul>
<li><a href="https://www.jianshu.com/u/466f8b75f81c" target="_blank" rel="noopener">ç®€ä¹¦åšå®¢ï¼Œhttps://www.jianshu.com/u/466f8b75f81c</a></li>
<li><a href="http://junbin.tech/" target="_blank" rel="noopener">githubï¼Œhttp://junbin.tech/</a></li>
</ul>
<p>å¸Œæœ›æ–°çš„ä¸€å¹´èƒ½å¤Ÿç»§ç»­åšæŒå­¦ä¹ ï¼Œè¾“å‡ºæ›´å¤šã€æ›´é«˜è´¨é‡çš„åšæ–‡ã€‚</p>
<h3 id="æå®¢æ—¶é—´"><a href="#æå®¢æ—¶é—´" class="headerlink" title="æå®¢æ—¶é—´"></a>æå®¢æ—¶é—´</h3><p>2018çŸ¥è¯†ä»˜è´¹çš„çƒ­æ½®ï¼Œæå®¢æ—¶é—´ä¹Ÿæ˜¯åœ¨æ­¤æœŸé—´æ¨å‡ºçš„ä¸€ä¸ªçŸ¥è¯†ä»˜è´¹çš„APPï¼Œä»¥è®¢é˜…ä¸“æ çš„å½¢å¼æä¾›ã€‚ç¡®å®è¿˜æ˜¯æœ‰è›®å¤šçš„å¹²è´§ï¼Œä¸‹é¢åˆ—ä¸€ä¸‹å­¦ä¹ çš„ä¸€äº›ä¸“æ ã€‚</p>
<p>å¥½å¤šå‘å’Œé—®é¢˜éƒ½æ˜¯å‰äººå·²èµ°è¿‡ï¼Œå¤šçœ‹çœ‹å‰äººçš„å¤„ç†æ–¹å¼åŠæ„Ÿæ‚Ÿï¼Œå°‘èµ°å¼¯è·¯ã€‚</p>
<blockquote>
<p>è¿™é‡Œåæ§½ä¸€ä¸‹æå®¢æ—¶é—´çš„Androidç‰ˆæœ¬ï¼Œç»å¸¸å‡ºç°æ— å“åº”çš„æƒ…å†µï¼Œè¦æ€è¿›ç¨‹é‡æ–°è¿›å…¥ã€‚ä¸€åº¦ç”¨å›å°ç¨‹åºç‰ˆæœ¬ã€‚</p>
</blockquote>
<ul>
<li><a href="https://time.geekbang.org/column/104" target="_blank" rel="noopener">æŒç»­äº¤ä»˜36è®²</a></li>
<li><a href="https://time.geekbang.org/column/113" target="_blank" rel="noopener">æŠ€æœ¯ç®¡ç†å®æˆ˜36è®²</a></li>
<li><a href="https://time.geekbang.org/column/111" target="_blank" rel="noopener">ç¨‹åºå‘˜è¿›é˜¶æ”»ç•¥</a></li>
<li><a href="https://time.geekbang.org/column/126" target="_blank" rel="noopener">æ•°æ®ç»“æ„ä¸ç®—æ³•ä¹‹ç¾</a></li>
<li><a href="https://time.geekbang.org/column/79" target="_blank" rel="noopener">æŠ€æœ¯é¢†å¯¼åŠ›300è®²</a></li>
</ul>
<h2 id="å·¥ä½œ"><a href="#å·¥ä½œ" class="headerlink" title="å·¥ä½œ"></a>å·¥ä½œ</h2><h3 id="æ€»ç»“æç‚¼"><a href="#æ€»ç»“æç‚¼" class="headerlink" title="æ€»ç»“æç‚¼"></a>æ€»ç»“æç‚¼</h3><p>åœ¨ç ”å‘çš„è¿‡ç¨‹ä¸­ï¼Œæ€»ä¼šé‡åˆ°ä¸€äº›ç–‘éš¾çš„é—®é¢˜æˆ–ç‰ˆæœ¬çš„é‡Œç¨‹ç¢‘ã€‚æœ‰æ—¶å€™åœä¸€åœï¼Œè¿›è¡Œæ¢³ç†æ€»ç»“åŠè¾“å‡ºï¼Œä¹Ÿæ˜¯ä¸€ç§éå¸¸å¥½çš„çŸ¥è¯†æ²‰æ·€çš„æ–¹å¼ã€‚åœ¨18å¹´ï¼Œä¹Ÿå°†å·¥ä½œä¸­çš„ä¸€äº›é—®é¢˜è¿›è¡Œæ¢³ç†æ€»ç»“ï¼Œæœ€åä»¥åšæ–‡çš„å½¢å¼è¾“å‡ºã€‚</p>
<h3 id="å­¦ä»¥è‡´ç”¨"><a href="#å­¦ä»¥è‡´ç”¨" class="headerlink" title="å­¦ä»¥è‡´ç”¨"></a>å­¦ä»¥è‡´ç”¨</h3><p>æŠ€æœ¯éƒ½æ˜¯é€šè¿‡ä¸šåŠ¡æ¥å˜ç°ä»·å€¼çš„ã€‚è™½ç„¶å„ç§æ–°æŠ€æœ¯é£èµ·äº‘æ¶Œï¼Œä½†æ˜¯ç»“åˆä¸šåŠ¡è¿›è¡Œé¢„ç ”åŠåº”ç”¨ï¼Œæ‰èƒ½å½¢æˆè‰¯å¥½çš„é—­ç¯ã€‚å¦åˆ™åªèƒ½å½“ä½œçŸ¥è¯†å‚¨å¤‡ï¼Œå¾ˆå®¹æ˜“éšç€æ—¶é—´çš„æ¨ç§»ï¼Œæ…¢æ…¢å°±æ¶ˆä¹‹æ®†å°½ã€‚</p>
<h2 id="ç”Ÿæ´»"><a href="#ç”Ÿæ´»" class="headerlink" title="ç”Ÿæ´»"></a>ç”Ÿæ´»</h2><h3 id="å®¶åº­"><a href="#å®¶åº­" class="headerlink" title="å®¶åº­"></a>å®¶åº­</h3><p>ä¸çŸ¥ä¸è§‰ï¼Œå®å®ä¹Ÿ1å²å¤šäº†ã€‚ç»ˆäºä»æ™šä¸Šèµ·æ¥3-5æ¬¡åˆ°ç°åœ¨ç¡æ•´è§‰äº†ã€‚åœ¨è¿™ä¸ªæœŸé—´è¿˜æ˜¯éå¸¸æ„Ÿè°¢è€å©†ä¸æˆ‘å¦ˆå¦ˆçš„è¾›è‹¦ä»˜å‡ºï¼Œè®©å®å®å¿«ä¹æˆæ‰ã€‚<br>æ„Ÿå¹ä¸€ä¸‹ï¼å½“ä¸ªç¨‹åºå‘˜ä¸å®¹æ˜“ï¼Œå½“ä¸ªçˆ¸çˆ¸ä¹Ÿä¸å®¹æ˜“ã€‚</p>
<p>è€å©†æ•´ç†çš„å®å®å‘¨å²ç›¸å†Œé›†åˆ-<a href="https://www.meipian.cn/1tpytehy?share_from=self&amp;v=4.7.2&amp;share_user_mpuuid=14b94e097cc76be42d48dcb2c961b192&amp;utm_source=singlemessage&amp;from=singlemessage&amp;user_id=59638444&amp;uuid=06bd0f920f7f912f18889de521653c9c&amp;utm_medium=meipian_android" target="_blank" rel="noopener">å®å®å‘¨å² ç›¸å†Œé›†åˆ</a></p>
<h3 id="èº«ä½“"><a href="#èº«ä½“" class="headerlink" title="èº«ä½“"></a>èº«ä½“</h3><p>èº«ä½“æ˜¯é©å‘½çš„æœ¬é’±ï¼Œæ˜¯ä¸€åˆ‡çš„åŸºç¡€ï¼Œä¸€å®šè¦åŠ å¼ºé”»ç‚¼ã€‚æˆ‘è‡ªå·±ä¸€ç›´éƒ½æ˜¯èƒ–çš„ä½“è´¨ã€‚176çš„èº«é«˜ï¼Œ87.5kgçš„ä½“é‡ã€‚ç»è¿‡å·®ä¸å¤š2ä¸ªå¤šæœˆçš„é”»ç‚¼åŠé¥®é£Ÿæ§åˆ¶ï¼Œç›®å‰ç»´æŒåœ¨78kgå·¦å³ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5125122-a6e9118030ef0228?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p>è¿™é‡Œç»™ä¸€ä¸‹å¿ƒå¾—</p>
<ul>
<li>7åˆ†åƒ3åˆ†ç»ƒï¼Œè¦ç®¡å¥½å˜´ï¼Œç‰¹åˆ«æ˜¯ä¸»é£Ÿ</li>
<li>æ™šé¤å°‘åƒã€å®µå¤œä¸€å®šä¸è¦åƒ</li>
<li>è®¾å®šç›®æ ‡ã€ä½¿ç”¨APPè¿›è¡Œè®°å½•</li>
</ul>
<h2 id="æ„Ÿæ‚Ÿ"><a href="#æ„Ÿæ‚Ÿ" class="headerlink" title="æ„Ÿæ‚Ÿ"></a>æ„Ÿæ‚Ÿ</h2><h3 id="æ‰¿è¯º"><a href="#æ‰¿è¯º" class="headerlink" title="æ‰¿è¯º"></a>æ‰¿è¯º</h3><p>æ¯ä¸ªäººéƒ½ä¼šé‡åˆ°å¾ˆå¤šé€‰æ‹©çš„æœºä¼šã€‚éšç€æœ‰äº†å®¶åº­ï¼Œå·²ä¸åƒåˆšèµ°å‡ºå­¦æ ¡é‚£æ ·éšå¿ƒæ‰€æ¬²ã€‚åšä»»ä½•é€‰æ‹©ä¹‹å‰éƒ½éœ€è¦å…ˆå……åˆ†æ€è€ƒå’Œå¹³è¡¡ï¼Œä¸è¦è½»æ˜“è®¸ä¸‹æ‰¿è¯ºã€‚</p>
<p>çæƒœæ¯ä¸€æ¬¡æœºä¼šï¼Œä¹Ÿé‡è§†æ¯æ¬¡æ‰¿è¯ºã€‚</p>
<h3 id="å¯’å†¬"><a href="#å¯’å†¬" class="headerlink" title="å¯’å†¬"></a>å¯’å†¬</h3><p>æ¥è¿‘å¹´æœ«ï¼Œæ²¡æƒ³åˆ°â€œå¯’å†¬â€æˆäº†çƒ­è¯ã€‚å…¶å®äº’è”ç½‘è¿™ä¸ªè¡Œä¸šï¼Œç¬æ¯ä¸‡å˜ã€‚å±æœºæ„Ÿåº”è¯¥å®æ—¶å…·å¤‡ï¼Œç‰¹åˆ«æ˜¯å½“ä½ æ„Ÿè§‰å·²ç»èµ°å…¥äº†ä¸€ä¸ªèˆ’é€‚åŒºã€‚</p>
<p>æ²¡æœ‰ä¸€ä¸ªä¼ä¸šä¼šä¸ºäº†ä¸€ä¸ªæ²¡æœ‰ä»·å€¼çš„å‘˜å·¥æ”¯ä»˜æŠ¥é…¬ï¼Œæ‰€ä»¥å”¯æœ‰ä¸æ–­çš„æå‡è‡ªå·±çš„è½¯ç¡¬æŠ€èƒ½ï¼Œæ‰èƒ½ä»å®¹åº”å¯¹å˜åŒ–ã€‚</p>
<h1 id="å±•æœ›2019"><a href="#å±•æœ›2019" class="headerlink" title="å±•æœ›2019"></a>å±•æœ›2019</h1><p><img src="http://upload-images.jianshu.io/upload_images/5125122-603fb426dfe2a525?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p>1ã€å½¢æˆçŸ¥è¯†æŠ€èƒ½æ ‘ï¼Œæœ‰ç›®æ ‡è§„åˆ’æ¨è¿›</p>
<p>2ã€å­¦ä»¥è‡´ç”¨ã€æ€»ç»“æç‚¼ã€è¾“å‡ºåšæ–‡</p>
<p>3ã€æ·±åº¦æ²‰æ·€ã€å¹¿åº¦æ‹“å±•ï¼ŒåŸºç¡€æŠ€èƒ½ç§¯ç´¯ã€æ ¸å¿ƒæŠ€èƒ½æ·±åŒ–</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://junbin1011.github.io/2018/11/28/APKç˜¦èº«ä¸‰æ­¥æ›²/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="é»„ä¿Šå½¬">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://note.youdao.com/yws/api/personal/file/WEB917b08143504a6f8c96228312fcb5245?method=download&shareKey=03cb5c302c83b56bbb91668c5008444f">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JunBin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/11/28/APKç˜¦èº«ä¸‰æ­¥æ›²/" itemprop="url">
                  APKç˜¦èº«ä¸‰æ­¥æ›²
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2018-11-28T15:26:37+08:00">
                2018-11-28
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/11/28/APKç˜¦èº«ä¸‰æ­¥æ›²/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/11/28/APKç˜¦èº«ä¸‰æ­¥æ›²/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>115äº2009å¹´æ¨å‡ºçš„ç½‘ç»œæ•°æ®åœ¨çº¿å­˜å‚¨æœåŠ¡ï¼Œä¸€ç›´ä»¥æ¥éƒ½æœ‰é˜¶æ®µæ€§å¯¹åº”ç”¨è¿›è¡Œå®‰è£…åŒ…çš„ä½“ç§¯ä¼˜åŒ–ï¼Œå› ä¸ºå…¬å¸ä¹Ÿæ²¡æœ‰ç¡¬æ€§çš„æŒ‡æ ‡è§„å®šï¼Œæ‰€ä»¥è¿™å—çš„é‡è§†ç¨‹åº¦ä¹Ÿä¸€ç›´ä¸é«˜ã€‚å¯¹æ¯”äº†ç›®å‰ç«å“çš„ä¸€ä¸ªæƒ…å†µï¼Œå¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>åº”ç”¨</th>
<th>ç‰ˆæœ¬å·</th>
<th>å¤§å°</th>
</tr>
</thead>
<tbody>
<tr>
<td>115</td>
<td>V8.1.1</td>
<td>50.26M</td>
</tr>
<tr>
<td>å¾®äº‘</td>
<td>V6.6.4</td>
<td>37.67MB</td>
</tr>
<tr>
<td>ç™¾åº¦äº‘</td>
<td>V9.0.2</td>
<td>48.3MB</td>
</tr>
</tbody>
</table>
<p>ä½¿ç”¨Android Studioçš„APK Analyzerå…·ä½“è¯¦ç»†åˆ†æå¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>ç›®å½•</th>
<th>115</th>
<th>å¾®äº‘</th>
<th>ç™¾åº¦äº‘</th>
</tr>
</thead>
<tbody>
<tr>
<td> res</td>
<td>31.8M</td>
<td>+assert 10.2M</td>
<td>+assert 17.4M</td>
</tr>
<tr>
<td>lib</td>
<td>7M</td>
<td>18.2M</td>
<td>13.1M</td>
</tr>
<tr>
<td>classes</td>
<td>7.3M</td>
<td>6.8M</td>
<td>13.9M</td>
</tr>
<tr>
<td>resource.arsc</td>
<td>1.9M</td>
<td>1.6M</td>
<td>2.2M</td>
</tr>
</tbody>
</table>
<h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>è™½ç„¶å„ä¸ªåº”ç”¨çš„åŠŸèƒ½é›†ä¸ä¸€è‡´ï¼Œä½†æ˜¯ä¸»è¦éƒ½æ˜¯æä¾›å­˜å‚¨æœåŠ¡ï¼Œè¿™é‡Œçš„å¯¹æ¯”ä¹Ÿæ˜¯ä»æŸä¸ªå±‚é¢è¿›è¡Œæ¯”è¾ƒã€‚é€šè¿‡åˆ†æå¯¹æ¯”è¡¨å¯ä»¥å¾—çŸ¥ã€‚</p>
<ol>
<li>å¾®äº‘ä½“ç§¯æœ€å°‘ï¼Œç™¾åº¦äº‘æ¬¡ä¹‹ï¼Œ115æœ€å¤§</li>
<li>115ä½“ç§¯ä¸»è¦æœ€å¤§çš„åœ°æ–¹åœ¨reså›¾ç‰‡èµ„æºè¿™å—</li>
<li>115çš„libåŠclassesæ˜¯æœ€å°çš„</li>
</ol>
<p><strong>æ‰€ä»¥ä»åˆ†æçš„ç»“æœä¸Šæ¥çœ‹ï¼Œ115çš„ä½“ç§¯ä¼˜åŒ–çš„ä¸»è¦æ–¹å‘è¦ä»reså›¾ç‰‡èµ„æºå…¥æ‰‹ã€‚</strong></p>
<h1 id="ç˜¦èº«ä¸‰æ­¥æ›²-åˆ é™¤ã€å‹ç¼©ã€æ··æ·†"><a href="#ç˜¦èº«ä¸‰æ­¥æ›²-åˆ é™¤ã€å‹ç¼©ã€æ··æ·†" class="headerlink" title="ç˜¦èº«ä¸‰æ­¥æ›²(åˆ é™¤ã€å‹ç¼©ã€æ··æ·†)"></a>ç˜¦èº«ä¸‰æ­¥æ›²(åˆ é™¤ã€å‹ç¼©ã€æ··æ·†)</h1><h2 id="åˆ é™¤"><a href="#åˆ é™¤" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h2><h3 id="åˆ é™¤æ— ç”¨çš„ä»£ç "><a href="#åˆ é™¤æ— ç”¨çš„ä»£ç " class="headerlink" title="åˆ é™¤æ— ç”¨çš„ä»£ç "></a>åˆ é™¤æ— ç”¨çš„ä»£ç </h3><p>åˆ é™¤æ— ç”¨çš„ä»£ç ï¼Œè¿™ä¸ªæ”¾åœ¨ç¬¬ä¸€ä½æ˜¯å› ä¸ºè¿™ä¸ªæ˜¯é—®é¢˜çš„æ ¹æºã€‚</p>
<p>éšç€é¡¹ç›®ç‰ˆæœ¬çš„è¿­ä»£åŠä¸šåŠ¡å¿«é€Ÿçš„æ›´è¿­ï¼Œæœ‰æ—¶å€™ä¸ºäº†èµ¶æ—¶é—´ï¼ŒåºŸå¼ƒçš„ä»£ç åŠèµ„æºéƒ½ä¸ä¼šåŠæ—¶æ¸…ç†ï¼Œæ—¥ç§¯æœˆç´¯çš„å †ç§¯ï¼Œæ…¢æ…¢APKçš„ä½“ç§¯å°±ä¼šè¶Šæ¥è¶Šè‡ƒè‚¿ã€‚</p>
<p>å¦‚æœå±äºè¿™ç§æƒ…å†µï¼Œåº”è¯¥å…ˆè‡ªå·±è¿›è¡Œäººå·¥çš„æ•´ç†åŠæ¸…é™¤ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥å…ˆä¸ç®¡èµ„æºï¼ˆåé¢ç”¨å·¥å…·è¿›è¡Œæ¸…ç†ï¼‰ï¼Œä½†æ˜¯ç±»ç›¸å…³çš„è°ƒç”¨åŠæ— ç”¨çš„ç±»è¦åŠæ—¶è¿›è¡Œæ¸…ç†ã€‚å¦åˆ™åé¢çš„å›¾ç‰‡åŠèµ„æºä¹Ÿä¼šç…§æ ·è¢«è¯†åˆ«ä¸ºæœ‰å¼•ç”¨ï¼Œæ‰“åŒ…è¿›APKã€‚</p>
<h3 id="Lintå·¥å…·æ£€æŸ¥"><a href="#Lintå·¥å…·æ£€æŸ¥" class="headerlink" title="Lintå·¥å…·æ£€æŸ¥"></a>Lintå·¥å…·æ£€æŸ¥</h3><p>Android Studioç»™æˆ‘ä»¬æä¾›äº†å¼ºå¤§çš„æ£€æŸ¥å·¥å…·ã€‚åªéœ€è¦é€‰ä¸­resç›®å½•ï¼Œå³é”®é€‰æ‹©Refactorç„¶åå†é€‰æ‹©Remove Unused Resourcesã€‚<br>å»ºè®®å…ˆä½¿ç”¨Previewï¼Œç„¶åå†è¿›è¡Œåˆ é™¤ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5125122-4b0211c7d9dae8da?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Lintä½¿ç”¨"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/5125122-15d203966b219747?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Lint Preview"></p>
<blockquote>
<p>è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œç‰¹åˆ«æœ‰ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„SDKï¼Œæœ‰äº›ä»£ç æ˜¯åœ¨jaråŒ…é‡Œé¢ï¼Œä½†æ˜¯èµ„æºç‹¬ç«‹æ‹·è´è¿›å·¥ç¨‹ï¼Œè¿™æ ·ä¹Ÿä¼šè¢«è¯†åˆ«æˆæ— å¼•ç”¨çš„èµ„æºã€‚ä½†æ˜¯è¿™ç±»èµ„æºä¸€èˆ¬éƒ½æœ‰ç‰¹å®šçš„å‘½åæ ¼å¼ã€‚</p>
</blockquote>
<h3 id="Grdleé…ç½®"><a href="#Grdleé…ç½®" class="headerlink" title="Grdleé…ç½®"></a>Grdleé…ç½®</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">        buildTypes &#123;</span><br><span class="line">            release &#123;</span><br><span class="line">                minifyEnabled true //æ˜¯å¦å¼€å¯æ··æ·†</span><br><span class="line">                shrinkResources true //å‹ç¼©</span><br><span class="line">                zipAlignEnabled true ////å»æ‰æ— ç”¨çš„resourseæ–‡ä»¶</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>å¯ç”¨shrinkResourcesï¼Œgradleåœ¨æ‰“åŒ…çš„æ—¶å€™ä¼šè‡ªåŠ¨è¿›è¡Œèµ„æºçš„æ¸…ç†ã€‚</p>
<h2 id="å‹ç¼©"><a href="#å‹ç¼©" class="headerlink" title="å‹ç¼©"></a>å‹ç¼©</h2><h3 id="PNGå‹ç¼©ä¼˜åŒ–"><a href="#PNGå‹ç¼©ä¼˜åŒ–" class="headerlink" title="PNGå‹ç¼©ä¼˜åŒ–"></a>PNGå‹ç¼©ä¼˜åŒ–</h3><p>æ¨èä½¿ç”¨<a href="https://tinypng.com/" target="_blank" rel="noopener">tinypng</a>ã€‚</p>
<p>tinypngé€šè¿‡åˆå¹¶å›¾ç‰‡ä¸­ç›¸ä¼¼çš„é¢œè‰²ï¼Œé€šè¿‡å°† 24 ä½çš„ PNG å›¾ç‰‡å‹ç¼©æˆå°å¾—å¤šçš„ 8 ä½è‰²å€¼çš„å›¾ç‰‡ï¼Œå¹¶ä¸”å»æ‰äº†å›¾ç‰‡ä¸­ä¸å¿…è¦çš„ metadataï¼ˆå…ƒæ•°æ®ï¼Œä» Photoshop ç­‰å·¥å…·ä¸­å¯¼å‡ºçš„å›¾ç‰‡éƒ½ä¼šå¸¦æœ‰æ­¤ç±»ä¿¡æ¯ï¼‰ï¼Œè¿™ç§æ–¹å¼å‡ ä¹èƒ½å®Œç¾æ”¯æŒåŸå›¾ç‰‡çš„é€æ˜åº¦ã€‚æœ‰éƒ¨åˆ†æ–‡æ¡£æŒ‡å‡ºtinypngåŒæ—¶é‡‡ç”¨äº†pngquantã€optipngã€advpngå‡ ç§è„šæœ¬ã€‚å›¾ç‰‡çš„å‹ç¼©ç‡èƒ½è¾¾åˆ°50%ä»¥ä¸Šã€‚</p>
<h3 id="webpä½¿ç”¨"><a href="#webpä½¿ç”¨" class="headerlink" title="webpä½¿ç”¨"></a>webpä½¿ç”¨</h3><p>WebPæ ¼å¼ï¼Œè°·æ­Œï¼ˆgoogleï¼‰å¼€å‘çš„ä¸€ç§æ—¨åœ¨åŠ å¿«å›¾ç‰‡åŠ è½½é€Ÿåº¦çš„å›¾ç‰‡æ ¼å¼ã€‚æ— æŸå‹ç¼©æ¯”PNGæ–‡ä»¶å°45%ï¼Œå³ä½¿PNGå·²ç»è¿‡å…¶ä»–çš„ä¼˜åŒ–ï¼Œä¹Ÿèƒ½è¾¾åˆ°28%ã€‚ç¼ºç‚¹ï¼ŒåŠ è½½æ¯”PNGæ…¢ã€‚</p>
<p>Android Studioè‡ªå¸¦äº†å¯¹WebPçš„è½¬æ¢æ”¯æŒã€‚é€‰ä¸­èµ„æºï¼Œå³é”®Convert to WebPã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5125122-237f41569728e956?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="PNG è½¬ WebP"></p>
<p>é€šè¿‡åˆ é™¤åŠå‹ç¼©å‰ä¸¤æ­¥çš„æ“ä½œï¼Œ115çš„ä¼˜åŒ–æƒ…å†µå¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>ç›®å½•</th>
<th>115</th>
<th>115ä¼˜åŒ–</th>
</tr>
</thead>
<tbody>
<tr>
<td> res</td>
<td>31.8M</td>
<td>26.1MM</td>
</tr>
<tr>
<td>lib</td>
<td>7M</td>
<td>7M </td>
</tr>
<tr>
<td>classes</td>
<td>7.3M</td>
<td>7.3M</td>
</tr>
<tr>
<td>resource.arsc</td>
<td>1.9M</td>
<td>1.8M</td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>ä¼˜åŒ–æƒ…å†µåˆ†æï¼šä¼˜åŒ–åä¸º44.46Mï¼Œçº¦èŠ‚çœ5.8Mï¼Œä¼˜åŒ–11%</strong></p>
<h2 id="æ··æ·†"><a href="#æ··æ·†" class="headerlink" title="æ··æ·†"></a>æ··æ·†</h2><h3 id="Proguardä»£ç æ··æ·†"><a href="#Proguardä»£ç æ··æ·†" class="headerlink" title="Proguardä»£ç æ··æ·†"></a>Proguardä»£ç æ··æ·†</h3><ol>
<li>åˆ é™¤æ³¨é‡Šå’Œæ— ç”¨çš„ä»£ç </li>
<li>å°†javaæ–‡ä»¶æ–‡ä»¶ååŠæ–¹æ³•åæ”¹æˆçŸ­å a.java </li>
</ol>
<p>æ”¯æŒçš„æ–¹å¼ä¹Ÿå¾ˆç®€å•ï¼ŒGradleé»˜è®¤æ”¯æŒ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">        buildTypes &#123;</span><br><span class="line">            release &#123;</span><br><span class="line">                minifyEnabled true //æ˜¯å¦å¼€å¯æ··æ·†</span><br><span class="line">                 proguardFiles getDefaultProguardFile(&apos;proguard-android.txt&apos;), &apos;proguard-rules.pro&apos;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="èµ„æºæ··æ·†"><a href="#èµ„æºæ··æ·†" class="headerlink" title="èµ„æºæ··æ·†"></a>èµ„æºæ··æ·†</h3><p><a href="https://github.com/shwenzhang/AndResGuard/blob/master/README.zh-cn.md" target="_blank" rel="noopener">AndResGuard</a>æ˜¯ä¸€ä¸ªå¸®åŠ©ä½ ç¼©å°APKå¤§å°çš„å·¥å…·ï¼Œä»–çš„åŸç†ç±»ä¼¼Java Proguardï¼Œä½†æ˜¯åªé’ˆå¯¹èµ„æºã€‚ä»–ä¼šå°†åŸæœ¬å†—é•¿çš„èµ„æºè·¯å¾„å˜çŸ­ï¼Œä¾‹å¦‚å°†res/drawable/wechatå˜ä¸ºr/d/aã€‚</p>
<p>å…·ä½“çš„åŸç†å¯å‚çœ‹<a href="https://mp.weixin.qq.com/s?__biz=MzAwNDY1ODY2OQ==&amp;mid=208135658&amp;idx=1&amp;sn=ac9bd6b4927e9e82f9fa14e396183a8f#rd" target="_blank" rel="noopener">å®‰è£…åŒ…ç«‹å‡1Mâ€“å¾®ä¿¡Androidèµ„æºæ··æ·†æ‰“åŒ…å·¥å…·</a></p>
<p>é›†æˆä¹Ÿéå¸¸ç®€å•ï¼Œè¯¦ç»†å‚çœ‹Githubä¸­çš„ä½¿ç”¨è¯´æ˜åˆ™å¯ã€‚</p>
<p>é€šè¿‡èµ„æºæ··æ·†åï¼Œ115çš„ä¼˜åŒ–æƒ…å†µå¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>ç›®å½•</th>
<th>115</th>
<th>115ä¼˜åŒ–</th>
<th>115èµ„æºæ··æ·†</th>
</tr>
</thead>
<tbody>
<tr>
<td> res</td>
<td>31.8M</td>
<td>26.1MM</td>
<td>25.4M</td>
</tr>
<tr>
<td>lib</td>
<td>7M</td>
<td>7M</td>
<td>6.7M</td>
</tr>
<tr>
<td>classes</td>
<td>7.3M</td>
<td>7.3M</td>
<td>6.9M</td>
</tr>
<tr>
<td>resource.arsc</td>
<td>1.9M</td>
<td>1.8M</td>
<td>280.3KB</td>
</tr>
</tbody>
</table>
<p><strong>ä¼˜åŒ–æƒ…å†µåˆ†æï¼šä¼˜åŒ–åä¸º41.32Mï¼Œç›¸æ¯”æ²¡åšèµ„æºæ··æ·†ï¼Œçº¦èŠ‚çœ3.14Mï¼Œä½“ç§¯ä¼˜åŒ–7%</strong></p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>ç»è¿‡ç˜¦èº«ä¸‰æ­¥æ›²çš„ä¼˜åŒ–åï¼Œæœ€ç»ˆ115åº”ç”¨çš„ä¸€ä¸ªä¼˜åŒ–æƒ…å†µå¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>ç›®å½•</th>
<th>115</th>
<th>115æœ€ç»ˆä¼˜åŒ–ç‰ˆæœ¬</th>
</tr>
</thead>
<tbody>
<tr>
<td> res</td>
<td>31.8M</td>
<td>25.4M</td>
</tr>
<tr>
<td>lib</td>
<td>7M</td>
<td>6.7M</td>
</tr>
<tr>
<td>classes</td>
<td>7.3M</td>
<td>6.9M</td>
</tr>
<tr>
<td>resource.arsc</td>
<td>1.9M</td>
<td>280.3KB</td>
</tr>
</tbody>
</table>
<p><strong>ä¼˜åŒ–æƒ…å†µåˆ†æï¼šä¼˜åŒ–åä¸º41.32Mï¼Œç›¸æ¯”æ²¡åšä¼˜åŒ–å‰ï¼Œçº¦èŠ‚çœ8.94Mï¼Œä½“ç§¯ä¼˜åŒ–17.7%</strong></p>
<blockquote>
<p>115çš„APKä½“ç§¯ä¼˜åŒ–ï¼Œç°é˜¶æ®µåªèƒ½è¯´æ˜¯åšäº†ä¸€ä¸ªåˆæ­¥ä¼˜åŒ–ï¼Œç‰¹åˆ«æ˜¯å¯¹äºç¬¬ä¸€æ­¥çš„åˆ é™¤ï¼Œç”±äºå†å²çš„é—ç•™åŸå› ã€‚å¯¹äºä¸€äº›é—ç•™çš„ä»£ç è¿˜å¾…è¿›ä¸€æ­¥çš„æ•´ç†å’Œæ¸…é™¤ï¼Œä½“ç§¯ä¹Ÿæ˜¯è¿˜æœ‰ç»§ç»­ä¼˜åŒ–çš„ç©ºé—´ã€‚</p>
</blockquote>
<h2 id="å…¶ä»–æ–¹æ¡ˆ"><a href="#å…¶ä»–æ–¹æ¡ˆ" class="headerlink" title="å…¶ä»–æ–¹æ¡ˆ"></a>å…¶ä»–æ–¹æ¡ˆ</h2><p>é™¤äº†å¸¸è§„çš„ç˜¦èº«ä¸‰æ­¥æ›²ï¼Œå¯¹äºAPKä½“ç§¯å½“ç„¶è¿˜æœ‰å…¶ä»–çš„æ–¹æ¡ˆã€‚å¦‚ï¼š</p>
<ol>
<li>èµ„æºåŠ¨æ€åŠ è½½ï¼ˆå¦‚è¡¨æƒ…åŒ…åŠ¨æ€ä¸‹è½½ï¼‰</li>
<li>æ’ä»¶åŒ–ï¼ˆåŠ¨æ€åŠ è½½ï¼‰</li>
</ol>
<p>æ–¹æ¡ˆå½“ç„¶è¿˜æœ‰å¾ˆå¤šï¼Œæœ¬æ–‡åªä»‹ç»å¸¸è§„ä½¿ç”¨çš„ä¸€äº›æ–¹æ³•ï¼Œæœ‰å…´è¶£çš„ä¼™ä¼´å¯ä»¥ç»§ç»­æ·±å…¥äº†è§£ã€‚</p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://tinypng.com/" target="_blank" rel="noopener">tinypng</a></p>
<p><a href="https://github.com/shwenzhang/AndResGuard/blob/master/README.zh-cn.md" target="_blank" rel="noopener">AndResGuard</a></p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzAwNDY1ODY2OQ==&amp;mid=208135658&amp;idx=1&amp;sn=ac9bd6b4927e9e82f9fa14e396183a8f#rd" target="_blank" rel="noopener">å®‰è£…åŒ…ç«‹å‡1Mâ€“å¾®ä¿¡Androidèµ„æºæ··æ·†æ‰“åŒ…å·¥å…·</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://junbin1011.github.io/2018/09/21/Androidçƒ­ä¿®å¤æŠ€æœ¯ï¼Œä½ ä¼šæ€ä¹ˆé€‰ï¼Ÿ/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="é»„ä¿Šå½¬">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://note.youdao.com/yws/api/personal/file/WEB917b08143504a6f8c96228312fcb5245?method=download&shareKey=03cb5c302c83b56bbb91668c5008444f">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JunBin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/09/21/Androidçƒ­ä¿®å¤æŠ€æœ¯ï¼Œä½ ä¼šæ€ä¹ˆé€‰ï¼Ÿ/" itemprop="url">
                  Androidçƒ­ä¿®å¤æŠ€æœ¯ï¼Œä½ ä¼šæ€ä¹ˆé€‰ï¼Ÿ
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2018-09-21T09:12:00+08:00">
                2018-09-21
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/09/21/Androidçƒ­ä¿®å¤æŠ€æœ¯ï¼Œä½ ä¼šæ€ä¹ˆé€‰ï¼Ÿ/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/09/21/Androidçƒ­ä¿®å¤æŠ€æœ¯ï¼Œä½ ä¼šæ€ä¹ˆé€‰ï¼Ÿ/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ç›®å‰Androidä¸šå†…ï¼Œçƒ­ä¿®å¤æŠ€æœ¯ç™¾èŠ±é½æ”¾ï¼Œå„å¤§å‚éƒ½æ¨å‡ºäº†è‡ªå·±çš„çƒ­ä¿®å¤æ–¹æ¡ˆï¼Œä½¿ç”¨çš„æŠ€æœ¯æ–¹æ¡ˆä¹Ÿå„æœ‰æ‰€å¼‚ï¼Œå½“ç„¶å„ä¸ªæ–¹æ¡ˆä¹Ÿéƒ½å­˜åœ¨å„è‡ªçš„å±€é™æ€§ã€‚åœ¨é¢å¯¹ä¼—å¤šçš„æ–¹æ¡ˆï¼Œå¸Œæœ›é€šè¿‡æ¢³ç†è¿™äº›çƒ­ä¿®å¤æ–¹æ¡ˆçš„å¯¹æ¯”åŠå®ç°åŸç†ï¼ŒæŒæ¡çƒ­ä¿®å¤æŠ€æœ¯çš„æœ¬è´¨ï¼ŒåŒæ—¶ä¹Ÿå¯¹é¡¹ç›®æ¥å…¥åšå¥½å‡†å¤‡ã€‚</p>
<h1 id="ä»€ä¹ˆæ˜¯çƒ­ä¿®å¤æŠ€æœ¯ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯çƒ­ä¿®å¤æŠ€æœ¯ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯çƒ­ä¿®å¤æŠ€æœ¯ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯çƒ­ä¿®å¤æŠ€æœ¯ï¼Ÿ</h1><p>å…³äºçƒ­ä¿®å¤è¿™ä¸ªåè¯ï¼Œå¹¶ä¸é™Œç”Ÿã€‚ç›¸ä¿¡å¤§å®¶éƒ½æœ‰è¿‡æ›´æ–°windowè¡¥ä¸çš„ç»å†ï¼Œé€šè¿‡è¡¥ä¸å¯ä»¥åŠ¨æ€ä¿®å¤ç³»ç»Ÿçš„æ¼æ´ï¼Œåªä¸è¿‡è¿™ä¸ªè¿‡ç¨‹å¯¹ç”¨æˆ·è€Œè¨€æ˜¯å¯é€‰åŠè‡ªè¡Œæ“ä½œã€‚</p>
<p>é‚£ä¹ˆå…³äºAndroidå¹³å°çš„çƒ­ä¿®å¤æŠ€æœ¯ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯é€šè¿‡ä¸‹å‘è¡¥ä¸åŒ…ï¼Œè®©å·²å®‰è£…çš„å®¢æˆ·ç«¯åŠ¨æ€æ›´æ–°ï¼Œè®©ç”¨æˆ·å¯ä»¥ä¸ç”¨é‡æ–°å®‰è£…APPï¼Œå°±èƒ½å¤Ÿä¿®å¤è½¯ä»¶ç¼ºé™·çš„ä¸€ç§æŠ€æœ¯ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5125122-50c2fb502983a3bb?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p>éšç€çƒ­ä¿®å¤æŠ€æœ¯çš„å‘å±•ï¼Œä¸ä»…å¯ä»¥ä¿®å¤ä»£ç ï¼ŒåŒæ—¶å¯ä»¥ä¿®å¤èµ„æºæ–‡ä»¶åŠSOåº“ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5125122-cb67bc0991f396fb?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<h1 id="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨çƒ­ä¿®å¤æŠ€æœ¯ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦ä½¿ç”¨çƒ­ä¿®å¤æŠ€æœ¯ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨çƒ­ä¿®å¤æŠ€æœ¯ï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨çƒ­ä¿®å¤æŠ€æœ¯ï¼Ÿ</h1><p>åœ¨å›ç­”è¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œæˆ‘è§‰å¾—åº”è¯¥å…ˆæ€è€ƒå¦‚ä¸‹å‡ ä¸ªé—®é¢˜ã€‚</p>
<ol>
<li>å¼€å‘ä¸Šçº¿çš„ç‰ˆæœ¬èƒ½ä¿è¯ä¸å­˜åœ¨Bugä¹ˆï¼Ÿ</li>
<li>ä¿®å¤åçš„ç‰ˆæœ¬èƒ½ä¿è¯ç”¨æˆ·éƒ½åŠæ—¶æ›´æ–°ä¹ˆï¼Ÿ</li>
<li>å¦‚ä½•æœ€å¤§åŒ–å‡å°‘çº¿ä¸ŠBugå¯¹ä¸šåŠ¡çš„å½±å“ï¼Ÿ</li>
</ol>
<p>ä»è¿™äº›è§’åº¦æ¥è¯´ï¼Œç›¸ä¿¡å¤§å®¶åº”è¯¥éƒ½èƒ½æœ‰æ‰€ä½“ä¼šï¼Œçƒ­ä¿®å¤æŠ€æœ¯å¸¦æ¥çš„ä¼˜åŠ¿ä¸è¨€è€Œå–»ã€‚</p>
<ol>
<li>å¯å¿«é€Ÿä¿®å¤ï¼Œé¿å…çº¿ä¸ŠBugå¸¦æ¥çš„ä¸šåŠ¡æŸå¤±ï¼ŒæŠŠæŸå¤±é™åˆ°æœ€ä½ã€‚</li>
<li>ä¿è¯å®¢æˆ·ç«¯çš„æ›´æ–°ç‡ï¼Œæ— é¡»ç”¨æˆ·è¿›è¡Œç‰ˆæœ¬å‡çº§å®‰è£…</li>
<li>è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œæ— æ„ŸçŸ¥ä¿®å¤å¼‚å¸¸ã€‚èŠ‚çœç”¨æˆ·ä¸‹è½½å®‰è£…æˆæœ¬ã€‚</li>
</ol>
<h1 id="æ€ä¹ˆé€‰æ‹©çƒ­ä¿®å¤æŠ€æœ¯æ–¹æ¡ˆï¼Ÿ"><a href="#æ€ä¹ˆé€‰æ‹©çƒ­ä¿®å¤æŠ€æœ¯æ–¹æ¡ˆï¼Ÿ" class="headerlink" title="æ€ä¹ˆé€‰æ‹©çƒ­ä¿®å¤æŠ€æœ¯æ–¹æ¡ˆï¼Ÿ"></a>æ€ä¹ˆé€‰æ‹©çƒ­ä¿®å¤æŠ€æœ¯æ–¹æ¡ˆï¼Ÿ</h1><h2 id="å›½å†…ä¸»æµçš„æŠ€æœ¯æ–¹æ¡ˆ"><a href="#å›½å†…ä¸»æµçš„æŠ€æœ¯æ–¹æ¡ˆ" class="headerlink" title="å›½å†…ä¸»æµçš„æŠ€æœ¯æ–¹æ¡ˆ"></a>å›½å†…ä¸»æµçš„æŠ€æœ¯æ–¹æ¡ˆ</h2><p> 1ã€é˜¿é‡Œç³»</p>
<table>
<thead>
<tr>
<th>åç§°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/alibaba/AndFix" target="_blank" rel="noopener">AndFix </a></td>
<td>å¼€æºï¼Œå®æ—¶ç”Ÿæ•ˆ</td>
</tr>
<tr>
<td><a href="http://baichuan.taobao.com/product/hotfix.htm?spm=a3c0d.7662652.1998907869.2.309abe485ZwUCh" target="_blank" rel="noopener">HotFix</a></td>
<td>é˜¿é‡Œç™¾å·ï¼Œæœªå¼€æºï¼Œå…è´¹ã€å®æ—¶ç”Ÿæ•ˆ</td>
</tr>
<tr>
<td><a href="https://help.aliyun.com/product/51340.html?spm=a2c4g.11186623.6.540.61a72ef2DAZ30l" target="_blank" rel="noopener">Sophix</a></td>
<td>æœªå¼€æºï¼Œå•†ä¸šæ”¶è´¹ï¼Œå®æ—¶ç”Ÿæ•ˆ/å†·å¯åŠ¨ä¿®å¤</td>
</tr>
</tbody>
</table>
<p>HotFixæ˜¯AndFixçš„ä¼˜åŒ–ç‰ˆæœ¬ï¼ŒSophixæ˜¯HotFixçš„ä¼˜åŒ–ç‰ˆæœ¬ã€‚ç›®å‰é˜¿é‡Œç³»ä¸»æ¨æ˜¯Sophixã€‚</p>
<p>2ã€è…¾è®¯ç³»</p>
<table>
<thead>
<tr>
<th>åç§°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://mp.weixin.qq.com/s?__biz=MzI1MTA1MzM2Nw==&amp;mid=400118620&amp;idx=1&amp;sn=b4fdd5055731290eef12ad0d17f39d4a" target="_blank" rel="noopener">Qzoneè¶…çº§è¡¥ä¸</a></td>
<td>QQç©ºé—´ï¼Œæœªå¼€æºï¼Œå†·å¯åŠ¨ä¿®å¤</td>
</tr>
<tr>
<td><a href="https://github.com/alexclin0188/QFixPatch" target="_blank" rel="noopener">QFix</a></td>
<td>æ‰‹Qå›¢é˜Ÿï¼Œå¼€æºï¼Œå†·å¯åŠ¨ä¿®å¤</td>
</tr>
<tr>
<td><a href="http://www.tinkerpatch.com/Docs/intro" target="_blank" rel="noopener">Tinker</a></td>
<td>å¾®ä¿¡å›¢é˜Ÿï¼Œå¼€æºï¼Œå†·å¯åŠ¨ä¿®å¤ã€‚æä¾›åˆ†å‘ç®¡ç†ï¼Œ<a href="http://www.tinkerpatch.com/Price" target="_blank" rel="noopener">åŸºç¡€ç‰ˆå…è´¹</a></td>
</tr>
</tbody>
</table>
<p>3ã€å…¶ä»–<br>åç§° | è¯´æ˜<br>â€”|â€”<br><a href="https://github.com/Meituan-Dianping/Robust" target="_blank" rel="noopener">Robust </a>|ç¾å›¢ï¼Œ å¼€æºï¼Œå®æ—¶ä¿®å¤<br><a href="https://github.com/jasonross/Nuwa" target="_blank" rel="noopener">Nuwa</a> |å¤§ä¼—ç‚¹è¯„ï¼Œå¼€æºï¼Œå†·å¯åŠ¨ä¿®å¤<br><a href="https://github.com/eleme/Amigo" target="_blank" rel="noopener">Amigo</a>|é¥¿äº†ä¹ˆï¼Œå¼€æºï¼Œå†·å¯åŠ¨ä¿®å¤</p>
<h2 id="æ–¹æ¡ˆå¯¹æ¯”"><a href="#æ–¹æ¡ˆå¯¹æ¯”" class="headerlink" title="æ–¹æ¡ˆå¯¹æ¯”"></a>æ–¹æ¡ˆå¯¹æ¯”</h2><table>
<thead>
<tr>
<th>æ–¹æ¡ˆå¯¹æ¯”</th>
<th>Sophix</th>
<th>Tinker</th>
<th>nuwa</th>
<th>AndFix</th>
<th>Robust</th>
<th>Amigo</th>
</tr>
</thead>
<tbody>
<tr>
<td>ç±»æ›¿æ¢</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>no</td>
<td>no</td>
<td>yes</td>
</tr>
<tr>
<td>Soæ›¿æ¢</td>
<td>yes</td>
<td>yes</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>yes</td>
</tr>
<tr>
<td>èµ„æºæ›¿æ¢</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>no</td>
<td>no</td>
<td>yes</td>
</tr>
<tr>
<td>å…¨å¹³å°æ”¯æŒ</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>no</td>
<td>yes</td>
<td>yes</td>
</tr>
<tr>
<td>å³æ—¶ç”Ÿæ•ˆ</td>
<td>åŒæ—¶æ”¯æŒ</td>
<td>no</td>
<td>no</td>
<td>yes</td>
<td>yes</td>
<td>no</td>
</tr>
<tr>
<td>æ€§èƒ½æŸè€—</td>
<td>è¾ƒå°‘</td>
<td>è¾ƒå°</td>
<td>è¾ƒå¤§</td>
<td>è¾ƒå°</td>
<td>è¾ƒå°</td>
<td>è¾ƒå°</td>
</tr>
<tr>
<td>è¡¥ä¸åŒ…å¤§å°</td>
<td>å°</td>
<td>è¾ƒå°</td>
<td>è¾ƒå¤§</td>
<td>ä¸€èˆ¬</td>
<td>ä¸€èˆ¬</td>
<td>è¾ƒå¤§</td>
</tr>
<tr>
<td>å¼€å‘é€æ˜</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>no</td>
<td>no</td>
<td>yes</td>
</tr>
<tr>
<td>å¤æ‚åº¦</td>
<td>å‚»ç“œå¼æ¥å…¥</td>
<td>å¤æ‚</td>
<td>è¾ƒä½</td>
<td>å¤æ‚</td>
<td>å¤æ‚</td>
<td>è¾ƒä½</td>
</tr>
<tr>
<td>Romä½“ç§¯</td>
<td>è¾ƒå°</td>
<td>Dalvikè¾ƒå¤§</td>
<td>è¾ƒå°</td>
<td>è¾ƒå°</td>
<td>è¾ƒå°</td>
<td>å¤§</td>
</tr>
<tr>
<td>æˆåŠŸç‡</td>
<td>é«˜</td>
<td>è¾ƒé«˜</td>
<td>è¾ƒé«˜</td>
<td>ä¸€èˆ¬</td>
<td>æœ€é«˜</td>
<td>è¾ƒé«˜</td>
</tr>
<tr>
<td>çƒ­åº¦</td>
<td>é«˜</td>
<td>é«˜</td>
<td>ä½</td>
<td>ä½</td>
<td>é«˜</td>
<td>ä½</td>
</tr>
<tr>
<td>å¼€æº</td>
<td>no</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
</tr>
<tr>
<td>æ”¶è´¹</td>
<td>æ”¶è´¹ï¼ˆè®¾æœ‰å…è´¹é˜ˆå€¼ï¼‰</td>
<td>æ”¶è´¹ï¼ˆåŸºç¡€ç‰ˆå…è´¹ï¼Œä½†æœ‰é™åˆ¶ï¼‰</td>
<td>å…è´¹</td>
<td>å…è´¹</td>
<td>å…è´¹</td>
<td>å…è´¹</td>
</tr>
<tr>
<td>ç›‘æ§</td>
<td>æä¾›åˆ†å‘æ§åˆ¶åŠç›‘æ§</td>
<td>æä¾›åˆ†å‘æ§åˆ¶åŠç›‘æ§</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>no</td>
</tr>
</tbody>
</table>
<blockquote>
<p>å‚è€ƒTinkeråŠSophixå®˜æ–¹å¯¹æ¯”</p>
</blockquote>
<p><a href="http://www.tinkerpatch.com/Docs/intro" target="_blank" rel="noopener">ä¸ºä»€ä¹ˆä½¿ç”¨ Tinkerï¼Ÿ</a></p>
<p><a href="https://help.aliyun.com/document_detail/51416.html?spm=a2c4g.11186623.6.543.6ed62ef2MAnXZM" target="_blank" rel="noopener">Sophixäº§å“ä¼˜åŠ¿ï¼Ÿ</a></p>
<h2 id="æ€ä¹ˆé€‰ï¼Ÿ"><a href="#æ€ä¹ˆé€‰ï¼Ÿ" class="headerlink" title="æ€ä¹ˆé€‰ï¼Ÿ"></a>æ€ä¹ˆé€‰ï¼Ÿ</h2><p>æ€ä¹ˆé€‰ï¼Ÿè¿™ä¸ªåªèƒ½è¯´ä¸€åˆ‡çœ‹éœ€æ±‚ã€‚å¦‚æœå…¬å¸ç»¼åˆå®åŠ›å¼ºï¼Œå®Œå…¨è€ƒè™‘è‡ªç ”éƒ½æ²¡é—®é¢˜ï¼Œä½†éœ€è¦ç»¼åˆè€ƒè™‘æˆæœ¬åŠç»´æŠ¤ã€‚ä¸‹é¢ç»™å‡º2ç‚¹å»ºè®®ï¼Œå¦‚ä¸‹ï¼š</p>
<p>1ã€é¡¹ç›®éœ€æ±‚</p>
<ul>
<li>åªéœ€è¦ç®€å•çš„æ–¹æ³•çº§åˆ«Bugä¿®å¤ï¼Ÿ</li>
<li>éœ€è¦èµ„æºåŠsoåº“çš„ä¿®å¤ï¼Ÿ</li>
<li>å¯¹å¹³å°å…¼å®¹æ€§è¦æ±‚åŠæˆåŠŸç‡è¦æ±‚ï¼Ÿ</li>
<li>æœ‰éœ€æ±‚å¯¹åˆ†å‘è¿›è¡Œæ§åˆ¶ï¼Œå¯¹ç›‘æ§æ•°æ®è¿›è¡Œç»Ÿè®¡ï¼Œè¡¥ä¸åŒ…è¿›è¡Œç®¡ç†ï¼Ÿ</li>
<li>å…¬å¸èµ„æºæ˜¯å¦æ”¯æŒå•†ä¸šä»˜è´¹ï¼Ÿ</li>
</ul>
<p>2ã€å­¦ä¹ åŠä½¿ç”¨æˆæœ¬</p>
<ul>
<li>é›†æˆéš¾åº¦</li>
<li>ä»£ç ä¾µå…¥æ€§</li>
<li>è°ƒè¯•ç»´æŠ¤</li>
</ul>
<p>3ã€é€‰æ‹©å¤§å‚</p>
<ul>
<li>æŠ€æœ¯æ€§èƒ½æœ‰ä¿éšœ</li>
<li>æœ‰ä¸“äººç»´æŠ¤</li>
<li>çƒ­åº¦é«˜ï¼Œå¼€æºç¤¾åŒºæ´»è·ƒ</li>
</ul>
<p>å¦‚æœè€ƒè™‘ä»˜è´¹ï¼Œæ¨èé€‰æ‹©é˜¿é‡Œçš„Sophixï¼ŒSophixæ˜¯ç»¼åˆä¼˜åŒ–çš„äº§ç‰©ï¼ŒåŠŸèƒ½å®Œå–„ã€å¼€å‘ç®€å•é€æ˜ã€æä¾›åˆ†å‘åŠç›‘æ§ç®¡ç†ã€‚</p>
<p>å¦‚æœä¸è€ƒè™‘ä»˜è´¹ï¼Œåªéœ€æ”¯æŒæ–¹æ³•çº§åˆ«çš„Bugä¿®å¤ï¼Œä¸æ”¯æŒèµ„æºåŠsoï¼Œæ¨èä½¿ç”¨Robustã€‚</p>
<p>å¦‚æœè€ƒè™‘éœ€è¦åŒæ—¶æ”¯æŒèµ„æºåŠsoï¼Œæ¨èä½¿ç”¨Tinkerã€‚</p>
<p>æœ€åå¦‚æœå…¬å¸ç»¼åˆå®åŠ›å¼ºï¼Œå¯è€ƒè™‘è‡ªç ”ï¼Œçµæ´»æ€§åŠå¯æ§åˆ¶æœ€å¼ºã€‚</p>
<blockquote>
<p>ä»Githubä¸Šçš„çƒ­åº¦åŠæäº¤è®°å½•ä¸Šçœ‹ï¼Œnuwaã€AndFixã€Amigoç­‰çš„æäº¤éƒ½æ˜¯2 years agoã€‚</p>
</blockquote>
<h1 id="å†…ä¸šä¸»è¦çƒ­ä¿®å¤æŠ€æœ¯æ–¹æ¡ˆåŸç†ï¼Ÿ"><a href="#å†…ä¸šä¸»è¦çƒ­ä¿®å¤æŠ€æœ¯æ–¹æ¡ˆåŸç†ï¼Ÿ" class="headerlink" title="å†…ä¸šä¸»è¦çƒ­ä¿®å¤æŠ€æœ¯æ–¹æ¡ˆåŸç†ï¼Ÿ"></a>å†…ä¸šä¸»è¦çƒ­ä¿®å¤æŠ€æœ¯æ–¹æ¡ˆåŸç†ï¼Ÿ</h1><h2 id="æŠ€æœ¯åˆ†ç±»"><a href="#æŠ€æœ¯åˆ†ç±»" class="headerlink" title="æŠ€æœ¯åˆ†ç±»"></a>æŠ€æœ¯åˆ†ç±»</h2><p><img src="http://upload-images.jianshu.io/upload_images/5125122-97e7a2b8568b2972?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<h2 id="NativeHook-åŸç†"><a href="#NativeHook-åŸç†" class="headerlink" title="NativeHook åŸç†"></a>NativeHook åŸç†</h2><h2 id="åŸç†åŠå®ç°"><a href="#åŸç†åŠå®ç°" class="headerlink" title="åŸç†åŠå®ç°"></a>åŸç†åŠå®ç°</h2><p>NativeHookçš„åŸç†æ˜¯ç›´æ¥åœ¨nativeå±‚è¿›è¡Œæ–¹æ³•çš„ç»“æ„ä½“ä¿¡æ¯å¯¹æ¢ï¼Œä»è€Œå®ç°å®Œç¾çš„æ–¹æ³•æ–°æ—§æ›¿æ¢ï¼Œä»è€Œå®ç°çƒ­ä¿®å¤åŠŸèƒ½ã€‚<br>ä¸‹é¢ä»¥AndFixçš„ä¸€æ®µjniä»£ç æ¥è¿›è¡Œè¯´æ˜ï¼Œå¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">void replace_6_0(JNIEnv* env, jobject src, jobject dest) &#123;</span><br><span class="line"></span><br><span class="line">    // é€šè¿‡Methodå¯¹è±¡å¾—åˆ°åº•å±‚Javaå‡½æ•°å¯¹åº”ArtMethodçš„çœŸå®åœ°å€</span><br><span class="line">	art::mirror::ArtMethod* smeth =</span><br><span class="line">			(art::mirror::ArtMethod*) env-&gt;FromReflectedMethod(src);</span><br><span class="line"></span><br><span class="line">	art::mirror::ArtMethod* dmeth =</span><br><span class="line">			(art::mirror::ArtMethod*) env-&gt;FromReflectedMethod(dest);</span><br><span class="line"></span><br><span class="line">    reinterpret_cast&lt;art::mirror::Class*&gt;(dmeth-&gt;declaring_class_)-&gt;class_loader_ =</span><br><span class="line">    reinterpret_cast&lt;art::mirror::Class*&gt;(smeth-&gt;declaring_class_)-&gt;class_loader_; //for plugin classloader</span><br><span class="line">    reinterpret_cast&lt;art::mirror::Class*&gt;(dmeth-&gt;declaring_class_)-&gt;clinit_thread_id_ =</span><br><span class="line">    reinterpret_cast&lt;art::mirror::Class*&gt;(smeth-&gt;declaring_class_)-&gt;clinit_thread_id_;</span><br><span class="line">    reinterpret_cast&lt;art::mirror::Class*&gt;(dmeth-&gt;declaring_class_)-&gt;status_ = reinterpret_cast&lt;art::mirror::Class*&gt;(smeth-&gt;declaring_class_)-&gt;status_-1;</span><br><span class="line">    //for reflection invoke</span><br><span class="line">    reinterpret_cast&lt;art::mirror::Class*&gt;(dmeth-&gt;declaring_class_)-&gt;super_class_ = 0;</span><br><span class="line">    //æŠŠæ—§å‡½æ•°çš„æ‰€æœ‰æˆå‘˜å˜é‡éƒ½æ›¿æ¢ä¸ºæ–°å‡½æ•°çš„</span><br><span class="line">    smeth-&gt;declaring_class_ = dmeth-&gt;declaring_class_;</span><br><span class="line">    smeth-&gt;dex_cache_resolved_methods_ = dmeth-&gt;dex_cache_resolved_methods_;</span><br><span class="line">    smeth-&gt;dex_cache_resolved_types_ = dmeth-&gt;dex_cache_resolved_types_;</span><br><span class="line">    smeth-&gt;access_flags_ = dmeth-&gt;access_flags_ | 0x0001;</span><br><span class="line">    smeth-&gt;dex_code_item_offset_ = dmeth-&gt;dex_code_item_offset_;</span><br><span class="line">    smeth-&gt;dex_method_index_ = dmeth-&gt;dex_method_index_;</span><br><span class="line">    smeth-&gt;method_index_ = dmeth-&gt;method_index_;</span><br><span class="line">    </span><br><span class="line">    smeth-&gt;ptr_sized_fields_.entry_point_from_interpreter_ =</span><br><span class="line">    dmeth-&gt;ptr_sized_fields_.entry_point_from_interpreter_;</span><br><span class="line">    </span><br><span class="line">    smeth-&gt;ptr_sized_fields_.entry_point_from_jni_ =</span><br><span class="line">    dmeth-&gt;ptr_sized_fields_.entry_point_from_jni_;</span><br><span class="line">    smeth-&gt;ptr_sized_fields_.entry_point_from_quick_compiled_code_ =</span><br><span class="line">    dmeth-&gt;ptr_sized_fields_.entry_point_from_quick_compiled_code_;</span><br><span class="line">    </span><br><span class="line">    LOGD(&quot;replace_6_0: %d , %d&quot;,</span><br><span class="line">         smeth-&gt;ptr_sized_fields_.entry_point_from_quick_compiled_code_,</span><br><span class="line">         dmeth-&gt;ptr_sized_fields_.entry_point_from_quick_compiled_code_);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void setFieldFlag_6_0(JNIEnv* env, jobject field) &#123;</span><br><span class="line">	art::mirror::ArtField* artField =</span><br><span class="line">			(art::mirror::ArtField*) env-&gt;FromReflectedField(field);</span><br><span class="line">	artField-&gt;access_flags_ = artField-&gt;access_flags_ &amp; (~0x0002) | 0x0001;</span><br><span class="line">	LOGD(&quot;setFieldFlag_6_0: %d &quot;, artField-&gt;access_flags_);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>æ¯ä¸€ä¸ªJavaæ–¹æ³•åœ¨artä¸­éƒ½å¯¹åº”ä¸€ä¸ªArtMethod,ArtMethodè®°å½•äº†è¿™ä¸ªJavaæ–¹æ³•çš„æ‰€æœ‰ä¿¡æ¯ï¼ŒåŒ…æ‹¬è®¿é—®æƒé™åŠä»£ç æ‰§è¡Œåœ°å€ç­‰ã€‚é€šè¿‡env-&gt;FromReflectedMethodå¾—åˆ°æ–¹æ³•å¯¹åº”çš„ArtMethodçš„çœŸæ­£å¼€å§‹åœ°å€ï¼Œç„¶åå¼ºè½¬ä¸ºArtMethodæŒ‡é’ˆï¼Œä»è€Œå¯¹å…¶æ‰€æœ‰æˆå‘˜è¿›è¡Œä¿®æ”¹ã€‚</p>
<p>è¿™æ ·ä»¥åè°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶å°±ä¼šç›´æ¥èµ°åˆ°æ–°æ–¹æ³•çš„å®ç°ä¸­ï¼Œè¾¾åˆ°çƒ­ä¿®å¤çš„æ•ˆæœã€‚</p>
<h2 id="ä¼˜ç¼ºç‚¹"><a href="#ä¼˜ç¼ºç‚¹" class="headerlink" title="ä¼˜ç¼ºç‚¹"></a>ä¼˜ç¼ºç‚¹</h2><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul>
<li>å³æ—¶ç”Ÿæ•ˆ</li>
<li>æ²¡æœ‰æ€§èƒ½å¼€é”€ï¼Œä¸éœ€è¦ä»»ä½•ç¼–è¾‘å™¨çš„æ’æ¡©æˆ–ä»£ç æ”¹å†™</li>
</ul>
<h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul>
<li>å­˜åœ¨ç¨³å®šåŠå…¼å®¹æ€§é—®é¢˜ã€‚ArtMethodçš„ç»“æ„åŸºæœ¬å‚è€ƒGoogleå¼€æºçš„ä»£ç ï¼Œå„å¤§å‚å•†çš„ROMéƒ½å¯èƒ½æœ‰æ‰€æ”¹åŠ¨ï¼Œå¯èƒ½å¯¼è‡´ç»“æ„ä¸ä¸€è‡´ï¼Œä¿®å¤å¤±è´¥ã€‚</li>
<li>æ— æ³•å¢åŠ å˜é‡åŠç±»ï¼Œåªèƒ½ä¿®å¤æ–¹æ³•çº§åˆ«çš„Bugï¼Œæ— æ³•åšåˆ°æ–°åŠŸèƒ½çš„å‘å¸ƒ</li>
</ul>
<h2 id="javaHook-åŸç†"><a href="#javaHook-åŸç†" class="headerlink" title="javaHook åŸç†"></a>javaHook åŸç†</h2><h2 id="åŸç†åŠå®ç°-1"><a href="#åŸç†åŠå®ç°-1" class="headerlink" title="åŸç†åŠå®ç°"></a>åŸç†åŠå®ç°</h2><p>ä»¥ç¾å›¢çš„Robustä¸ºä¾‹ï¼ŒRobust çš„åŸç†å¯ä»¥ç®€å•æè¿°ä¸ºï¼š</p>
<p>1ã€æ‰“åŸºç¡€åŒ…æ—¶æ’æ¡©ï¼Œåœ¨æ¯ä¸ªæ–¹æ³•å‰æ’å…¥ä¸€æ®µç±»å‹ä¸º ChangeQuickRedirect é™æ€å˜é‡çš„é€»è¾‘ï¼Œæ’å…¥è¿‡ç¨‹å¯¹ä¸šåŠ¡å¼€å‘æ˜¯å®Œå…¨é€æ˜</p>
<p>2ã€åŠ è½½è¡¥ä¸æ—¶ï¼Œä»è¡¥ä¸åŒ…ä¸­è¯»å–è¦æ›¿æ¢çš„ç±»åŠå…·ä½“æ›¿æ¢çš„æ–¹æ³•å®ç°ï¼Œæ–°å»ºClassLoaderåŠ è½½è¡¥ä¸dexã€‚å½“changeQuickRedirectä¸ä¸ºnullæ—¶ï¼Œå¯èƒ½ä¼šæ‰§è¡Œåˆ°accessDispatchä»è€Œæ›¿æ¢æ‰ä¹‹å‰è€çš„é€»è¾‘ï¼Œè¾¾åˆ°fixçš„ç›®çš„</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5125122-fc799bbd4a587560.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Robust å®˜æ–¹ä»‹ç»ç¤ºä¾‹å›¾"></p>
<p>ä¸‹é¢é€šè¿‡Robustçš„æºç æ¥è¿›è¡Œåˆ†æã€‚<br>é¦–å…ˆçœ‹ä¸€ä¸‹æ‰“åŸºç¡€åŒ…æ˜¯æ’å…¥çš„ä»£ç é€»è¾‘ï¼Œå¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public static ChangeQuickRedirect u;</span><br><span class="line">protected void onCreate(Bundle bundle) &#123;</span><br><span class="line">        //ä¸ºæ¯ä¸ªæ–¹æ³•è‡ªåŠ¨æ’å…¥ä¿®å¤é€»è¾‘ä»£ç ï¼Œå¦‚æœChangeQuickRedirectä¸ºç©ºåˆ™ä¸æ‰§è¡Œ</span><br><span class="line">        if (u != null) &#123;</span><br><span class="line">            if (PatchProxy.isSupport(new Object[]&#123;bundle&#125;, this, u, false, 78)) &#123;</span><br><span class="line">                PatchProxy.accessDispatchVoid(new Object[]&#123;bundle&#125;, this, u, false, 78);</span><br><span class="line">                return;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        super.onCreate(bundle);</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p>Robustçš„æ ¸å¿ƒä¿®å¤æºç å¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">public class PatchExecutor extends Thread &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        ...</span><br><span class="line">        applyPatchList(patches);</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">    /**</span><br><span class="line">     * åº”ç”¨è¡¥ä¸åˆ—è¡¨</span><br><span class="line">     */</span><br><span class="line">    protected void applyPatchList(List&lt;Patch&gt; patches) &#123;</span><br><span class="line">        ...</span><br><span class="line">        for (Patch p : patches) &#123;</span><br><span class="line">            ...</span><br><span class="line">            currentPatchResult = patch(context, p);</span><br><span class="line">            ...</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">     /**</span><br><span class="line">     * æ ¸å¿ƒä¿®å¤æºç </span><br><span class="line">     */</span><br><span class="line">    protected boolean patch(Context context, Patch patch) &#123;</span><br><span class="line">        ...</span><br><span class="line">        //æ–°å»ºClassLoader</span><br><span class="line">        DexClassLoader classLoader = new DexClassLoader(patch.getTempPath(), context.getCacheDir().getAbsolutePath(),</span><br><span class="line">                null, PatchExecutor.class.getClassLoader());</span><br><span class="line">        patch.delete(patch.getTempPath());</span><br><span class="line">        ...</span><br><span class="line">        try &#123;</span><br><span class="line">            patchsInfoClass = classLoader.loadClass(patch.getPatchesInfoImplClassFullName());</span><br><span class="line">            patchesInfo = (PatchesInfo) patchsInfoClass.newInstance();</span><br><span class="line">            &#125; catch (Throwable t) &#123;</span><br><span class="line">             ...</span><br><span class="line">        &#125;</span><br><span class="line">        ...</span><br><span class="line">        //é€šè¿‡éå†å…¶ä¸­çš„ç±»ä¿¡æ¯è¿›è€Œåå°„ä¿®æ”¹å…¶ä¸­ ChangeQuickRedirect å¯¹è±¡çš„å€¼</span><br><span class="line">        for (PatchedClassInfo patchedClassInfo : patchedClasses) &#123;</span><br><span class="line">            ...</span><br><span class="line">            try &#123;</span><br><span class="line">                oldClass = classLoader.loadClass(patchedClassName.trim());</span><br><span class="line">                Field[] fields = oldClass.getDeclaredFields();</span><br><span class="line">                for (Field field : fields) &#123;</span><br><span class="line">                    if (TextUtils.equals(field.getType().getCanonicalName(), ChangeQuickRedirect.class.getCanonicalName()) &amp;&amp; TextUtils.equals(field.getDeclaringClass().getCanonicalName(), oldClass.getCanonicalName())) &#123;</span><br><span class="line">                        changeQuickRedirectField = field;</span><br><span class="line">                        break;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                ...</span><br><span class="line">                try &#123;</span><br><span class="line">                    patchClass = classLoader.loadClass(patchClassName);</span><br><span class="line">                    Object patchObject = patchClass.newInstance();</span><br><span class="line">                    changeQuickRedirectField.setAccessible(true);</span><br><span class="line">                    changeQuickRedirectField.set(null, patchObject);</span><br><span class="line">                    &#125; catch (Throwable t) &#123;</span><br><span class="line">                    ...</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; catch (Throwable t) &#123;</span><br><span class="line">                 ...</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="ä¼˜ç¼ºç‚¹-1"><a href="#ä¼˜ç¼ºç‚¹-1" class="headerlink" title="ä¼˜ç¼ºç‚¹"></a>ä¼˜ç¼ºç‚¹</h2><h3 id="ä¼˜ç‚¹-1"><a href="#ä¼˜ç‚¹-1" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul>
<li>é«˜å…¼å®¹æ€§ï¼ˆRobuståªæ˜¯åœ¨æ­£å¸¸çš„ä½¿ç”¨DexClassLoaderï¼‰ã€é«˜ç¨³å®šæ€§ï¼Œä¿®å¤æˆåŠŸç‡é«˜è¾¾99.9%</li>
<li>è¡¥ä¸å®æ—¶ç”Ÿæ•ˆï¼Œä¸éœ€è¦é‡æ–°å¯åŠ¨</li>
<li>æ”¯æŒæ–¹æ³•çº§åˆ«çš„ä¿®å¤ï¼ŒåŒ…æ‹¬é™æ€æ–¹æ³•</li>
<li>æ”¯æŒå¢åŠ æ–¹æ³•å’Œç±»</li>
<li>æ”¯æŒProGuardçš„æ··æ·†ã€å†…è”ã€ä¼˜åŒ–ç­‰æ“ä½œ</li>
</ul>
<h3 id="ç¼ºç‚¹-1"><a href="#ç¼ºç‚¹-1" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul>
<li>ä»£ç æ˜¯ä¾µå…¥å¼çš„ï¼Œä¼šåœ¨åŸæœ‰çš„ç±»ä¸­åŠ å…¥ç›¸å…³ä»£ç </li>
<li>soå’Œèµ„æºçš„æ›¿æ¢æš‚æ—¶ä¸æ”¯æŒ</li>
<li>ä¼šå¢å¤§apkçš„ä½“ç§¯ï¼Œå¹³å‡ä¸€ä¸ªå‡½æ•°ä¼šæ¯”åŸæ¥å¢åŠ 17.47ä¸ªå­—èŠ‚ï¼Œ10ä¸‡ä¸ªå‡½æ•°ä¼šå¢åŠ 1.67M</li>
</ul>
<h2 id="java-mulitdex-åŸç†"><a href="#java-mulitdex-åŸç†" class="headerlink" title="java mulitdex åŸç†"></a>java mulitdex åŸç†</h2><h2 id="åŸç†åŠå®ç°-2"><a href="#åŸç†åŠå®ç°-2" class="headerlink" title="åŸç†åŠå®ç°"></a>åŸç†åŠå®ç°</h2><p>Androidå†…éƒ¨ä½¿ç”¨çš„æ˜¯BaseDexClassLoaderã€PathClassLoaderã€DexClassLoaderä¸‰ä¸ªç±»åŠ è½½å™¨å®ç°ä»DEXæ–‡ä»¶ä¸­è¯»å–ç±»æ•°æ®ï¼Œå…¶ä¸­PathClassLoaderå’ŒDexClassLoaderéƒ½æ˜¯ç»§æ‰¿è‡ªBaseDexClassLoaderå®ç°ã€‚dexæ–‡ä»¶è½¬æ¢æˆdexFileå¯¹è±¡ï¼Œå­˜å…¥Element[]æ•°ç»„ï¼Œfindclassé¡ºåºéå†Elementæ•°ç»„è·å–DexFileï¼Œç„¶åæ‰§è¡ŒDexFileçš„findclassã€‚æºç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">// åŠ è½½åå­—ä¸ºnameçš„classå¯¹è±¡</span><br><span class="line">public Class findClass(String name, List&lt;Throwable&gt; suppressed) &#123;</span><br><span class="line">    // éå†ä»dexPathæŸ¥è¯¢åˆ°çš„dexå’Œèµ„æºElement</span><br><span class="line">    for (Element element : dexElements) &#123;</span><br><span class="line">        DexFile dex = element.dexFile;</span><br><span class="line">        // å¦‚æœå½“å‰çš„Elementæ˜¯dexæ–‡ä»¶å…ƒç´ </span><br><span class="line">        if (dex != null) &#123;</span><br><span class="line">            // ä½¿ç”¨DexFile.loadClassBinaryNameåŠ è½½ç±»</span><br><span class="line">            Class clazz = dex.loadClassBinaryName(name, definingContext, suppressed);</span><br><span class="line">            if (clazz != null) &#123;</span><br><span class="line">                return clazz;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if (dexElementsSuppressedExceptions != null) &#123;</span><br><span class="line">        suppressed.addAll(Arrays.asList(dexElementsSuppressedExceptions));</span><br><span class="line">    &#125;</span><br><span class="line">    return null;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥æ­¤æ–¹æ¡ˆçš„åŸç†æ˜¯Hookäº†ClassLoader.pathList.dexElements[]ï¼Œå°†è¡¥ä¸çš„dexæ’å…¥åˆ°æ•°ç»„çš„æœ€å‰ç«¯ã€‚å› ä¸ºClassLoaderçš„findClassæ˜¯é€šè¿‡éå†dexElements[]ä¸­çš„dexæ¥å¯»æ‰¾ç±»çš„ã€‚æ‰€ä»¥ä¼šä¼˜å…ˆæŸ¥æ‰¾åˆ°ä¿®å¤çš„ç±»ã€‚ä»è€Œè¾¾åˆ°ä¿®å¤çš„æ•ˆæœã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/5125122-07be03be319158d1?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å›¾ç‰‡å¼•ç”¨è‡ªQQç©ºé—´çƒ­ä¿®å¤ä»‹ç»"></p>
<p>ä¸‹é¢ä½¿ç”¨Nuwaçš„å…³é”®å®ç°æºç è¿›è¡Œè¯´æ˜å¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">public static void injectDexAtFirst(String dexPath, String defaultDexOptPath) throws NoSuchFieldException, IllegalAccessException, ClassNotFoundException &#123;</span><br><span class="line">        //æ–°å»ºä¸€ä¸ªClassLoaderåŠ è½½è¡¥ä¸Dex</span><br><span class="line">        DexClassLoader dexClassLoader = new DexClassLoader(dexPath, defaultDexOptPath, dexPath, getPathClassLoader());</span><br><span class="line">        //åå°„è·å–æ—§DexElementsæ•°ç»„</span><br><span class="line">        Object baseDexElements = getDexElements(getPathList(getPathClassLoader()));</span><br><span class="line">        //åå°„è·å–è¡¥ä¸DexElementsæ•°ç»„</span><br><span class="line">        Object newDexElements = getDexElements(getPathList(dexClassLoader));</span><br><span class="line">        //åˆå¹¶ï¼Œå°†æ–°æ•°ç»„çš„Elementæ’å…¥åˆ°æœ€å‰é¢</span><br><span class="line">        Object allDexElements = combineArray(newDexElements, baseDexElements);</span><br><span class="line">        Object pathList = getPathList(getPathClassLoader());</span><br><span class="line">        //æ›´æ–°æ—§ClassLoaderä¸­çš„Elementæ•°ç»„</span><br><span class="line">        ReflectionUtils.setField(pathList, pathList.getClass(), &quot;dexElements&quot;, allDexElements);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static PathClassLoader getPathClassLoader() &#123;</span><br><span class="line">        PathClassLoader pathClassLoader = (PathClassLoader) DexUtils.class.getClassLoader();</span><br><span class="line">        return pathClassLoader;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static Object getDexElements(Object paramObject)</span><br><span class="line">            throws IllegalArgumentException, NoSuchFieldException, IllegalAccessException &#123;</span><br><span class="line">        return ReflectionUtils.getField(paramObject, paramObject.getClass(), &quot;dexElements&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static Object getPathList(Object baseDexClassLoader)</span><br><span class="line">            throws IllegalArgumentException, NoSuchFieldException, IllegalAccessException, ClassNotFoundException &#123;</span><br><span class="line">        return ReflectionUtils.getField(baseDexClassLoader, Class.forName(&quot;dalvik.system.BaseDexClassLoader&quot;), &quot;pathList&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static Object combineArray(Object firstArray, Object secondArray) &#123;</span><br><span class="line">        Class&lt;?&gt; localClass = firstArray.getClass().getComponentType();</span><br><span class="line">        int firstArrayLength = Array.getLength(firstArray);</span><br><span class="line">        int allLength = firstArrayLength + Array.getLength(secondArray);</span><br><span class="line">        Object result = Array.newInstance(localClass, allLength);</span><br><span class="line">        for (int k = 0; k &lt; allLength; ++k) &#123;</span><br><span class="line">            if (k &lt; firstArrayLength) &#123;</span><br><span class="line">                Array.set(result, k, Array.get(firstArray, k));</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                Array.set(result, k, Array.get(secondArray, k - firstArrayLength));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return result;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="ä¼˜ç¼ºç‚¹-2"><a href="#ä¼˜ç¼ºç‚¹-2" class="headerlink" title="ä¼˜ç¼ºç‚¹"></a>ä¼˜ç¼ºç‚¹</h2><h3 id="ä¼˜ç‚¹-2"><a href="#ä¼˜ç‚¹-2" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul>
<li>ä¸éœ€è¦è€ƒè™‘å¯¹dalvikè™šæ‹Ÿæœºå’Œartè™šæ‹Ÿæœºåšé€‚é…</li>
<li>ä»£ç æ˜¯éä¾µå…¥å¼çš„ï¼Œå¯¹apkä½“ç§¯å½±å“ä¸å¤§</li>
</ul>
<h3 id="ç¼ºç‚¹-2"><a href="#ç¼ºç‚¹-2" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul>
<li>éœ€è¦ä¸‹æ¬¡å¯åŠ¨æ‰ä¿®å¤</li>
<li>æ€§èƒ½æŸè€—å¤§ï¼Œä¸ºäº†é¿å…ç±»è¢«åŠ ä¸ŠCLASS_ISPREVERIFIEDï¼Œä½¿ç”¨æ’æ¡©ï¼Œå•ç‹¬æ”¾ä¸€ä¸ªå¸®åŠ©ç±»åœ¨ç‹¬ç«‹çš„dexä¸­è®©å…¶ä»–ç±»è°ƒç”¨ã€‚</li>
</ul>
<h2 id="dexæ›¿æ¢"><a href="#dexæ›¿æ¢" class="headerlink" title="dexæ›¿æ¢"></a>dexæ›¿æ¢</h2><h2 id="åŸç†åŠå®ç°-3"><a href="#åŸç†åŠå®ç°-3" class="headerlink" title="åŸç†åŠå®ç°"></a>åŸç†åŠå®ç°</h2><p>ä¸ºäº†é¿å…dexæ’æ¡©å¸¦æ¥çš„æ€§èƒ½æŸè€—ï¼Œdexæ›¿æ¢é‡‡å–å¦å¤–çš„æ–¹å¼ã€‚åŸç†æ˜¯æä¾›dexå·®é‡åŒ…ï¼Œæ•´ä½“æ›¿æ¢dexçš„æ–¹æ¡ˆã€‚å·®é‡çš„æ–¹å¼ç»™å‡ºpatch.dexï¼Œç„¶åå°†patch.dexä¸åº”ç”¨çš„classes.dexåˆå¹¶æˆä¸€ä¸ªå®Œæ•´çš„dexï¼Œå®Œæ•´dexåŠ è½½å¾—åˆ°dexFileå¯¹è±¡ä½œä¸ºå‚æ•°æ„å»ºä¸€ä¸ªElementå¯¹è±¡ç„¶åæ•´ä½“æ›¿æ¢æ‰æ—§çš„dex-Elementsæ•°ç»„ã€‚</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5125122-7026bc1d835a9f3d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å›¾ç‰‡å¼•ç”¨è‡ªTInkerä»‹ç»"><br>)</p>
<p>è¿™ä¹Ÿæ˜¯å¾®ä¿¡Tinkeré‡‡ç”¨çš„æ–¹æ¡ˆï¼Œå¹¶ä¸”Tinkerè‡ªç ”äº†DexDiff/DexMergeç®—æ³•ã€‚Tinkerè¿˜æ”¯æŒèµ„æºå’ŒSoåŒ…çš„æ›´æ–°ï¼ŒSoè¡¥ä¸åŒ…ä½¿ç”¨BsDiffæ¥ç”Ÿæˆï¼Œèµ„æºè¡¥ä¸åŒ…ç›´æ¥ä½¿ç”¨æ–‡ä»¶md5å¯¹æ¯”æ¥ç”Ÿæˆï¼Œé’ˆå¯¹èµ„æºæ¯”è¾ƒå¤§çš„ï¼ˆé»˜è®¤å¤§äº100KBå±äºå¤§æ–‡ä»¶ï¼‰ä¼šä½¿ç”¨BsDiffæ¥å¯¹æ–‡ä»¶ç”Ÿæˆå·®é‡è¡¥ä¸ã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬å…³é”®çœ‹çœ‹Tinkerçš„å®ç°æºç ï¼Œå½“ç„¶å…·ä½“çš„å®ç°ç®—æ³•å¾ˆå¤æ‚ï¼Œæˆ‘ä»¬åªçœ‹å…³é”®çš„å®ç°ï¼Œæœ€åçš„ä¿®å¤åœ¨UpgradePatchä¸­çš„tryPatchæ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">  public boolean tryPatch(Context context, String tempPatchPath, PatchResult patchResult) &#123;</span><br><span class="line">      //çœç•¥ä¸€å †æ ¡éªŒ</span><br><span class="line">      ... ....</span><br><span class="line"></span><br><span class="line">      //ä¸‹é¢æ˜¯å…³é”®çš„diffç®—æ³•åŠåˆå¹¶å®ç°ï¼Œå®ç°ç›¸å¯¹å¤æ‚ï¼Œæ„Ÿå…´è¶£å¯ä»¥å†ä»”ç»†é˜…è¯»æºç </span><br><span class="line">      //we use destPatchFile instead of patchFile, because patchFile may be deleted during the patch process</span><br><span class="line">      if (!DexDiffPatchInternal.tryRecoverDexFiles(manager, signatureCheck, context, patchVersionDirectory, destPatchFile)) &#123;</span><br><span class="line">          TinkerLog.e(TAG, &quot;UpgradePatch tryPatch:new patch recover, try patch dex failed&quot;);</span><br><span class="line">          return false;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      if (!BsDiffPatchInternal.tryRecoverLibraryFiles(manager, signatureCheck, context, patchVersionDirectory, destPatchFile)) &#123;</span><br><span class="line">          TinkerLog.e(TAG, &quot;UpgradePatch tryPatch:new patch recover, try patch library failed&quot;);</span><br><span class="line">          return false;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      if (!ResDiffPatchInternal.tryRecoverResourceFiles(manager, signatureCheck, context, patchVersionDirectory, destPatchFile)) &#123;</span><br><span class="line">          TinkerLog.e(TAG, &quot;UpgradePatch tryPatch:new patch recover, try patch resource failed&quot;);</span><br><span class="line">          return false;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      // check dex opt file at last, some phone such as VIVO/OPPO like to change dex2oat to interpreted</span><br><span class="line">      if (!DexDiffPatchInternal.waitAndCheckDexOptFile(patchFile, manager)) &#123;</span><br><span class="line">          TinkerLog.e(TAG, &quot;UpgradePatch tryPatch:new patch recover, check dex opt file failed&quot;);</span><br><span class="line">          return false;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      if (!SharePatchInfo.rewritePatchInfoFileWithLock(patchInfoFile, newInfo, patchInfoLockFile)) &#123;</span><br><span class="line">          TinkerLog.e(TAG, &quot;UpgradePatch tryPatch:new patch recover, rewrite patch info failed&quot;);</span><br><span class="line">          manager.getPatchReporter().onPatchInfoCorrupted(patchFile, newInfo.oldVersion, newInfo.newVersion);</span><br><span class="line">          return false;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      TinkerLog.w(TAG, &quot;UpgradePatch tryPatch: done, it is ok&quot;);</span><br><span class="line">      return true;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="ä¼˜ç¼ºç‚¹-3"><a href="#ä¼˜ç¼ºç‚¹-3" class="headerlink" title="ä¼˜ç¼ºç‚¹"></a>ä¼˜ç¼ºç‚¹</h2><h3 id="ä¼˜ç‚¹-3"><a href="#ä¼˜ç‚¹-3" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul>
<li>å…¼å®¹æ€§é«˜</li>
<li>è¡¥ä¸å°</li>
<li>å¼€å‘é€æ˜ï¼Œä»£ç éä¾µå…¥å¼</li>
</ul>
<h3 id="ç¼ºç‚¹-3"><a href="#ç¼ºç‚¹-3" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul>
<li>å†·å¯åŠ¨ä¿®å¤ï¼Œä¸‹æ¬¡å¯åŠ¨ä¿®å¤</li>
<li>Dexåˆå¹¶å†…å­˜æ¶ˆè€—åœ¨vm headä¸Šï¼Œå®¹æ˜“OOMï¼Œæœ€åå¯¼è‡´åˆå¹¶å¤±è´¥</li>
</ul>
<h2 id="èµ„æºä¿®å¤åŸç†"><a href="#èµ„æºä¿®å¤åŸç†" class="headerlink" title="èµ„æºä¿®å¤åŸç†"></a>èµ„æºä¿®å¤åŸç†</h2><h3 id="Instant-Run"><a href="#Instant-Run" class="headerlink" title="Instant Run"></a>Instant Run</h3><p>1ã€æ„å»ºä¸€ä¸ªæ–°çš„AssetManagerï¼Œå¹¶é€šè¿‡åå°„è°ƒç”¨addAssertPathï¼ŒæŠŠè¿™ä¸ªå®Œæ•´çš„æ–°èµ„æºåŒ…åŠ å…¥åˆ°AssetManagerä¸­ã€‚è¿™æ ·å°±å¾—åˆ°ä¸€ä¸ªå«æœ‰æ‰€æœ‰æ–°èµ„æºçš„AssetManager</p>
<p>2ã€æ‰¾åˆ°æ‰€æœ‰å€¼é’±å¼•ç”¨åˆ°åŸæœ‰AssetManagerçš„åœ°æ–¹ï¼Œé€šè¿‡åå°„ï¼ŒæŠŠå¼•ç”¨å¤„æ›¿æ¢ä¸ºAssetManager</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line">public static void monkeyPatchExistingResources(Context context,</span><br><span class="line">                                                   String externalResourceFile, Collection activities) &#123;</span><br><span class="line">       if (externalResourceFile == null) &#123;</span><br><span class="line">           return;</span><br><span class="line">       &#125;</span><br><span class="line">       try &#123;</span><br><span class="line">           //åå°„ä¸€ä¸ªæ–°çš„   AssetManager</span><br><span class="line">           AssetManager newAssetManager = (AssetManager) AssetManager.class</span><br><span class="line">                   .getConstructor(new Class[0]).newInstance(new Object[0]);</span><br><span class="line">          //åå°„ addAssetPath æ·»åŠ æ–°çš„èµ„æºåŒ…</span><br><span class="line">           Method mAddAssetPath = AssetManager.class.getDeclaredMethod(&quot;addAssetPath&quot;, new Class[]&#123;String.class&#125;);</span><br><span class="line">           mAddAssetPath.setAccessible(true);</span><br><span class="line">           if (((Integer) mAddAssetPath.invoke(newAssetManager,</span><br><span class="line">                   new Object[]&#123;externalResourceFile&#125;)).intValue() == 0) &#123;</span><br><span class="line">               throw new IllegalStateException(</span><br><span class="line">                       &quot;Could not create new AssetManager&quot;);</span><br><span class="line">           &#125;</span><br><span class="line">           Method mEnsureStringBlocks = AssetManager.class.getDeclaredMethod(&quot;ensureStringBlocks&quot;, new Class[0]);</span><br><span class="line">           mEnsureStringBlocks.setAccessible(true);</span><br><span class="line">           mEnsureStringBlocks.invoke(newAssetManager, new Object[0]);</span><br><span class="line">           //åå°„å¾—åˆ°Activityä¸­AssetManagerçš„å¼•ç”¨å¤„ï¼Œå…¨éƒ¨æ¢æˆåˆšæ–°æ„å»ºçš„AssetManagerå¯¹è±¡</span><br><span class="line">           if (activities != null) &#123;</span><br><span class="line">               for (Activity activity : activities) &#123;</span><br><span class="line">                   Resources resources = activity.getResources();</span><br><span class="line">                   try &#123;</span><br><span class="line">                       Field mAssets = Resources.class.getDeclaredField(&quot;mAssets&quot;);</span><br><span class="line">                       mAssets.setAccessible(true);</span><br><span class="line">                       mAssets.set(resources, newAssetManager);</span><br><span class="line">                   &#125; catch (Throwable ignore) &#123;</span><br><span class="line">                       Field mResourcesImpl = Resources.class.getDeclaredField(&quot;mResourcesImpl&quot;);</span><br><span class="line">                       mResourcesImpl.setAccessible(true);</span><br><span class="line">                       Object resourceImpl = mResourcesImpl.get(resources);</span><br><span class="line">                       Field implAssets = resourceImpl.getClass().getDeclaredField(&quot;mAssets&quot;);</span><br><span class="line">                       implAssets.setAccessible(true);</span><br><span class="line">                       implAssets.set(resourceImpl, newAssetManager);</span><br><span class="line">                   &#125;</span><br><span class="line">                   Resources.Theme theme = activity.getTheme();</span><br><span class="line">                   try &#123;</span><br><span class="line">                       try &#123;</span><br><span class="line">                           Field ma = Resources.Theme.class.getDeclaredField(&quot;mAssets&quot;);</span><br><span class="line">                           ma.setAccessible(true);</span><br><span class="line">                           ma.set(theme, newAssetManager);</span><br><span class="line">                       &#125; catch (NoSuchFieldException ignore) &#123;</span><br><span class="line">                           Field themeField = Resources.Theme.class.getDeclaredField(&quot;mThemeImpl&quot;);</span><br><span class="line">                           themeField.setAccessible(true);</span><br><span class="line">                           Object impl = themeField.get(theme);</span><br><span class="line">                           Field ma = impl.getClass().getDeclaredField(&quot;mAssets&quot;);</span><br><span class="line">                           ma.setAccessible(true);</span><br><span class="line">                           ma.set(impl, newAssetManager);</span><br><span class="line">                       &#125;</span><br><span class="line">                       Field mt = ContextThemeWrapper.class.getDeclaredField(&quot;mTheme&quot;);</span><br><span class="line">                       mt.setAccessible(true);</span><br><span class="line">                       mt.set(activity, null);</span><br><span class="line">                       Method mtm = ContextThemeWrapper.class.getDeclaredMethod(&quot;initializeTheme&quot;, new Class[0]);</span><br><span class="line">                       mtm.setAccessible(true);</span><br><span class="line">                       mtm.invoke(activity, new Object[0]);</span><br><span class="line">                       Method mCreateTheme = AssetManager.class.getDeclaredMethod(&quot;createTheme&quot;, new Class[0]);</span><br><span class="line">                       mCreateTheme.setAccessible(true);</span><br><span class="line">                       Object internalTheme = mCreateTheme.invoke(newAssetManager, new Object[0]);</span><br><span class="line">                       Field mTheme = Resources.Theme.class.getDeclaredField(&quot;mTheme&quot;);</span><br><span class="line">                       mTheme.setAccessible(true);</span><br><span class="line">                       mTheme.set(theme, internalTheme);</span><br><span class="line">                   &#125; catch (Throwable e) &#123;</span><br><span class="line">                       Log.e(&quot;InstantRun&quot;,</span><br><span class="line">                               &quot;Failed to update existing theme for activity &quot;</span><br><span class="line">                                       + activity, e);</span><br><span class="line">                   &#125;</span><br><span class="line">                   pruneResourceCaches(resources);</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">           Collection references;</span><br><span class="line">           if (Build.VERSION.SDK_INT &gt;= 19) &#123;</span><br><span class="line">               Class resourcesManagerClass = Class.forName(&quot;android.app.ResourcesManager&quot;);</span><br><span class="line">               Method mGetInstance = resourcesManagerClass.getDeclaredMethod(&quot;getInstance&quot;, new Class[0]);</span><br><span class="line">               mGetInstance.setAccessible(true);</span><br><span class="line">               Object resourcesManager = mGetInstance.invoke(null, new Object[0]);</span><br><span class="line">               try &#123;</span><br><span class="line">                   Field fMActiveResources = resourcesManagerClass.getDeclaredField(&quot;mActiveResources&quot;);</span><br><span class="line">                   fMActiveResources.setAccessible(true);</span><br><span class="line">                   ArrayMap  arrayMap = (ArrayMap) fMActiveResources.get(resourcesManager);</span><br><span class="line">                   references = arrayMap.values();</span><br><span class="line">               &#125; catch (NoSuchFieldException ignore) &#123;</span><br><span class="line">                   Field mResourceReferences = resourcesManagerClass.getDeclaredField(&quot;mResourceReferences&quot;);</span><br><span class="line">                   mResourceReferences.setAccessible(true);</span><br><span class="line">                   references = (Collection) mResourceReferences.get(resourcesManager);</span><br><span class="line">               &#125;</span><br><span class="line">           &#125; else &#123;</span><br><span class="line">               Class activityThread = Class.forName(&quot;android.app.ActivityThread&quot;);</span><br><span class="line">               Field fMActiveResources = activityThread.getDeclaredField(&quot;mActiveResources&quot;);</span><br><span class="line">               fMActiveResources.setAccessible(true);</span><br><span class="line">               Object thread = getActivityThread(context, activityThread);</span><br><span class="line">               HashMap  map = (HashMap) fMActiveResources.get(thread);</span><br><span class="line">               references = map.values();</span><br><span class="line">           &#125;</span><br><span class="line">           for (WeakReference wr : references) &#123;</span><br><span class="line">               Resources resources = (Resources) wr.get();</span><br><span class="line">               if (resources != null) &#123;</span><br><span class="line">                   try &#123;</span><br><span class="line">                       Field mAssets = Resources.class.getDeclaredField(&quot;mAssets&quot;);</span><br><span class="line">                       mAssets.setAccessible(true);</span><br><span class="line">                       mAssets.set(resources, newAssetManager);</span><br><span class="line">                   &#125; catch (Throwable ignore) &#123;</span><br><span class="line">                       Field mResourcesImpl = Resources.class.getDeclaredField(&quot;mResourcesImpl&quot;);</span><br><span class="line">                       mResourcesImpl.setAccessible(true);</span><br><span class="line">                       Object resourceImpl = mResourcesImpl.get(resources);</span><br><span class="line">                       Field implAssets = resourceImpl.getClass().getDeclaredField(&quot;mAssets&quot;);</span><br><span class="line">                       implAssets.setAccessible(true);</span><br><span class="line">                       implAssets.set(resourceImpl, newAssetManager);</span><br><span class="line">                   &#125;</span><br><span class="line">                   resources.updateConfiguration(resources.getConfiguration(), resources.getDisplayMetrics());</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125; catch (Throwable e) &#123;</span><br><span class="line">           throw new IllegalStateException(e);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<h2 id="soä¿®å¤åŸç†"><a href="#soä¿®å¤åŸç†" class="headerlink" title="soä¿®å¤åŸç†"></a>soä¿®å¤åŸç†</h2><h3 id="æ¥å£è°ƒç”¨æ›¿æ¢"><a href="#æ¥å£è°ƒç”¨æ›¿æ¢" class="headerlink" title="æ¥å£è°ƒç”¨æ›¿æ¢"></a>æ¥å£è°ƒç”¨æ›¿æ¢</h3><p>sdkæä¾›æ¥å£æ›¿æ¢Systemé»˜è®¤åŠ è½½soåº“çš„æ¥å£<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SOPatchManger.loadLibrary(String libName)</span><br><span class="line">æ›¿æ¢</span><br><span class="line">System.loadLibrary(String libName)</span><br></pre></td></tr></table></figure></p>
<p>SOPatchManger.loadLibraryæ¥å£åŠ è½½soåº“çš„æ—¶å€™ä¼˜å…ˆå°è¯•å»åŠ è½½sdkæŒ‡å®šç›®å½•ä¸‹è¡¥ä¸çš„soã€‚è‹¥ä¸å­˜åœ¨ï¼Œåˆ™å†å»åŠ è½½å®‰è£…apkç›®å½•ä¸‹çš„soåº“</p>
<p>ä¼˜ç‚¹ï¼šä¸éœ€è¦å¯¹ä¸åŒsdkç‰ˆæœ¬è¿›è¡Œå…¼å®¹ï¼Œæ‰€ä»¥sdkç‰ˆæœ¬éƒ½æ˜¯System.loadLibraryè¿™ä¸ªæ¥å£</p>
<p>ç¼ºç‚¹ï¼šéœ€è¦ä¾µå…¥ä¸šåŠ¡ä»£ç ï¼Œæ›¿æ¢æ‰Systemé»˜è®¤åŠ è½½soåº“çš„æ¥å£</p>
<h3 id="åå°„æ³¨å…¥"><a href="#åå°„æ³¨å…¥" class="headerlink" title="åå°„æ³¨å…¥"></a>åå°„æ³¨å…¥</h3><p>é‡‡å–ç±»ä¼¼ç±»ä¿®å¤åå°„æ³¨å…¥æ–¹å¼ï¼Œåªè¦æŠŠè¡¥ä¸soåº“çš„è·¯å¾„æ’å…¥åˆ°nativeLibraryDirectoriesæ•°ç»„çš„æœ€å‰é¢ï¼Œå°±èƒ½å¤Ÿè¾¾åˆ°åŠ è½½soåº“çš„æ—¶å€™æ˜¯è¡¥ä¸soåº“è€Œä¸æ˜¯åŸæ¥soåº“çš„ç›®å½•ï¼Œä»è€Œè¾¾åˆ°ä¿®å¤ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public String findLibrary(String libraryName) &#123;</span><br><span class="line">        String fileName = System.mapLibraryName(libraryName);</span><br><span class="line"></span><br><span class="line">        for (NativeLibraryElement element : nativeLibraryPathElements) &#123;</span><br><span class="line">            String path = element.findNativeLibrary(fileName);</span><br><span class="line"></span><br><span class="line">            if (path != null) &#123;</span><br><span class="line">                return path;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>ä¼˜ç‚¹ï¼šä¸éœ€ä¾µå…¥ç”¨æˆ·æ¥å£è°ƒç”¨</p>
<p>ç¼ºç‚¹ï¼šéœ€è¦åšç‰ˆæœ¬å…¼å®¹æ§åˆ¶ï¼Œå…¼å®¹æ€§è¾ƒå·®</p>
<h1 id="ä½¿ç”¨çƒ­ä¿®å¤æŠ€æœ¯æœ‰å“ªäº›éœ€è¦æ³¨æ„çš„é—®é¢˜ï¼Ÿ"><a href="#ä½¿ç”¨çƒ­ä¿®å¤æŠ€æœ¯æœ‰å“ªäº›éœ€è¦æ³¨æ„çš„é—®é¢˜ï¼Ÿ" class="headerlink" title="ä½¿ç”¨çƒ­ä¿®å¤æŠ€æœ¯æœ‰å“ªäº›éœ€è¦æ³¨æ„çš„é—®é¢˜ï¼Ÿ"></a>ä½¿ç”¨çƒ­ä¿®å¤æŠ€æœ¯æœ‰å“ªäº›éœ€è¦æ³¨æ„çš„é—®é¢˜ï¼Ÿ</h1><h2 id="ç‰ˆæœ¬ç®¡ç†"><a href="#ç‰ˆæœ¬ç®¡ç†" class="headerlink" title="ç‰ˆæœ¬ç®¡ç†"></a>ç‰ˆæœ¬ç®¡ç†</h2><p>ä½¿ç”¨çƒ­ä¿®å¤æŠ€æœ¯åç”±äºå‘å¸ƒæµç¨‹çš„å˜åŒ–ï¼Œè‚¯å®šä¹Ÿéœ€æ±‚é‡‡ç”¨ç›¸åº”çš„åˆ†æ”¯ç®¡ç†è¿›è¡Œæ§åˆ¶ã€‚</p>
<p>é€šå¸¸ç§»åŠ¨å¼€å‘çš„åˆ†æ”¯ç®¡ç†é‡‡ç”¨ç‰¹æ€§åˆ†æ”¯ï¼Œå¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>åˆ†æ”¯</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>master</td>
<td>ä¸»åˆ†æ”¯ï¼ˆåªèƒ½mergeï¼Œä¸èƒ½commitï¼Œè®¾ç½®æƒé™ï¼‰ï¼Œç”¨äºç®¡ç†çº¿ä¸Šç‰ˆæœ¬ï¼ŒåŠæ—¶è®¾ç½®å¯¹åº”Tag</td>
</tr>
<tr>
<td>dev</td>
<td>å¼€å‘åˆ†æ”¯ï¼Œæ¯ä¸ªæ–°ç‰ˆæœ¬çš„ç ”å‘æ ¹æ®ç‰ˆæœ¬å·åŸºäºä¸»åˆ†æ”¯åˆ›å»ºï¼Œæµ‹è¯•é€šè¿‡éªŒè¯åï¼Œä¸Šçº¿åˆå…¥masteråˆ†æ”¯</td>
</tr>
<tr>
<td>function X</td>
<td>åŠŸèƒ½åˆ†æ”¯ï¼ŒæŒ‰éœ€æ±‚è®¾å®šã€‚åŸºäºå¼€å‘åˆ†æ”¯åˆ›å»ºï¼Œå®ŒæˆåŠŸèƒ½å¼€å‘ååˆå…¥devå¼€å‘åˆ†æ”¯</td>
</tr>
</tbody>
</table>
<p>æ¥å…¥çƒ­ä¿®å¤åï¼Œæ¨èå¯å‚è€ƒå¦‚ä¸‹åˆ†æ”¯ç­–ç•¥ï¼š<br>åˆ†æ”¯ | æè¿°<br>â€”|â€”<br>master | ä¸»åˆ†æ”¯ï¼ˆåªèƒ½mergeï¼Œä¸èƒ½commitï¼Œè®¾ç½®æƒé™ï¼‰ï¼Œç”¨äºç®¡ç†çº¿ä¸Šç‰ˆæœ¬ï¼ŒåŠæ—¶è®¾ç½®å¯¹åº”Tagï¼ˆä¸€èˆ¬3ä½ç‰ˆæœ¬å·ï¼‰<br>hot_fix | çƒ­ä¿®å¤åˆ†æ”¯ã€‚åŸºäºmasteråˆ†æ”¯åˆ›å»ºï¼Œä¿®å¤ç´§æ€¥é—®é¢˜åï¼Œæµ‹è¯•æ¨é€åï¼Œå°†hot_fixå†åˆå¹¶åˆ°masteråˆ†æ”¯ã€‚å†æ¬¡ä¸ºmasteråˆ†æ”¯æ‰“tagã€‚ï¼ˆä¸€èˆ¬4ä½ç‰ˆæœ¬å·ï¼‰<br>dev  | å¼€å‘åˆ†æ”¯ï¼Œæ¯ä¸ªæ–°ç‰ˆæœ¬çš„ç ”å‘æ ¹æ®ç‰ˆæœ¬å·åŸºäºä¸»åˆ†æ”¯åˆ›å»ºï¼Œæµ‹è¯•é€šè¿‡éªŒè¯åï¼Œä¸Šçº¿åˆå…¥masteråˆ†æ”¯<br>function X|åŠŸèƒ½åˆ†æ”¯ï¼ŒæŒ‰éœ€æ±‚è®¾å®šã€‚åŸºäºå¼€å‘åˆ†æ”¯åˆ›å»ºï¼Œå®ŒæˆåŠŸèƒ½å¼€å‘ååˆå…¥devå¼€å‘åˆ†æ”¯</p>
<p>æ³¨æ„çƒ­ä¿®å¤åˆ†æ”¯çš„æµ‹è¯•åŠå‘å¸ƒæµç¨‹åº”ç”¨æ­£å¸¸ç‰ˆæœ¬æµç¨‹ä¸€è‡´ï¼Œä¿è¯è´¨é‡ã€‚</p>
<h2 id="åˆ†å‘ç›‘æ§"><a href="#åˆ†å‘ç›‘æ§" class="headerlink" title="åˆ†å‘ç›‘æ§"></a>åˆ†å‘ç›‘æ§</h2><p>ç›®å‰ä¸»æµçš„çƒ­ä¿®å¤æ–¹æ¡ˆï¼ŒåƒTinkeråŠSophixéƒ½ä¼šæä¾›è¡¥ä¸çš„åˆ†å‘åŠç›‘æ§ã€‚è¿™ä¹Ÿæ˜¯æˆ‘ä»¬é€‰æ‹©çƒ­ä¿®å¤æŠ€æœ¯æ–¹æ¡ˆéœ€è¦è€ƒè™‘çš„å…³é”®å› ç´ ä¹‹ä¸€ã€‚æ¯•ç«Ÿä¸ºäº†ä¿è¯çº¿ä¸Šç‰ˆæœ¬çš„è´¨é‡ï¼Œåˆ†å‘æ§åˆ¶åŠå®æ—¶ç›‘æµ‹å¿…ä¸å¯å°‘ã€‚</p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>Androidçƒ­ä¿®å¤æŠ€æœ¯å‘å±•è‡³ä»Šå·²ç»æ˜¯ç™¾èŠ±é½æ”¾ï¼Œå„å¤§å‚ä¹Ÿéƒ½æ¨å‡ºäº†è‡ªå·±çš„æŠ€æœ¯æ¡†æ¶ã€‚ä¹Ÿæœ‰åƒé˜¿é‡Œæ¨å‡ºçš„ã€Šæ·±å…¥æ¢ç´¢Androidçƒ­ä¿®å¤æŠ€æœ¯åŸç†ã€‹å¯¹çƒ­ä¿®å¤æŠ€æœ¯çš„æ·±å…¥è§£è¯»ã€‚æœ¬æ–‡å¤§éƒ¨åˆ†æ€»ç»“ä¹Ÿéƒ½å‚è€ƒè¿™æœ¬ç»å…¸ã€‚é‰´äºçƒ­ä¿®å¤æŠ€æœ¯çš„å¤šç§å¤šæ ·ï¼Œæ‰€ä»¥æ‰å†³å®šè¿›è¡Œæ¢³ç†ï¼Œæä¾›é€‰æ‹©æ—¶çš„ä¸€äº›æ³¨æ„äº‹é¡¹åŠå‚è€ƒå»ºè®®ï¼Œä¹ŸåŠ æ·±è‡ªå·±å¯¹çƒ­ä¿®å¤æŠ€æœ¯çš„ç†è§£ã€‚æ€»çš„æ¥è¯´ï¼Œè¿˜æ˜¯æ”¶è·æ»¡æ»¡ã€‚</p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://github.com/alibaba/AndFix" target="_blank" rel="noopener">AndFixæºç </a></p>
<p><a href="https://github.com/jasonross/Nuwa" target="_blank" rel="noopener">Nuwaæºç </a></p>
<p><a href="https://github.com/Tencent/tinker/wiki" target="_blank" rel="noopener">Tinkerå®˜æ–¹ä»‹ç»</a></p>
<p><a href="http://w4lle.com/2017/03/31/robust-0/" target="_blank" rel="noopener">Androidçƒ­è¡¥ä¸ä¹‹RobuståŸç†è§£æ(ä¸€)</a></p>
<p><a href="https://www.cnblogs.com/popfisher/p/8543973.html" target="_blank" rel="noopener">Androidçƒ­ä¿®å¤æŠ€æœ¯åŸç†è¯¦è§£ï¼ˆæœ€æ–°æœ€å…¨ç‰ˆæœ¬ï¼‰</a></p>
<p>ã€Šæ·±å…¥æ¢ç´¢Androidçƒ­ä¿®å¤æŠ€æœ¯åŸç†ã€‹</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://junbin1011.github.io/2018/09/05/rxjava2-xæºç å­¦ä¹ éšç¬”/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="é»„ä¿Šå½¬">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://note.youdao.com/yws/api/personal/file/WEB917b08143504a6f8c96228312fcb5245?method=download&shareKey=03cb5c302c83b56bbb91668c5008444f">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JunBin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/09/05/rxjava2-xæºç å­¦ä¹ éšç¬”/" itemprop="url">
                  rxjava2.xæºç å­¦ä¹ éšç¬”
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2018-09-05T16:27:49+08:00">
                2018-09-05
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/09/05/rxjava2-xæºç å­¦ä¹ éšç¬”/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2018/09/05/rxjava2-xæºç å­¦ä¹ éšç¬”/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="rxjavaæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#rxjavaæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="rxjavaæ˜¯ä»€ä¹ˆï¼Ÿ"></a>rxjavaæ˜¯ä»€ä¹ˆï¼Ÿ</h1><h2 id="ReactiveX"><a href="#ReactiveX" class="headerlink" title="ReactiveX"></a>ReactiveX</h2><p>ReactiveXæ˜¯Reactive Extensionsçš„ç¼©å†™ï¼Œä¸€èˆ¬ç®€å†™ä¸ºRxï¼Œæœ€åˆæ˜¯LINQçš„ä¸€ä¸ªæ‰©å±•ï¼Œç”±å¾®è½¯çš„æ¶æ„å¸ˆErik Meijeré¢†å¯¼çš„å›¢é˜Ÿå¼€å‘ï¼Œåœ¨2012å¹´11æœˆå¼€æºï¼ŒRxæ˜¯ä¸€ä¸ªç¼–ç¨‹æ¨¡å‹ï¼Œç›®æ ‡æ˜¯æä¾›ä¸€è‡´çš„ç¼–ç¨‹æ¥å£ï¼Œå¸®åŠ©å¼€å‘è€…æ›´æ–¹ä¾¿çš„å¤„ç†å¼‚æ­¥æ•°æ®æµï¼ŒRxåº“æ”¯æŒ.NETã€JavaScriptå’ŒC++ï¼ŒRxè¿‘å‡ å¹´è¶Šæ¥è¶Šæµè¡Œäº†ï¼Œç°åœ¨å·²ç»æ”¯æŒå‡ ä¹å…¨éƒ¨çš„æµè¡Œç¼–ç¨‹è¯­è¨€äº†ï¼ŒRxçš„å¤§éƒ¨åˆ†è¯­è¨€åº“ç”±ReactiveXè¿™ä¸ªç»„ç»‡è´Ÿè´£ç»´æŠ¤ï¼Œæ¯”è¾ƒæµè¡Œçš„æœ‰RxJava/RxJS/Rx.NETã€‚</p>
<h2 id="rxjava"><a href="#rxjava" class="headerlink" title="rxjava"></a>rxjava</h2><p>rxjavaæ˜¯ReactiveXåœ¨javaå¹³å°çš„ä¸€ä¸ªå®ç°ã€‚æ˜¯ä¸€ä¸ªç¼–ç¨‹æ¨¡å‹ï¼Œä»¥è§‚å¯Ÿè€…æ¨¡å¼æä¾›é“¾å¼çš„æ¥å£è°ƒç”¨ï¼ŒåŠ¨æ€æ§åˆ¶çº¿ç¨‹çš„åˆ‡æ¢ï¼Œä½¿å¾—å¯ä»¥ç®€ä¾¿çš„å¤„ç†å¼‚æ­¥æ•°æ®æµã€‚</p>
<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>Github:<a href="https://github.com/ReactiveX/RxJava" target="_blank" rel="noopener">rxjava</a></p>
<p>ä¸­æ–‡æ–‡æ¡£ï¼š<a href="https://mcxiaoke.gitbooks.io/rxdocs/content/" target="_blank" rel="noopener">ReactiveX/RxJavaæ–‡æ¡£ä¸­æ–‡ç‰ˆ</a></p>
<p>å®˜ç½‘ï¼š<a href="http://reactivex.io/" target="_blank" rel="noopener">reactivex</a></p>
<h2 id="ç‰¹ç‚¹"><a href="#ç‰¹ç‚¹" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h2><ul>
<li>é“¾å¼è°ƒç”¨ï¼Œä½¿ç”¨ç®€å•</li>
<li>ç®€åŒ–é€»è¾‘</li>
<li>çµæ´»çš„çº¿ç¨‹è°ƒåº¦</li>
<li>æä¾›å®Œå–„çš„æ•°æ®æ“ä½œç¬¦ï¼ŒåŠŸèƒ½å¼ºå¤§</li>
</ul>
<h2 id="è§‚å¯Ÿè€…æ¨¡å¼"><a href="#è§‚å¯Ÿè€…æ¨¡å¼" class="headerlink" title="è§‚å¯Ÿè€…æ¨¡å¼"></a>è§‚å¯Ÿè€…æ¨¡å¼</h2><p> è§‚å¯Ÿè€…æ¨¡å¼å®šä¹‰å¯¹è±¡é—´ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œä½¿å¾—æ¯å½“ä¸€ä¸ªå¯¹è±¡æ”¹å˜çŠ¶æ€ï¼Œåˆ™æ‰€ä»¥ä¾èµ–äºå®ƒçš„å¯¹è±¡éƒ½ä¼šå¾—åˆ°é€šçŸ¥å¹¶è¢«è‡ªåŠ¨æ›´æ–°ã€‚rxjavaçš„æ ¸å¿ƒè®¾è®¡å°±æ˜¯é‡‡ç”¨è§‚å¯Ÿè€…æ¨¡å¼ã€‚Observableæ˜¯è¢«è§‚å¯Ÿè€…ï¼ŒObserveræ˜¯è§‚å¯Ÿè€…ï¼Œé€šè¿‡subscribeæ–¹æ³•è¿›è¡Œè®¢é˜…ã€‚</p>
<ul>
<li>ä¼˜ç‚¹</li>
</ul>
<p>è§‚å¯Ÿè€…å’Œè¢«è§‚å¯Ÿè€…ä¹‹é—´æ˜¯æŠ½è±¡è§£è€¦ï¼Œåº”å¯¹ä¸šåŠ¡å˜åŒ–</p>
<p>å¢å¼ºç³»ç»Ÿçµæ´»æ€§ã€å¯æ‰©å±•æ€§</p>
<p>å…·ä½“ä»£ç ç¤ºä¾‹å¯å‚è€ƒ<a href="https://junbin1011.github.io/2017/02/27/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/">è®¾è®¡æ¨¡å¼-è§‚å¯Ÿè€…æ¨¡å¼</a></p>
<ul>
<li>ç¼ºç‚¹</li>
</ul>
<p>åœ¨åº”ç”¨è§‚å¯Ÿè€…æ¨¡å¼æ—¶éœ€è¦è€ƒè™‘ä¸€ä¸‹å¼€å‘æ•ˆç‡å’Œè¿è¡Œæ•ˆç‡é—®é¢˜ï¼Œç¨‹åºä¸­åŒ…æ‹¬ä¸€ä¸ªè¢«è§‚å¯Ÿè€…ã€å¤šä¸ªè§‚å¯Ÿè€…ã€å¼€å‘å’Œè°ƒè¯•ç­‰å†…å®¹ä¼šæ¯”è¾ƒå¤æ‚ï¼Œè€Œä¸”åœ¨Javaä¸­æ¶ˆæ¯çš„é€šçŸ¥é»˜è®¤æ˜¯é¡ºåºæ‰§è¡Œï¼Œä¸€ä¸ªè§‚å¯Ÿè€…å¡é¡¿ï¼Œä¼šå½±å“æ•´ä½“çš„æ‰§è¡Œæ•ˆç‡ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸€èˆ¬è€ƒè™‘é‡‡ç”¨å¼‚æ­¥çš„æ–¹å¼</p>
<h1 id="rxjavaæ€ä¹ˆç”¨ï¼Ÿ"><a href="#rxjavaæ€ä¹ˆç”¨ï¼Ÿ" class="headerlink" title="rxjavaæ€ä¹ˆç”¨ï¼Ÿ"></a>rxjavaæ€ä¹ˆç”¨ï¼Ÿ</h1><p>gradleå¼•å…¥ç‰ˆæœ¬<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">implementation &apos;io.reactivex.rxjava2:rxjava:2.2.0&apos;</span><br><span class="line">implementation &apos;io.reactivex.rxjava2:rxandroid:2.1.0&apos;</span><br></pre></td></tr></table></figure></p>
<p> æ¥ç€ä¸¾ä¸€ä¸ªå¸¸ç”¨çš„rxjavaä½¿ç”¨çš„ä¾‹å­ï¼Œæˆ‘ä»¬åœ¨é¡¹ç›®ç»å¸¸éœ€è¦è¯·æ±‚æœåŠ¡ç«¯æ¥å£ï¼Œç„¶åè·å–æ•°æ®ï¼Œå°†æ•°æ®è¿›è¡Œç¼“å­˜ï¼Œç„¶åå¤„ç†uiä¸Šçš„æ˜¾ç¤ºã€‚ç¤ºä¾‹çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">Observable.create(new ObservableOnSubscribe&lt;Response&gt;() &#123;</span><br><span class="line">         @Override</span><br><span class="line">         public void subscribe(ObservableEmitter&lt;Response&gt; e) throws Exception &#123;</span><br><span class="line">             //è·å–æœåŠ¡ç«¯çš„æ¥å£æ•°æ®</span><br><span class="line">             Request.Builder builder = new Request.Builder()</span><br><span class="line">                     .url(&quot;http://xxx.com&quot;)</span><br><span class="line">                     .get();</span><br><span class="line">             Request request = builder.build();</span><br><span class="line">             Call call = new OkHttpClient().newCall(request);</span><br><span class="line">             Response response = call.execute();</span><br><span class="line">             e.onNext(response);</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;).map(new Function&lt;Response, Model&gt;() &#123;</span><br><span class="line">         @Override</span><br><span class="line">         public Model apply( Response response) throws Exception &#123;</span><br><span class="line">             //å°†jsonæ•°æ®è½¬åŒ–ä¸ºå¯¹åº”çš„Model</span><br><span class="line">             if (response.isSuccessful()) &#123;</span><br><span class="line">                 ResponseBody body = response.body();</span><br><span class="line">                 if (body != null) &#123;</span><br><span class="line">                     Log.e(TAG, &quot;map:è½¬æ¢å‰:&quot; + response.body());</span><br><span class="line">                     return new Gson().fromJson(body.string(), Model.class);</span><br><span class="line">                 &#125;</span><br><span class="line">             &#125;</span><br><span class="line">             return null;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;).doOnNext(new Consumer&lt;Model&gt;() &#123;</span><br><span class="line">                 @Override</span><br><span class="line">                 public void accept( Model s) throws Exception &#123;</span><br><span class="line">                     //å¯¹æ•°æ®è¿›è¡Œå…¶ä»–ç¼“å­˜çš„å¤„ç†</span><br><span class="line">                     Log.e(TAG, &quot;doOnNext: ä¿å­˜ç½‘ç»œåŠ è½½çš„æ•°æ®ï¼š&quot; + s.toString() + &quot;\n&quot;);</span><br><span class="line">                 &#125;</span><br><span class="line">             &#125;).subscribeOn(Schedulers.io())</span><br><span class="line">             .observeOn(AndroidSchedulers.mainThread())</span><br><span class="line">             .subscribe(new Consumer&lt;Model&gt;() &#123;</span><br><span class="line">                 @Override</span><br><span class="line">                 public void accept(Model model) throws Exception &#123;</span><br><span class="line">                     //åˆ·æ–°ui</span><br><span class="line">                     Log.e(TAG, &quot;æˆåŠŸåˆ·æ–°ç•Œé¢:&quot; + data.toString() + &quot;\n&quot;);</span><br><span class="line">                 &#125;</span><br><span class="line">             &#125;, new Consumer&lt;Throwable&gt;() &#123;</span><br><span class="line">                 @Override</span><br><span class="line">                 public void accept(Throwable throwable) throws Exception &#123;</span><br><span class="line">                     //è¿›è¡Œå¤±è´¥çš„å¼‚å¸¸æç¤º</span><br><span class="line">                     Log.e(TAG, &quot;å¤±è´¥å¤„ç†å¼‚å¸¸ï¼š&quot; + throwable.getMessage() + &quot;\n&quot;);</span><br><span class="line">                 &#125;</span><br><span class="line">             &#125;);</span><br></pre></td></tr></table></figure>
<p>æœ¬æ–‡ä¸»è¦å¯¹rxjavaçš„æºç è¿›è¡Œæ¢³ç†åˆ†æï¼Œå…³äºrxjavaæ“ä½œç¬¦çš„ä½¿ç”¨ï¼Œæ¨èå‚è€ƒä¸­æ–‡çš„æ–‡æ¡£ï¼Œä»¥åŠä¸‹é¢çš„åšæ–‡ä»‹ç»ã€‚</p>
<p><a href="https://www.jianshu.com/p/0cd258eecf60" target="_blank" rel="noopener">è¿™å¯èƒ½æ˜¯æœ€å¥½çš„RxJava 2.x æ•™ç¨‹ï¼ˆå®Œç»“ç‰ˆï¼‰</a></p>
<h1 id="rxjavaæ ¸å¿ƒæ‰§è¡Œæµç¨‹æ˜¯æ€æ ·ï¼Ÿ"><a href="#rxjavaæ ¸å¿ƒæ‰§è¡Œæµç¨‹æ˜¯æ€æ ·ï¼Ÿ" class="headerlink" title="rxjavaæ ¸å¿ƒæ‰§è¡Œæµç¨‹æ˜¯æ€æ ·ï¼Ÿ"></a>rxjavaæ ¸å¿ƒæ‰§è¡Œæµç¨‹æ˜¯æ€æ ·ï¼Ÿ</h1><p>rxjavaä¸»è¦æ˜¯é‡‡ç”¨è§‚å¯Ÿè€…æ¨¡å¼è¿›è¡Œè®¾è®¡ï¼Œå½“æ‰§è¡Œç›¸å…³çš„æ“ä½œç¬¦æ˜¯ä¼šç”Ÿæˆæ–°çš„ObservableåŠObserverã€‚Observableä¼šæŒæœ‰ä¸Šæ¸¸è¢«è§‚å¯Ÿè€…ï¼ŒObserverä¼šæŒæœ‰ä¸‹æ¸¸çš„è§‚å¯Ÿè€…ã€‚å½“æ‰§è¡Œsubscribeè®¢é˜…æ–¹æ³•çš„æ—¶å€™ï¼Œé€šè¿‡æŒæœ‰ä¸Šæ¸¸çš„è¢«è§‚å¯Ÿè€…å¯¹è±¡ï¼Œä¼šå¾€ä¸Šæ¸¸é€æ­¥æ‰§è¡Œè®¢é˜…æ–¹æ³•ã€‚å½“æ‰§è¡Œåˆ°èµ·å§‹çš„è¢«è§‚å¯Ÿè€…å›è°ƒæ–¹æ³•æ—¶ï¼Œå¦‚æœæ‰§è¡ŒObservableEmitterçš„onNextæ–¹æ³•æ—¶ï¼Œç”±äºObserverä¼šæŒæœ‰ä¸‹æ¸¸çš„Observerå¯¹è±¡ï¼Œä¼šé€æ­¥è°ƒç”¨ä¸‹æ¸¸çš„onNextæ–¹æ³•ï¼Œç›´åˆ°æœ€ç»ˆsubscribeä¼ å…¥çš„è§‚å¯Ÿè€…å®ä¾‹ã€‚è¿™æ˜¯rxjavaé“¾å¼è°ƒç”¨çš„æ ¸å¿ƒæ‰§è¡Œæµç¨‹ã€‚</p>
<p>å½“ç„¶rxjavaè¿˜æ¶‰åŠåˆ°çº¿ç¨‹çš„è°ƒåº¦åŠæ•°æ®çš„èƒŒå‹å¤„ç†ï¼Œå…³äºè¿™äº›å®ç°çš„åŸç†ä¼šå†åç»­è¿›è¡Œæ¢³ç†ã€‚ä½†rxjavaçš„é“¾å¼è°ƒç”¨çš„æ ¸å¿ƒæ‰§è¡Œæµç¨‹éƒ½æ˜¯ä¸€è‡´ã€‚ä¸‹é¢æˆ‘ä»¬å°†é€šè¿‡2ä¸ªéƒ¨åˆ†æ¥æ¢³ç†rxjavaçš„æ ¸å¿ƒæ‰§è¡Œæµç¨‹ï¼ŒåŒ…å«ä¸€äº›å…³é”®ç±»çš„è¯´æ˜ï¼ŒåŠé€šè¿‡ç¤ºä¾‹çš„ä»£ç ç›¸å…³çš„æ‰§è¡Œæµç¨‹å›¾è¿›è¡Œæ¢³ç†ã€‚</p>
<h2 id="å…³é”®ç±»åŠŸèƒ½è¯´æ˜"><a href="#å…³é”®ç±»åŠŸèƒ½è¯´æ˜" class="headerlink" title="å…³é”®ç±»åŠŸèƒ½è¯´æ˜"></a>å…³é”®ç±»åŠŸèƒ½è¯´æ˜</h2><table>
<thead>
<tr>
<th>ç±»</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td> ObservableSource</td>
<td>æ¥å£ç±»ï¼Œåªæœ‰ä¸€ä¸ªsubscribeæ–¹æ³•ï¼Œå‚æ•°æ˜¯Observerå¯¹è±¡</td>
</tr>
<tr>
<td> Observer</td>
<td>æ¥å£ç±»ï¼Œè§‚å¯Ÿè€…ã€‚æœ‰onSubscribeã€onNextã€onErrorã€onCompleteæ–¹æ³•</td>
</tr>
<tr>
<td> Consumer</td>
<td>æ¥å£æœ‰ï¼Œè§‚å¯Ÿè€…ã€‚åªæœ‰ä¸€ä¸ªacceptæ–¹æ³•ï¼Œåœ¨è¢«è®¢é˜…æ—¶æœ€ç»ˆä¹Ÿä¼šè½¬æ¢æˆObserverï¼Œè®¾è®¡è¿™ä¸ªç±»æ˜¯ä¸ºäº†ç®€åŒ–è°ƒç”¨</td>
</tr>
<tr>
<td> Observable</td>
<td>æŠ½è±¡ç±»ï¼Œç»§æ‰¿äº†ObservableSourceæ¥å£ï¼Œæ“ä½œç¬¦çš„å®ç°éƒ½æ˜¯ç»§æ‰¿ä¸å®ƒã€‚å†…éƒ¨å°è£…äº†å¤§é‡çš„æ“ä½œç¬¦è°ƒç”¨æ–¹æ³•ï¼Œä¸»è¦æ˜¯æœ‰ä¸€ä¸ªæ ¸å¿ƒçš„æŠ½è±¡æ–¹æ³•abstract void subscribeActual(Observer&lt;? super T&gt; observer)ï¼Œç”¨äºå®ç°ç›¸å…³çš„è®¢é˜…åˆ†å‘é€»è¾‘ã€‚</td>
</tr>
<tr>
<td> AbstractObservableWithUpstream</td>
<td>ç»§æ‰¿äºObservableï¼Œæ„é€ æ–¹æ³•éœ€è¦ä¼ å…¥ObservableSource<t> sourceå¯¹è±¡ï¼Œsourceæ˜¯çˆ¶è¢«è§‚å¯Ÿè€…ã€‚</t></td>
</tr>
<tr>
<td> ObservableCreate</td>
<td>ç»§æ‰¿äºAbstractObservableWithUpstreamï¼Œsourceä¸ºObservableOnSubscribeã€‚subscribeActualæ–¹æ³•ä¼šå®ä¾‹åŒ–ä¸€ä¸ªCreateEmitterå¯¹è±¡ï¼Œæ‰§è¡ŒObservableOnSubscribeçš„subscribeæ–¹æ³•</td>
</tr>
<tr>
<td> ObservableMap</td>
<td>ç»§æ‰¿äºAbstractObservableWithUpstreamï¼Œè®¢é˜…ä¼šæ–°ç”Ÿäº§ä¸€ä¸ªè§‚å¯Ÿè€…MapObserver</td>
</tr>
<tr>
<td> MapObserver</td>
<td>ObservableMapçš„å†…éƒ¨ç±»ï¼ŒonNextæ–¹æ³•ä¼šè§¦å‘mapper.apply(t)å›è°ƒï¼Œç„¶åæ‰§è¡Œä¸‹æ¸¸è§‚å¯Ÿè€…çš„onNextæ–¹æ³•</td>
</tr>
<tr>
<td> ObservableDoOnEach</td>
<td>ç»§æ‰¿äºAbstractObservableWithUpstreamï¼Œè®¢é˜…ä¼šæ–°ç”Ÿäº§ä¸€ä¸ªè§‚å¯Ÿè€…DoOnEachObserver</td>
</tr>
<tr>
<td> DoOnEachObserver</td>
<td>ObservableDoOnEachçš„å†…éƒ¨ç±»ï¼ŒonNextä¼šæ‰§è¡ŒonNext.accept(t)æ–¹æ³•ï¼Œç„¶åæ‰§è¡Œä¸‹æ¸¸è§‚å¯Ÿè€…çš„onNextæ–¹æ³•</td>
</tr>
<tr>
<td> ObservableSubscribeOn</td>
<td>ç»§æ‰¿äºAbstractObservableWithUpstreamï¼Œè¢«è§‚å¯Ÿè€…çº¿ç¨‹è°ƒåº¦æ§åˆ¶ã€‚subscribeActualä¼šæ‰§è¡Œscheduler.scheduleDirect(new SubscribeTask(parent))ï¼ŒSubscribeTaskçš„runæ–¹æ³•ä¼šæ‰§è¡Œsource.subscribe(parent)ã€‚ObservableSubscribeOnæ ¹æ®çº¿ç¨‹è°ƒåº¦å™¨çš„ç­–ç•¥å»æ‰§è¡Œä¸Šæ¸¸çš„è®¢é˜…æ–¹æ³•å®ç°ã€‚</td>
</tr>
<tr>
<td> ObservableObserveOn</td>
<td>ç»§æ‰¿äºAbstractObservableWithUpstreamï¼Œè§‚å¯Ÿè€…çº¿ç¨‹è°ƒåº¦æ§åˆ¶ã€‚subscribeActualæ–¹æ³•ä¼šåˆ¤æ–­scheduleræ˜¯å¦ä¸ºTrampolineSchedulerã€‚è‹¥æ˜¯åˆ™æ‰§è¡Œä¸‹æ¸¸çš„è§‚å¯Ÿè€…ï¼Œå¦ä¼šåˆ›å»ºæ–°çš„ObserveOnObserverï¼Œå¹¶ä¼ å…¥scheduleçš„workã€‚</td>
</tr>
<tr>
<td> ObserveOnObserver</td>
<td>ObservableObserveOnå†…éƒ¨ç±»ï¼ŒonNextä¼šè§¦å‘æ‰§è¡Œscheduleï¼ˆï¼‰æ–¹æ³•ï¼Œæ ¹æ®workerå»æ§åˆ¶ä¸‹æ¸¸è§‚å¯Ÿè€…çš„å›è°ƒçº¿ç¨‹</td>
</tr>
</tbody>
</table>
<h2 id="ä»£ç æ‰§è¡Œæµç¨‹"><a href="#ä»£ç æ‰§è¡Œæµç¨‹" class="headerlink" title="ä»£ç æ‰§è¡Œæµç¨‹"></a>ä»£ç æ‰§è¡Œæµç¨‹</h2><p>é¦–å…ˆæˆ‘ä»¬æ ¹æ®ä¸Šé¢demoä¾‹å­ï¼Œæ¢³ç†å‡ºrxjavaçš„ç®€å•æ‰§è¡Œæµç¨‹ï¼Œå¦‚ä¸‹å›¾ï¼š<br><img src="http://upload-images.jianshu.io/upload_images/5125122-a863e73ba5777198?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p>é€šè¿‡æµç¨‹å›¾å¯çŸ¥ï¼Œrxjavaå½“æ‰§è¡Œç›¸å…³çš„æ“ä½œç¬¦æ˜¯ä¼šç”Ÿæˆæ–°çš„ObservableåŠObserverã€‚Observableä¼šæŒæœ‰ä¸Šæ¸¸è¢«è§‚å¯Ÿè€…ï¼ŒObserverä¼šæŒæœ‰ä¸‹æ¸¸çš„è§‚å¯Ÿè€…ã€‚å½“æ‰§è¡Œsubscribeè®¢é˜…æ–¹æ³•çš„æ—¶å€™ï¼Œé€šè¿‡æŒæœ‰ä¸Šæ¸¸çš„è¢«è§‚å¯Ÿè€…å¯¹è±¡ï¼Œä¼šå¾€ä¸Šæ¸¸é€æ­¥æ‰§è¡Œè®¢é˜…æ–¹æ³•ã€‚å½“æ‰§è¡Œåˆ°èµ·å§‹çš„è¢«è§‚å¯Ÿè€…å›è°ƒæ–¹æ³•æ—¶ï¼Œå¦‚æœæ‰§è¡ŒObservableEmitterçš„onNextæ–¹æ³•æ—¶ï¼Œç”±äºObserverä¼šæŒæœ‰ä¸‹æ¸¸çš„Observerå¯¹è±¡ï¼Œä¼šé€æ­¥è°ƒç”¨ä¸‹æ¸¸çš„onNextæ–¹æ³•ï¼Œç›´åˆ°æœ€ç»ˆsubscribeä¼ å…¥çš„è§‚å¯Ÿè€…å®ä¾‹ã€‚</p>
<p> äº†è§£äº†rxjavaå¤§è‡´çš„æ‰§è¡Œæµç¨‹ï¼Œä¸‹é¢æˆ‘ä»¬æ¥è¯¦ç»†çš„çœ‹çœ‹æºç çš„æ‰§è¡Œæµç¨‹ã€‚é¦–å…ˆè¿˜æ˜¯å…ˆä¸Šä¸€ä¸‹æ•´ä½“çš„æµç¨‹å›¾ï¼Œç”±äºå›¾ç‰‡è¾ƒå¤§ï¼Œå»ºè®®ç»“åˆä¸Šè¿°çš„demoåŠrxjavaçš„æºç è¿›è¡ŒæŸ¥çœ‹ã€‚</p>
<p> <img src="http://upload-images.jianshu.io/upload_images/5125122-844ed90793607aa1?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p>ä¸‹é¢æˆ‘ä»¬åˆ†é…é€šè¿‡å‡ ä¸ªæ“ä½œç¬¦æ¥çœ‹çœ‹rxjavaæºç å…·ä½“çš„å®ç°ã€‚</p>
<h3 id="create"><a href="#create" class="headerlink" title="create"></a>create</h3><p>createçš„æ“ä½œç¬¦ä¼šè¿”å›ä¸€ä¸ªObservableCreateçš„è¢«è§‚å¯Ÿè€…ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public static &lt;T&gt; Observable&lt;T&gt; create(ObservableOnSubscribe&lt;T&gt; source) &#123;</span><br><span class="line">      ObjectHelper.requireNonNull(source, &quot;source is null&quot;);</span><br><span class="line">      return RxJavaPlugins.onAssembly(new ObservableCreate&lt;T&gt;(source));</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p>æ¥ä¸‹æ¥çœ‹çœ‹ObservableCreateå¯¹è±¡çš„å…³é”®å®ç°ä»£ç ï¼Œå¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">//æ„é€ æ–¹æ³•ä¼šä¼ å…¥ObservableOnSubscribeæ¥å£çš„å¼•ç”¨ï¼ŒæŒ‡å®šä¸ºè¯¥è¢«è§‚å¯Ÿè€…çš„sourceã€‚</span><br><span class="line"> public ObservableCreate(ObservableOnSubscribe&lt;T&gt; source) &#123;</span><br><span class="line">       this.source = source;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"> //æ ¸å¿ƒçš„subscribeActual </span><br><span class="line">   @Override</span><br><span class="line">   protected void subscribeActual(Observer&lt;? super T&gt; observer) &#123;</span><br><span class="line">     //åˆ›å»ºäº†CreateEmitterå‘å°„å™¨</span><br><span class="line">       CreateEmitter&lt;T&gt; parent = new CreateEmitter&lt;T&gt;(observer);</span><br><span class="line">       observer.onSubscribe(parent);</span><br><span class="line"></span><br><span class="line">       try &#123;</span><br><span class="line">         //æ‰§è¡Œäº†ObservableOnSubscribeçš„subscribeå›è°ƒæ–¹æ³•ï¼Œä¼ å…¥äº†CreateEmitterå¯¹è±¡</span><br><span class="line">           source.subscribe(parent);</span><br><span class="line">       &#125; catch (Throwable ex) &#123;</span><br><span class="line">           Exceptions.throwIfFatal(ex);</span><br><span class="line">           parent.onError(ex);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></p>
<p>å½“æˆ‘ä»¬åœ¨ä¸šåŠ¡ä»£ç æ‰§è¡Œäº†ObservableEmitterçš„onNextæ–¹æ³•ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹CreateEmitterçš„onNextçš„å®ç°ä»£ç ï¼Œå¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> //æŒæœ‰ä¸‹æ¸¸çš„è§‚å¯Ÿè€…å¼•ç”¨</span><br><span class="line">CreateEmitter(Observer&lt;? super T&gt; observer) &#123;</span><br><span class="line">         this.observer = observer;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     @Override</span><br><span class="line">     public void onNext(T t) &#123;</span><br><span class="line">         if (t == null) &#123;</span><br><span class="line">             onError(new NullPointerException(&quot;onNext called with null. Null values are generally not allowed in 2.x operators and sources.&quot;));</span><br><span class="line">             return;</span><br><span class="line">         &#125;</span><br><span class="line">         //å¦‚æœæ²¡æœ‰å–æ¶ˆè®¢é˜…ï¼Œåˆ™ä¼šæ‰§è¡Œä¸‹æ¸¸çš„è§‚å¯Ÿè€…çš„onNextæ–¹æ³•ï¼Œè¾¾åˆ°é“¾å¼è°ƒç”¨çš„æ•ˆæœ</span><br><span class="line">         if (!isDisposed()) &#123;</span><br><span class="line">             observer.onNext(t);</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="map"><a href="#map" class="headerlink" title="map"></a>map</h3><p>mapçš„æ“ä½œç¬¦ä¼šè¿”å›ä¸€ä¸ªObservableMapçš„è¢«è§‚å¯Ÿè€…ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@CheckReturnValue</span><br><span class="line">  @SchedulerSupport(SchedulerSupport.NONE)</span><br><span class="line">  public final &lt;R&gt; Observable&lt;R&gt; map(Function&lt;? super T, ? extends R&gt; mapper) &#123;</span><br><span class="line">      ObjectHelper.requireNonNull(mapper, &quot;mapper is null&quot;);</span><br><span class="line">      return RxJavaPlugins.onAssembly(new ObservableMap&lt;T, R&gt;(this, mapper));</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p>æ¥ä¸‹æ¥çœ‹çœ‹ObservableMapå¯¹è±¡çš„å…³é”®å®ç°ä»£ç ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public void subscribeActual(Observer&lt;? super U&gt; t) &#123;</span><br><span class="line">    //å°†ä¸Šæ¸¸çš„è¢«è§‚å¯Ÿè€…è®¢é˜…MapObserverè§‚å¯Ÿè€…</span><br><span class="line">    source.subscribe(new MapObserver&lt;T, U&gt;(t, function));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥ä¸»è¦çœ‹çœ‹MapObserverçš„onNextæ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šåœ¨ObservableEmitterçš„onNextæ–¹æ³•è§¦å‘åè¢«è°ƒç”¨ï¼Œå¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">  //æŒæœ‰ä¸‹æ¸¸çš„è§‚å¯Ÿè€…å’Œå›è°ƒå‡½æ•°mapper</span><br><span class="line">  MapObserver(Observer&lt;? super U&gt; actual, Function&lt;? super T, ? extends U&gt; mapper) &#123;</span><br><span class="line">           super(actual);</span><br><span class="line">           this.mapper = mapper;</span><br><span class="line">       &#125;</span><br><span class="line">       </span><br><span class="line">@Override</span><br><span class="line">       public void onNext(T t) &#123;</span><br><span class="line">           if (done) &#123;</span><br><span class="line">               return;</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           if (sourceMode != NONE) &#123;</span><br><span class="line">               actual.onNext(null);</span><br><span class="line">               return;</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           U v;</span><br><span class="line"></span><br><span class="line">           try &#123;</span><br><span class="line">             //mapçš„æ ¸å¿ƒæ‰§è¡Œä»£ç ï¼Œmapper.apply(t)ä¼šæ‰§è¡Œæ•°æ®çš„è½¬æ¢ï¼Œå¹¶å°†è½¬æ¢åçš„ç»“æœvç»§ç»­äº¤ç”±ä¸‹æ¸¸çš„è§‚å¯Ÿè€…æ‰§è¡Œ</span><br><span class="line">               v = ObjectHelper.requireNonNull(mapper.apply(t), &quot;The mapper function returned a null value.&quot;);</span><br><span class="line">           &#125; catch (Throwable ex) &#123;</span><br><span class="line">               fail(ex);</span><br><span class="line">               return;</span><br><span class="line">           &#125;</span><br><span class="line">           //å°†è½¬æ¢åçš„ç»“æœvç»§ç»­äº¤ç”±ä¸‹æ¸¸çš„è§‚å¯Ÿè€…æ‰§è¡Œ</span><br><span class="line">           actual.onNext(v);</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="doOnNext"><a href="#doOnNext" class="headerlink" title="doOnNext"></a>doOnNext</h3><p>doOnNextçš„æ“ä½œç¬¦ä¼šè¿”å›ä¸€ä¸ªObservableDoOnEachçš„è¢«è§‚å¯Ÿè€…ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">private Observable&lt;T&gt; doOnEach(Consumer&lt;? super T&gt; onNext, Consumer&lt;? super Throwable&gt; onError, Action onComplete, Action onAfterTerminate) &#123;</span><br><span class="line">    ObjectHelper.requireNonNull(onNext, &quot;onNext is null&quot;);</span><br><span class="line">    ObjectHelper.requireNonNull(onError, &quot;onError is null&quot;);</span><br><span class="line">    ObjectHelper.requireNonNull(onComplete, &quot;onComplete is null&quot;);</span><br><span class="line">    ObjectHelper.requireNonNull(onAfterTerminate, &quot;onAfterTerminate is null&quot;);</span><br><span class="line">    return RxJavaPlugins.onAssembly(new ObservableDoOnEach&lt;T&gt;(this, onNext, onError, onComplete, onAfterTerminate));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>æ¥ä¸‹æ¥çœ‹çœ‹ObservableDoOnEachå¯¹è±¡çš„å…³é”®å®ç°ä»£ç ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public void subscribeActual(Observer&lt;? super T&gt; t) &#123;</span><br><span class="line">   //å®ä¾‹åŒ–ä¸€ä¸ªDoOnEachObserverçš„è§‚å¯Ÿè€…å¯¹è±¡</span><br><span class="line">    source.subscribe(new DoOnEachObserver&lt;T&gt;(t, onNext, onError, onComplete, onAfterTerminate));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæ ¸å¿ƒæˆ‘ä»¬è¿˜æ˜¯è¦çœ‹DoOnEachObserverçš„onNextå¯¹äºæ•°æ®çš„å¤„ç†ï¼Œå¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">      public void onNext(T t) &#123;</span><br><span class="line">          if (done) &#123;</span><br><span class="line">              return;</span><br><span class="line">          &#125;</span><br><span class="line">          try &#123;</span><br><span class="line">              //å›è°ƒacceptæ–¹æ³•</span><br><span class="line">              onNext.accept(t);</span><br><span class="line">          &#125; catch (Throwable e) &#123;</span><br><span class="line">              Exceptions.throwIfFatal(e);</span><br><span class="line">              s.dispose();</span><br><span class="line">              onError(e);</span><br><span class="line">              return;</span><br><span class="line">          &#125;</span><br><span class="line">          //ç»§ç»­å¾€ä¸‹æ¸¸è°ƒç”¨è§‚å¯Ÿè€…çš„onNext</span><br><span class="line">          actual.onNext(t);</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="subscribeOn"><a href="#subscribeOn" class="headerlink" title="subscribeOn"></a>subscribeOn</h3><p>subscribeOnçš„æ“ä½œç¬¦ä¼šè¿”å›ä¸€ä¸ªObservableSubscribeOnçš„è¢«è§‚å¯Ÿè€…ï¼Œå¹¶ä¼ å…¥schedulerçº¿ç¨‹è°ƒåº¦å‚æ•°ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@CheckReturnValue</span><br><span class="line">@SchedulerSupport(SchedulerSupport.CUSTOM)</span><br><span class="line">public final Observable&lt;T&gt; subscribeOn(Scheduler scheduler) &#123;</span><br><span class="line">    ObjectHelper.requireNonNull(scheduler, &quot;scheduler is null&quot;);</span><br><span class="line">    return RxJavaPlugins.onAssembly(new ObservableSubscribeOn&lt;T&gt;(this, scheduler));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>æ¥ä¸‹æ¥çœ‹çœ‹ObservableSubscribeOnå¯¹è±¡çš„å…³é”®å®ç°ä»£ç ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> public ObservableSubscribeOn(ObservableSource&lt;T&gt; source, Scheduler scheduler) &#123;</span><br><span class="line">    super(source);</span><br><span class="line">    this.scheduler = scheduler;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Override</span><br><span class="line">public void subscribeActual(final Observer&lt;? super T&gt; s) &#123;</span><br><span class="line">    //åˆ›å»ºäº†SubscribeOnObserverçš„è§‚å¯Ÿè€…</span><br><span class="line">    final SubscribeOnObserver&lt;T&gt; parent = new SubscribeOnObserver&lt;T&gt;(s);</span><br><span class="line"></span><br><span class="line">    s.onSubscribe(parent);</span><br><span class="line">    </span><br><span class="line">    //è¿™ä¸ªæ˜¯æ ¸å¿ƒæ–¹æ³•ï¼Œè°ƒç”¨äº†çº¿ç¨‹è°ƒåº¦å»çš„scheduleDirectæ–¹æ³•ï¼Œå¹¶ä¼ å…¥SubscribeTaskä»»åŠ¡</span><br><span class="line">    parent.setDisposable(scheduler.scheduleDirect(new SubscribeTask(parent)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹SubscribeTaskçš„å®ç°ï¼Œå¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">final class SubscribeTask implements Runnable &#123;</span><br><span class="line">      private final SubscribeOnObserver&lt;T&gt; parent;</span><br><span class="line"></span><br><span class="line">      SubscribeTask(SubscribeOnObserver&lt;T&gt; parent) &#123;</span><br><span class="line">          this.parent = parent;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      @Override</span><br><span class="line">      public void run() &#123;</span><br><span class="line">          //æ‰§è¡Œä¸Šæ¸¸è¢«è§‚å¯Ÿçš„è®¢é˜…æ–¹æ³•ï¼Œè¿™é‡Œå°±æ˜¯subscribeOnå°†ä¸Šæ¸¸çš„è®¢é˜…æ–¹æ³•æ§åˆ¶åœ¨scheduleræŒ‡å®šçº¿ç¨‹æ‰§è¡Œçš„æ ¸å¿ƒ</span><br><span class="line">          source.subscribe(parent);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p>æœ€åçœ‹ä¸‹SubscribeOnObserverçš„onNextæ–¹æ³•ï¼Œæ¯”è¾ƒç®€å•ï¼Œç›´æ¥æ‰§è¡Œä¸‹æ¸¸è§‚å¯Ÿè€…çš„onNextæ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">     public void onNext(T t) &#123;</span><br><span class="line">         actual.onNext(t);</span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure></p>
<p>å…³äºschedulerçš„å…·ä½“å®ç°ï¼Œåœ¨åç»­çš„çº¿ç¨‹åŸç†è¿›è¡Œåˆ†æã€‚è¿™é‡Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“ä¸Šæ¸¸çš„è¢«è§‚å¯Ÿè€…çš„è®¢é˜…åœ¨æŒ‡å®šçš„schedulerçº¿ç¨‹ç­–ç•¥ä¸­æ‰§è¡Œå°±å¯ä»¥äº†ã€‚</p>
<h3 id="observerOn"><a href="#observerOn" class="headerlink" title="observerOn"></a>observerOn</h3><p>observerOn çš„æ“ä½œç¬¦ä¼šè¿”å›ä¸€ä¸ªObservableObserveOnçš„è¢«è§‚å¯Ÿè€…ï¼Œå¹¶ä¼ å…¥schedulerçº¿ç¨‹è°ƒåº¦å‚æ•°ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> @CheckReturnValue</span><br><span class="line">@SchedulerSupport(SchedulerSupport.CUSTOM)</span><br><span class="line">public final Observable&lt;T&gt; observeOn(Scheduler scheduler, boolean delayError, int bufferSize) &#123;</span><br><span class="line">    ObjectHelper.requireNonNull(scheduler, &quot;scheduler is null&quot;);</span><br><span class="line">    ObjectHelper.verifyPositive(bufferSize, &quot;bufferSize&quot;);</span><br><span class="line">    return RxJavaPlugins.onAssembly(new ObservableObserveOn&lt;T&gt;(this, scheduler, delayError, bufferSize));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>æ¥ä¸‹æ¥çœ‹çœ‹ObservableObserveOnå¯¹è±¡çš„å…³é”®å®ç°ä»£ç ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line"> protected void subscribeActual(Observer&lt;? super T&gt; observer) &#123;</span><br><span class="line">    //TrampolineScheduler å¦‚æœæ˜¯å½“å‰çš„çº¿ç¨‹ åˆ™ç›´æ¥å°†ä¸‹æ¸¸çš„è§‚å¯Ÿè€…ä¸ä¸Šæ¸¸çš„è¢«è§‚å¯Ÿè®¢é˜…</span><br><span class="line">     if (scheduler instanceof TrampolineScheduler) &#123;</span><br><span class="line">         source.subscribe(observer);</span><br><span class="line">     &#125; else &#123;</span><br><span class="line">         //å…¶ä»–çº¿ç¨‹ç­–ç•¥</span><br><span class="line">         Scheduler.Worker w = scheduler.createWorker();</span><br><span class="line">         //å°†çº¿ç¨‹ç­–ç•¥çš„workerä¼ å…¥ObserveOnObserverè§‚å¯Ÿè€…</span><br><span class="line">         source.subscribe(new ObserveOnObserver&lt;T&gt;(observer, w, delayError, bufferSize));</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥å…³é”®è¿˜æ˜¯çœ‹ObserveOnObserverçš„å®ç°ï¼Œå¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public void onNext(T t) &#123;</span><br><span class="line">    // ä¸Šä¸€çº§çš„æ¨¡å¼å¦‚æœä¸æ˜¯å¼‚æ­¥çš„ï¼ŒåŠ å…¥é˜Ÿåˆ—</span><br><span class="line">    if (sourceMode != QueueDisposable.ASYNC) &#123;</span><br><span class="line">        queue.offer(t);</span><br><span class="line">    &#125;</span><br><span class="line">    //è¿›è¡Œçº¿ç¨‹è°ƒåº¦</span><br><span class="line">    schedule();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void schedule() &#123;</span><br><span class="line">    // åˆ¤æ–­å½“å‰æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡æ•°ç›®</span><br><span class="line">    if (getAndIncrement() == 0) &#123;</span><br><span class="line">        worker.schedule(this);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ObserveOnObserveræœ¬èº«ç»§æ‰¿äº†Runnableæ¥å£ï¼Œrunæ–¹æ³•å®ç°å¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public void run() &#123;</span><br><span class="line">    //è¾“å‡ºç»“æœæ˜¯å¦èåˆ</span><br><span class="line">    if (outputFused) &#123;</span><br><span class="line">        drainFused();</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        drainNormal();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>æˆ‘ä»¬å…ˆè¿›å…¥drainNormalæ–¹æ³•ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">void drainNormal() &#123;</span><br><span class="line">    int missed = 1;</span><br><span class="line">    final SimpleQueue&lt;T&gt; q = queue;</span><br><span class="line">    final Observer&lt;? super T&gt; a = actual;</span><br><span class="line">    //ç¬¬ä¸€å±‚å¾ªç¯</span><br><span class="line">    for (;;) &#123;</span><br><span class="line">        // æ£€æŸ¥å¼‚å¸¸å¤„ç†</span><br><span class="line">        if (checkTerminated(done, q.isEmpty(), a)) &#123;</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        //ç¬¬äºŒå±‚å¾ªç¯</span><br><span class="line">        for (;;) &#123;</span><br><span class="line">            boolean d = done;</span><br><span class="line">            T v;</span><br><span class="line">            //ä»é˜Ÿåˆ—ä¸­è·å–æ•°æ®</span><br><span class="line">            v = q.poll();</span><br><span class="line">            boolean empty = v == null;</span><br><span class="line">            // æ£€æŸ¥å¼‚å¸¸</span><br><span class="line">            if (checkTerminated(d, empty, a)) &#123;</span><br><span class="line">                return;</span><br><span class="line">            &#125;</span><br><span class="line">            //å¦‚æœæ²¡æœ‰æ•°æ®äº†ï¼Œè·³å‡º</span><br><span class="line">            if (empty) &#123;</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">            //æ‰§è¡Œä¸‹ä¸€æ¬¡æ“ä½œã€‚</span><br><span class="line">            a.onNext(v);</span><br><span class="line">        &#125;</span><br><span class="line">        //å‡æ‰æ‰§è¡Œçš„æ¬¡æ•°ï¼Œå¹¶è·å–å‰©äºä»»åŠ¡æ•°é‡ï¼Œç„¶åå†æ¬¡å¾ªç¯</span><br><span class="line">        //ç›´åˆ°è·å–å‰©ä½™ä»»åŠ¡é‡ä¸º0ï¼Œè·³å‡ºå¾ªç¯</span><br><span class="line">        missed = addAndGet(-missed);</span><br><span class="line">        if (missed == 0) &#123;</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å…³äºschedulerçš„å…·ä½“å®ç°ï¼Œåœ¨åç»­çš„çº¿ç¨‹åŸç†è¿›è¡Œåˆ†æã€‚è¿™é‡Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“ä¸‹æ¸¸çš„è§‚å¯Ÿè€…çš„onNextåœ¨æŒ‡å®šçš„schedulerçº¿ç¨‹ç­–ç•¥ä¸­æ‰§è¡Œå°±å¯ä»¥äº†ã€‚</p>
<h3 id="subscribe"><a href="#subscribe" class="headerlink" title="subscribe"></a>subscribe</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">@SchedulerSupport(SchedulerSupport.NONE)</span><br><span class="line">   @Override</span><br><span class="line">   public final void subscribe(Observer&lt;? super T&gt; observer) &#123;</span><br><span class="line">       ObjectHelper.requireNonNull(observer, &quot;observer is null&quot;);</span><br><span class="line">       try &#123;</span><br><span class="line">           observer = RxJavaPlugins.onSubscribe(this, observer);</span><br><span class="line"></span><br><span class="line">           ObjectHelper.requireNonNull(observer, &quot;Plugin returned null Observer&quot;);</span><br><span class="line"></span><br><span class="line">           subscribeActual(observer);</span><br><span class="line">       &#125; catch (NullPointerException e) &#123; // NOPMD</span><br><span class="line">           throw e;</span><br><span class="line">       &#125; catch (Throwable e) &#123;</span><br><span class="line">           Exceptions.throwIfFatal(e);</span><br><span class="line">           // can&apos;t call onError because no way to know if a Disposable has been set or not</span><br><span class="line">           // can&apos;t call onSubscribe because the call might have set a Subscription already</span><br><span class="line">           RxJavaPlugins.onError(e);</span><br><span class="line"></span><br><span class="line">           NullPointerException npe = new NullPointerException(&quot;Actually not, but can&apos;t throw other exceptions due to RS&quot;);</span><br><span class="line">           npe.initCause(e);</span><br><span class="line">           throw npe;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p> æœ€åçš„è®¢é˜…æ–¹æ³•åœ¨åšäº†éç©ºæ£€æŸ¥åï¼Œä¼šè°ƒç”¨subscribeActualæ–¹æ³•ï¼Œå¼€å§‹å¾€ä¸Šæ¸¸é€å±‚æ‰§è¡Œè®¢é˜…ã€‚</p>
<h1 id="è¢«è§‚å¯Ÿè€…Observableæ˜¯å¦‚ä½•å‘é€æ•°æ®ï¼Ÿ"><a href="#è¢«è§‚å¯Ÿè€…Observableæ˜¯å¦‚ä½•å‘é€æ•°æ®ï¼Ÿ" class="headerlink" title="è¢«è§‚å¯Ÿè€…Observableæ˜¯å¦‚ä½•å‘é€æ•°æ®ï¼Ÿ"></a>è¢«è§‚å¯Ÿè€…Observableæ˜¯å¦‚ä½•å‘é€æ•°æ®ï¼Ÿ</h1><p>é€šè¿‡ä¸Šé¢çš„æµç¨‹åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ã€‚å¦‚æœä½¿ç”¨createåˆ›å»ºäº†Observableï¼Œåœ¨ObservableOnSubscribeçš„subscribeæ–¹æ³•ä¸­ä¼šé€šè¿‡ObservableEmitterçš„onNextå»å‘é€æ•°æ®ï¼ŒonNextä¼šè§¦å‘å¼€å§‹å¾€ä¸‹æ¸¸è§‚å¯Ÿè€…ä¼ é€’æ•°æ®ã€‚å½“ç„¶rxjavaçš„åˆ›å»ºå‹æ“ä½œç¬¦è¿˜æœ‰å¾ˆå¤šï¼Œå¦‚justã€fromç­‰ï¼Œæœ¬è´¨æœ€åéƒ½æ˜¯è§¦å‘ä¸‹æ¸¸è§‚å¯Ÿè€…çš„onNextè¿›è¡Œæ•°æ®çš„å‘é€ã€‚</p>
<h1 id="è§‚å¯Ÿè€…Observeræ˜¯å¦‚ä½•æ¥æ”¶åˆ°æ•°æ®çš„ï¼Ÿ"><a href="#è§‚å¯Ÿè€…Observeræ˜¯å¦‚ä½•æ¥æ”¶åˆ°æ•°æ®çš„ï¼Ÿ" class="headerlink" title="è§‚å¯Ÿè€…Observeræ˜¯å¦‚ä½•æ¥æ”¶åˆ°æ•°æ®çš„ï¼Ÿ"></a>è§‚å¯Ÿè€…Observeræ˜¯å¦‚ä½•æ¥æ”¶åˆ°æ•°æ®çš„ï¼Ÿ</h1><p>é€šè¿‡æºç åˆ†æï¼Œæ¯ä¸€ä¸ªé“¾å±‚çš„Observeréƒ½ä¼šæŒæœ‰ç›¸é‚»ä¸‹æ¸¸çš„Observerå¯¹è±¡ï¼Œå½“å¼€å§‹å‘é€æ•°æ®æ—¶ï¼Œä¼šä¾æ¬¡é“¾å¼æ‰§è¡ŒObserverçš„onNextæ–¹æ³•ï¼Œæœ€åæ‰§è¡Œåˆ°subscribeæ–¹æ³•ä¸­åˆ›å»ºçš„Observerå¯¹è±¡ã€‚</p>
<h1 id="è¢«è§‚å¯Ÿè€…å’Œè§‚å¯Ÿè€…ä¹‹é—´æ˜¯å¦‚ä½•å®ç°è®¢é˜…ï¼Ÿ"><a href="#è¢«è§‚å¯Ÿè€…å’Œè§‚å¯Ÿè€…ä¹‹é—´æ˜¯å¦‚ä½•å®ç°è®¢é˜…ï¼Ÿ" class="headerlink" title="è¢«è§‚å¯Ÿè€…å’Œè§‚å¯Ÿè€…ä¹‹é—´æ˜¯å¦‚ä½•å®ç°è®¢é˜…ï¼Ÿ"></a>è¢«è§‚å¯Ÿè€…å’Œè§‚å¯Ÿè€…ä¹‹é—´æ˜¯å¦‚ä½•å®ç°è®¢é˜…ï¼Ÿ</h1><p>æ¯ä¸€ä¸ªé“¾å±‚çš„Observable éƒ½ä¼šæŒæœ‰ç›¸é‚»ä¸Šæ¸¸çš„Observableå¯¹è±¡ï¼Œåœ¨subscribeæ–¹æ³•å¼€å§‹è°ƒç”¨åï¼Œæœ€åä¼šæ‰§è¡Œåˆ°subscribeActualæ–¹æ³•ï¼Œåœ¨subscribeActualæ–¹æ³•ä¸­ä¼šå°†è§‚å¯Ÿè€…ä¸ä¸Šæ¸¸çš„è¢«è§‚å¯Ÿæ‰§è¡Œè®¢é˜…ã€‚</p>
<h1 id="rxjavaæ˜¯å¦‚ä½•è¿›è¡Œçº¿ç¨‹çš„è°ƒåº¦ï¼Ÿ"><a href="#rxjavaæ˜¯å¦‚ä½•è¿›è¡Œçº¿ç¨‹çš„è°ƒåº¦ï¼Ÿ" class="headerlink" title="rxjavaæ˜¯å¦‚ä½•è¿›è¡Œçº¿ç¨‹çš„è°ƒåº¦ï¼Ÿ"></a>rxjavaæ˜¯å¦‚ä½•è¿›è¡Œçº¿ç¨‹çš„è°ƒåº¦ï¼Ÿ</h1><p>rxjavaçš„Scheduleræœ‰å¾ˆå¤šç§å®ç°ï¼Œä¸‹é¢æˆ‘ä»¬ä»‹ç»Schedulerçš„ç›¸å…³è¯´æ˜ï¼Œç„¶åé€šè¿‡æœ€å¸¸ç”¨çš„.subscribeOn(Schedulers.io()).observeOn(AndroidSchedulers.mainThread())æ¥åˆ†æå…·ä½“çš„çº¿ç¨‹è°ƒåº¦æµç¨‹ã€‚</p>
<h2 id="Scheduler"><a href="#Scheduler" class="headerlink" title="Scheduler"></a>Scheduler</h2><p> æˆ‘ä»¬åœ¨è°ƒç”¨subscribeOnä¸observeOnæ—¶ï¼Œéƒ½ä¼šä¼ å…¥Schedulerå¯¹è±¡ï¼Œé¦–å…ˆæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹Schedulerçš„ç§ç±»åŠå…¶åŠŸèƒ½</p>
<table>
<thead>
<tr>
<th>Schedulerç§ç±»</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>Schedulers.io(â€¯)</td>
<td>ç”¨äºIOå¯†é›†å‹çš„æ“ä½œï¼Œä¾‹å¦‚è¯»å†™SDå¡æ–‡ä»¶ï¼ŒæŸ¥è¯¢æ•°æ®åº“ï¼Œè®¿é—®ç½‘ç»œç­‰ï¼Œå…·æœ‰çº¿ç¨‹ç¼“å­˜æœºåˆ¶ï¼Œåœ¨æ­¤è°ƒåº¦å™¨æ¥æ”¶åˆ°ä»»åŠ¡åï¼Œå…ˆæ£€æŸ¥çº¿ç¨‹ç¼“å­˜æ± ä¸­ï¼Œæ˜¯å¦æœ‰ç©ºé—²çš„çº¿ç¨‹ï¼Œå¦‚æœæœ‰ï¼Œåˆ™å¤ç”¨ï¼Œå¦‚æœæ²¡æœ‰åˆ™åˆ›å»ºæ–°çš„çº¿ç¨‹ï¼Œå¹¶åŠ å…¥åˆ°çº¿ç¨‹æ± ä¸­ï¼Œå¦‚æœæ¯æ¬¡éƒ½æ²¡æœ‰ç©ºé—²çº¿ç¨‹ä½¿ç”¨ï¼Œå¯ä»¥æ— ä¸Šé™çš„åˆ›å»ºæ–°çº¿ç¨‹</td>
</tr>
<tr>
<td>Schedulers.newThread(â€¯)</td>
<td>åœ¨æ¯æ‰§è¡Œä¸€ä¸ªä»»åŠ¡æ—¶åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹ï¼Œä¸å…·æœ‰çº¿ç¨‹ç¼“å­˜æœºåˆ¶ï¼Œå› ä¸ºåˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹æ¯”å¤ç”¨ä¸€ä¸ªçº¿ç¨‹æ›´è€—æ—¶è€—åŠ›ï¼Œè™½ç„¶ä½¿ç”¨Schedulers.io(â€¯)çš„åœ°æ–¹ï¼Œéƒ½å¯ä»¥ä½¿ç”¨Schedulers.newThread(â€¯)ï¼Œä½†æ˜¯ï¼ŒSchedulers.newThread(â€¯)çš„æ•ˆç‡æ²¡æœ‰Schedulers.io(â€¯)é«˜</td>
</tr>
<tr>
<td>Schedulers.computation()</td>
<td>ç”¨äºCPU å¯†é›†å‹è®¡ç®—ä»»åŠ¡ï¼Œå³ä¸ä¼šè¢« I/O ç­‰æ“ä½œé™åˆ¶æ€§èƒ½çš„è€—æ—¶æ“ä½œï¼Œä¾‹å¦‚xml,jsonæ–‡ä»¶çš„è§£æï¼ŒBitmapå›¾ç‰‡çš„å‹ç¼©å–æ ·ç­‰ï¼Œå…·æœ‰å›ºå®šçš„çº¿ç¨‹æ± ï¼Œå¤§å°ä¸ºCPUçš„æ ¸æ•°ã€‚ä¸å¯ä»¥ç”¨äºI/Oæ“ä½œï¼Œå› ä¸ºI/Oæ“ä½œçš„ç­‰å¾…æ—¶é—´ä¼šæµªè´¹CPU</td>
</tr>
<tr>
<td>Schedulers.trampoline()</td>
<td>åœ¨å½“å‰çº¿ç¨‹ç«‹å³æ‰§è¡Œä»»åŠ¡ï¼Œå¦‚æœå½“å‰çº¿ç¨‹æœ‰ä»»åŠ¡åœ¨æ‰§è¡Œï¼Œåˆ™ä¼šå°†å…¶æš‚åœï¼Œç­‰æ’å…¥è¿›æ¥çš„ä»»åŠ¡æ‰§è¡Œå®Œä¹‹åï¼Œå†å°†æœªå®Œæˆçš„ä»»åŠ¡æ¥ç€æ‰§è¡Œ</td>
</tr>
<tr>
<td>Schedulers.single()</td>
<td>æ‹¥æœ‰ä¸€ä¸ªçº¿ç¨‹å•ä¾‹ï¼Œæ‰€æœ‰çš„ä»»åŠ¡éƒ½åœ¨è¿™ä¸€ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œï¼Œå½“æ­¤çº¿ç¨‹ä¸­æœ‰ä»»åŠ¡æ‰§è¡Œæ—¶ï¼Œå…¶ä»–ä»»åŠ¡å°†ä¼šæŒ‰ç…§å…ˆè¿›å…ˆå‡ºçš„é¡ºåºä¾æ¬¡æ‰§è¡Œ</td>
</tr>
<tr>
<td>Scheduler.from(Executor executor)</td>
<td>æŒ‡å®šä¸€ä¸ªçº¿ç¨‹è°ƒåº¦å™¨ï¼Œç”±æ­¤è°ƒåº¦å™¨æ¥æ§åˆ¶ä»»åŠ¡çš„æ‰§è¡Œç­–ç•¥</td>
</tr>
<tr>
<td>AndroidSchedulers.mainThread()</td>
<td>åœ¨Android UIçº¿ç¨‹ä¸­æ‰§è¡Œä»»åŠ¡ï¼Œä¸ºAndroidå¼€å‘å®šåˆ¶</td>
</tr>
</tbody>
</table>
<h2 id="subscribeOn-Schedulers-io"><a href="#subscribeOn-Schedulers-io" class="headerlink" title="subscribeOn(Schedulers.io())"></a>subscribeOn(Schedulers.io())</h2><p> æ ¹æ®ä¸Šé¢çš„åˆ†æï¼ŒsubscribeOn()æ–¹æ³•æœ€åä¼šæ‰§è¡Œåˆ°subscribeActualæ–¹æ³•ï¼ŒSubscribeTaskä¸Šé¢åˆ†æäº†ï¼Œç»§æ‰¿äº†Runnableæ¥å£ï¼Œ runæ–¹æ³•æœ€åä¼šæ‰§è¡Œsource.subscribe(parent)æ–¹æ³•ã€‚<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">   public void subscribeActual(final Observer&lt;? super T&gt; s) &#123;</span><br><span class="line">       final SubscribeOnObserver&lt;T&gt; parent = new SubscribeOnObserver&lt;T&gt;(s);</span><br><span class="line"></span><br><span class="line">       s.onSubscribe(parent);</span><br><span class="line">       </span><br><span class="line">       parent.setDisposable(scheduler.scheduleDirect(new SubscribeTask(parent)));</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></p>
<p>  è¿™é‡Œæˆ‘ä»¬ä¸»è¦è¦åˆ†æscheduler.scheduleDirect()æ–¹æ³•ã€‚<br>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">@NonNull</span><br><span class="line"> public Disposable scheduleDirect(@NonNull Runnable run) &#123;</span><br><span class="line">     return scheduleDirect(run, 0L, TimeUnit.NANOSECONDS);</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line">  @NonNull</span><br><span class="line"> public Disposable scheduleDirect(@NonNull Runnable run, long delay, @NonNull TimeUnit unit) &#123;</span><br><span class="line">   //åˆ›å»ºä¸€ä¸ªWorkerå¯¹è±¡</span><br><span class="line">     final Worker w = createWorker();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">     final Runnable decoratedRun = RxJavaPlugins.onSchedule(run);</span><br><span class="line">     </span><br><span class="line">     //DisposeTaskyä¹Ÿæ˜¯ä¸€ä¸ªåŒ…è£…ç±» ç»§æ‰¿äº†Runnableæ¥å£</span><br><span class="line">     DisposeTask task = new DisposeTask(decoratedRun, w);</span><br><span class="line"></span><br><span class="line">     //è¿™é‡Œæ˜¯å…³é”®çš„å®ç°ï¼Œæ‰§è¡Œäº†workerçš„scheduleæ–¹æ³•</span><br><span class="line">     w.schedule(task, delay, unit);</span><br><span class="line"></span><br><span class="line">     return task;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></p>
<p>  Workerçš„scheduleæ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ–¹æ³•ï¼ŒSchedulers.io()å¯¹åº”çš„Workerå®ç°ä¸ºEventLoopWorkerã€‚æˆ‘ä»¬çœ‹çœ‹EventLoopWorkerçš„scheduleå®ç°å¦‚ä¸‹ï¼š<br>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">   static final class EventLoopWorker extends Scheduler.Worker &#123;</span><br><span class="line">    private final CompositeDisposable tasks;</span><br><span class="line">    private final CachedWorkerPool pool;</span><br><span class="line">    private final ThreadWorker threadWorker;</span><br><span class="line"></span><br><span class="line">    final AtomicBoolean once = new AtomicBoolean();</span><br><span class="line"></span><br><span class="line">    EventLoopWorker(CachedWorkerPool pool) &#123;</span><br><span class="line">        this.pool = pool;</span><br><span class="line">        this.tasks = new CompositeDisposable();</span><br><span class="line">        this.threadWorker = pool.get();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void dispose() &#123;</span><br><span class="line">        if (once.compareAndSet(false, true)) &#123;</span><br><span class="line">            tasks.dispose();</span><br><span class="line"></span><br><span class="line">            // releasing the pool should be the last action</span><br><span class="line">            pool.release(threadWorker);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public boolean isDisposed() &#123;</span><br><span class="line">        return once.get();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @NonNull</span><br><span class="line">    @Override</span><br><span class="line">    public Disposable schedule(@NonNull Runnable action, long delayTime, @NonNull TimeUnit unit) &#123;</span><br><span class="line">        if (tasks.isDisposed()) &#123;</span><br><span class="line">            // don&apos;t schedule, we are unsubscribed</span><br><span class="line">            return EmptyDisposable.INSTANCE;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return threadWorker.scheduleActual(action, delayTime, unit, tasks);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>  è¿™é‡Œä¼šæ‰§è¡Œåˆ° threadWorkerçš„scheduleActualæ–¹æ³•ï¼Œç»§ç»­å¾€ä¸‹çœ‹<br>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">public ScheduledRunnable scheduleActual(final Runnable run, long delayTime, @NonNull TimeUnit unit, @Nullable DisposableContainer parent) &#123;</span><br><span class="line">     Runnable decoratedRun = RxJavaPlugins.onSchedule(run);</span><br><span class="line"></span><br><span class="line">     ScheduledRunnable sr = new ScheduledRunnable(decoratedRun, parent);</span><br><span class="line"></span><br><span class="line">     if (parent != null) &#123;</span><br><span class="line">         if (!parent.add(sr)) &#123;</span><br><span class="line">             return sr;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     Future&lt;?&gt; f;</span><br><span class="line">     try &#123;</span><br><span class="line">         if (delayTime &lt;= 0) &#123;</span><br><span class="line">             f = executor.submit((Callable&lt;Object&gt;)sr);</span><br><span class="line">         &#125; else &#123;</span><br><span class="line">             f = executor.schedule((Callable&lt;Object&gt;)sr, delayTime, unit);</span><br><span class="line">         &#125;</span><br><span class="line">         sr.setFuture(f);</span><br><span class="line">     &#125; catch (RejectedExecutionException ex) &#123;</span><br><span class="line">         if (parent != null) &#123;</span><br><span class="line">             parent.remove(sr);</span><br><span class="line">         &#125;</span><br><span class="line">         RxJavaPlugins.onError(ex);</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     return sr;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></p>
<p>  åœ¨è¿™é‡Œä¼šä½¿ç”¨executoræœ€ç»ˆå»æ‰§è¡Œrunæ–¹æ³•ã€‚å½“ç„¶çœ‹åˆ°è¿™é‡Œæœ‰ä¸€ä¸ªç–‘é—®IoScheduleråœ¨è¿™é‡Œæ˜¯æ€ä¹ˆå®ç°çº¿ç¨‹çš„å¤ç”¨å‘¢ï¼Ÿæˆ‘ä»¬çœ‹çœ‹threadWorkeråœ¨IoSchedulerä¸­çš„çº¿ç¨‹çš„åˆ›å»ºï¼Œå¦‚ä¸‹ï¼š</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">EventLoopWorker(CachedWorkerPool pool) &#123;</span><br><span class="line">        this.pool = pool;</span><br><span class="line">        this.tasks = new CompositeDisposable();</span><br><span class="line">        this.threadWorker = pool.get();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>  è¿™é‡Œä¼šé€šè¿‡ç»´æŠ¤ä¸€ä¸ªWorkerçš„çº¿ç¨‹æ± æ¥è¾¾åˆ°çº¿ç¨‹å¤ç”¨çš„æ•ˆæœï¼Œå…·ä½“æˆ‘ä»¬çœ‹çœ‹CachedWorkerPoolçš„getæ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š<br>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">ThreadWorker get() &#123;</span><br><span class="line">      if (allWorkers.isDisposed()) &#123;</span><br><span class="line">          return SHUTDOWN_THREAD_WORKER;</span><br><span class="line">      &#125;</span><br><span class="line">      //ä»å·²ç»releaseçš„workçº¿ç¨‹é˜Ÿåˆ—ä¸­è·å–ç¼“å­˜</span><br><span class="line">      while (!expiringWorkerQueue.isEmpty()) &#123;</span><br><span class="line">          ThreadWorker threadWorker = expiringWorkerQueue.poll();</span><br><span class="line">          //å¦‚æœæ‰¾åˆ°ï¼Œè¿”å›å¤ç”¨çš„çº¿ç¨‹</span><br><span class="line">          if (threadWorker != null) &#123;</span><br><span class="line">              return threadWorker;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      // å¦‚æœæ²¡æœ‰ï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ThreadWorker</span><br><span class="line">      ThreadWorker w = new ThreadWorker(threadFactory);</span><br><span class="line">      allWorkers.add(w);</span><br><span class="line">      return w;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="observeOn-AndroidSchedulers-mainThread"><a href="#observeOn-AndroidSchedulers-mainThread" class="headerlink" title="observeOn(AndroidSchedulers.mainThread())"></a>observeOn(AndroidSchedulers.mainThread())</h2> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">protected void subscribeActual(Observer&lt;? super T&gt; observer) &#123;</span><br><span class="line">    //å¦‚æœæŒ‡å®šå½“å‰çº¿ç¨‹ åˆ™ä¸è¿›è¡Œè°ƒåº¦</span><br><span class="line">    if (scheduler instanceof TrampolineScheduler) &#123;</span><br><span class="line">        source.subscribe(observer);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        //åˆ›å»ºWorker</span><br><span class="line">        Scheduler.Worker w = scheduler.createWorker();</span><br><span class="line">        //å®ä¾‹åŒ–ObserveOnObserverè§‚å¯Ÿè€…å¹¶ä¼ å…¥Worker</span><br><span class="line">        source.subscribe(new ObserveOnObserver&lt;T&gt;(observer, w, delayError, bufferSize));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> è¿™é‡Œæˆ‘ä»¬ä¸»è¦éœ€è¦åˆ†æObserveOnObserverå¯¹è±¡ï¼ŒonNextå®ç°å¦‚ä¸‹ï¼š<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">      public void onNext(T t) &#123;</span><br><span class="line">          if (done) &#123;</span><br><span class="line">              return;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          if (sourceMode != QueueDisposable.ASYNC) &#123;</span><br><span class="line">              queue.offer(t);</span><br><span class="line">          &#125;</span><br><span class="line">          schedule();</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">       void schedule() &#123;</span><br><span class="line">          if (getAndIncrement() == 0) &#123;</span><br><span class="line">              worker.schedule(this);</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure></p>
<p> å…³é”®è¿˜æ˜¯æ‰§è¡Œäº†workerçš„scheduleï¼ŒAndroidSchedulersçš„å®ç°ä¸»è¦ä¸ºHandlerSchedulerï¼ŒHandlerSchedulerä¸­å…³äºWorkerçš„å®ç°ä¸ºHandlerWorkerï¼Œæˆ‘ä»¬çœ‹ä¸‹scheduleçš„å®ç°å¦‚ä¸‹ï¼š<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">public Disposable schedule(Runnable run, long delay, TimeUnit unit) &#123;</span><br><span class="line">           if (run == null) throw new NullPointerException(&quot;run == null&quot;);</span><br><span class="line">           if (unit == null) throw new NullPointerException(&quot;unit == null&quot;);</span><br><span class="line"></span><br><span class="line">           if (disposed) &#123;</span><br><span class="line">               return Disposables.disposed();</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           run = RxJavaPlugins.onSchedule(run);</span><br><span class="line"></span><br><span class="line">           ScheduledRunnable scheduled = new ScheduledRunnable(handler, run);</span><br><span class="line"></span><br><span class="line">           Message message = Message.obtain(handler, scheduled);</span><br><span class="line">           message.obj = this; // Used as token for batch disposal of this worker&apos;s runnables.</span><br><span class="line"></span><br><span class="line">           if (async) &#123;</span><br><span class="line">               message.setAsynchronous(true);</span><br><span class="line">           &#125;</span><br><span class="line">           //é€šè¿‡handlerå‘é€æ¶ˆæ¯æ‰§è¡Œrunæ¥å£</span><br><span class="line">           handler.sendMessageDelayed(message, unit.toMillis(delay));</span><br><span class="line"></span><br><span class="line">           // Re-check disposed state for removing in case we were racing a call to dispose().</span><br><span class="line">           if (disposed) &#123;</span><br><span class="line">               handler.removeCallbacks(scheduled);</span><br><span class="line">               return Disposables.disposed();</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           return scheduled;</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure></p>
<p> å…³äºhandlerçš„å®ä¾‹ï¼Œæˆ‘ä»¬çœ‹AndroidSchedulersä¸­çš„åˆ›å»ºå¦‚ä¸‹ï¼š<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">private static final class MainHolder &#123;</span><br><span class="line">       static final Scheduler DEFAULT</span><br><span class="line">           = new HandlerScheduler(new Handler(Looper.getMainLooper()), false);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></p>
<p> ç»¼ä¸Šå¯çŸ¥AndroidSchedulers.mainThread()æ˜¯é€šè¿‡æ¶ˆæ¯å°†runæ–¹æ³•çš„å®ç°äº¤ç”±ä¸»çº¿ç¨‹Looperè¿›è¡Œå¤„ç†ï¼Œè¾¾åˆ°å°†è§‚å¯Ÿè€…çš„æ•°æ®å¤„ç†åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œçš„æ•ˆæœ</p>
<h1 id="rxjavaèƒŒå‹ç­–ç•¥å®ç°åŸç†æ˜¯æ€æ ·çš„ï¼Ÿ"><a href="#rxjavaèƒŒå‹ç­–ç•¥å®ç°åŸç†æ˜¯æ€æ ·çš„ï¼Ÿ" class="headerlink" title="rxjavaèƒŒå‹ç­–ç•¥å®ç°åŸç†æ˜¯æ€æ ·çš„ï¼Ÿ"></a>rxjavaèƒŒå‹ç­–ç•¥å®ç°åŸç†æ˜¯æ€æ ·çš„ï¼Ÿ</h1><h2 id="èƒŒå‹ï¼ˆbackpressureï¼‰"><a href="#èƒŒå‹ï¼ˆbackpressureï¼‰" class="headerlink" title="èƒŒå‹ï¼ˆbackpressureï¼‰"></a>èƒŒå‹ï¼ˆbackpressureï¼‰</h2><p>å½“ä¸Šä¸‹æ¸¸åœ¨ä¸åŒçš„çº¿ç¨‹ä¸­ï¼Œé€šè¿‡Observableå‘å°„ï¼Œå¤„ç†ï¼Œå“åº”æ•°æ®æµæ—¶ï¼Œå¦‚æœä¸Šæ¸¸å‘å°„æ•°æ®çš„é€Ÿåº¦å¿«äºä¸‹æ¸¸æ¥æ”¶å¤„ç†æ•°æ®çš„é€Ÿåº¦ï¼Œè¿™æ ·å¯¹äºé‚£äº›æ²¡æ¥åŠå¤„ç†çš„æ•°æ®å°±ä¼šé€ æˆç§¯å‹ï¼Œè¿™äº›æ•°æ®æ—¢ä¸ä¼šä¸¢å¤±ï¼Œä¹Ÿä¸ä¼šè¢«åƒåœ¾å›æ”¶æœºåˆ¶å›æ”¶ï¼Œè€Œæ˜¯å­˜æ”¾åœ¨ä¸€ä¸ªå¼‚æ­¥ç¼“å­˜æ± ä¸­ï¼Œå¦‚æœç¼“å­˜æ± ä¸­çš„æ•°æ®ä¸€ç›´å¾—ä¸åˆ°å¤„ç†ï¼Œè¶Šç§¯è¶Šå¤šï¼Œæœ€åå°±ä¼šé€ æˆå†…å­˜æº¢å‡ºï¼Œè¿™ä¾¿æ˜¯å“åº”å¼ç¼–ç¨‹ä¸­çš„èƒŒå‹ï¼ˆbackpressureï¼‰é—®é¢˜ã€‚</p>
<h2 id="èƒŒå‹å¤„ç†æœºåˆ¶"><a href="#èƒŒå‹å¤„ç†æœºåˆ¶" class="headerlink" title="èƒŒå‹å¤„ç†æœºåˆ¶"></a>èƒŒå‹å¤„ç†æœºåˆ¶</h2><p>rxjava2.xä½¿ç”¨Flowableæ¥æ”¯æŒèƒŒå‹çš„æœºåˆ¶ï¼Œè°ƒç”¨createæ–¹æ³•æ—¶éœ€è¦ä¼ å…¥BackpressureStrategyç­–ç•¥ã€‚</p>
<table>
<thead>
<tr>
<th>Strategy</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody>
<tr>
<td>MISSING</td>
<td>æ­¤ç­–ç•¥è¡¨ç¤ºï¼Œé€šè¿‡Createæ–¹æ³•åˆ›å»ºçš„Flowableæ²¡æœ‰æŒ‡å®šèƒŒå‹ç­–ç•¥ï¼Œä¸ä¼šå¯¹é€šè¿‡OnNextå‘å°„çš„æ•°æ®åšç¼“å­˜æˆ–ä¸¢å¼ƒå¤„ç†ï¼Œéœ€è¦ä¸‹æ¸¸é€šè¿‡èƒŒå‹æ“ä½œç¬¦ï¼ˆonBackpressureBuffer()/onBackpressureDrop()/onBackpressureLatest()ï¼‰æŒ‡å®šèƒŒå‹ç­–ç•¥</td>
</tr>
<tr>
<td>ERROR</td>
<td>åœ¨æ­¤ç­–ç•¥ä¸‹ï¼Œå¦‚æœæ”¾å…¥Flowableçš„å¼‚æ­¥ç¼“å­˜æ± ä¸­çš„æ•°æ®è¶…é™äº†ï¼Œåˆ™ä¼šæŠ›å‡ºMissingBackpressureExceptionå¼‚å¸¸</td>
</tr>
<tr>
<td>BUFFER</td>
<td>æ­¤ç­–ç•¥ä¸‹ï¼ŒFlowableçš„å¼‚æ­¥ç¼“å­˜æ± åŒObservableçš„ä¸€æ ·ï¼Œæ²¡æœ‰å›ºå®šå¤§å°ï¼Œå¯ä»¥æ— é™åˆ¶å‘é‡Œæ·»åŠ æ•°æ®ï¼Œä¸ä¼šæŠ›å‡ºMissingBackpressureExceptionå¼‚å¸¸ï¼Œä½†ä¼šå¯¼è‡´OOM</td>
</tr>
<tr>
<td>DROP</td>
<td>åœ¨æ­¤ç­–ç•¥ä¸‹ï¼Œå¦‚æœFlowableçš„å¼‚æ­¥ç¼“å­˜æ± æ»¡äº†ï¼Œä¼šä¸¢æ‰ä¸Šæ¸¸å‘é€çš„æ•°æ®</td>
</tr>
<tr>
<td>LATEST</td>
<td>ä¸Dropç­–ç•¥ä¸€æ ·ï¼Œå¦‚æœç¼“å­˜æ± æ»¡äº†ï¼Œä¼šä¸¢æ‰å°†è¦æ”¾å…¥ç¼“å­˜æ± ä¸­çš„æ•°æ®ï¼Œä¸åŒçš„æ˜¯ï¼Œä¸ç®¡ç¼“å­˜æ± çš„çŠ¶æ€å¦‚ä½•ï¼ŒLATESTéƒ½ä¼šå°†æœ€åä¸€æ¡æ•°æ®å¼ºè¡Œæ”¾å…¥ç¼“å­˜æ± ä¸­</td>
</tr>
</tbody>
</table>
<h2 id="å®ç°åŸç†"><a href="#å®ç°åŸç†" class="headerlink" title="å®ç°åŸç†"></a>å®ç°åŸç†</h2><p>é¦–å…ˆçœ‹çœ‹Flowableçš„createå®ç°<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public static &lt;T&gt; Flowable&lt;T&gt; create(FlowableOnSubscribe&lt;T&gt; source, BackpressureStrategy mode) &#123;</span><br><span class="line">       ObjectHelper.requireNonNull(source, &quot;source is null&quot;);</span><br><span class="line">       ObjectHelper.requireNonNull(mode, &quot;mode is null&quot;);</span><br><span class="line">       return RxJavaPlugins.onAssembly(new FlowableCreate&lt;T&gt;(source, mode));</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></p>
<p>è¿™é‡Œä¼šåˆ›å»ºä¸€ä¸ªFlowableCreateå¯¹è±¡ï¼Œå¹¶ä¼ å…¥æŒ‡å®šçš„BackpressureStrategyç­–ç•¥ã€‚æ¥ç€çœ‹çœ‹FlowableCreateçš„è®¢é˜…æ–¹æ³•</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">   public void subscribeActual(Subscriber&lt;? super T&gt; t) &#123;</span><br><span class="line">       BaseEmitter&lt;T&gt; emitter;</span><br><span class="line">       //æ ¹æ®ä¸åŒçš„ç­–ç•¥åˆå§‹åŒ–ä¸åŒçš„æ•°æ®å‘å°„å™¨</span><br><span class="line">       switch (backpressure) &#123;</span><br><span class="line">       case MISSING: &#123;</span><br><span class="line">           emitter = new MissingEmitter&lt;T&gt;(t);</span><br><span class="line">           break;</span><br><span class="line">       &#125;</span><br><span class="line">       case ERROR: &#123;</span><br><span class="line">           emitter = new ErrorAsyncEmitter&lt;T&gt;(t);</span><br><span class="line">           break;</span><br><span class="line">       &#125;</span><br><span class="line">       case DROP: &#123;</span><br><span class="line">           emitter = new DropAsyncEmitter&lt;T&gt;(t);</span><br><span class="line">           break;</span><br><span class="line">       &#125;</span><br><span class="line">       case LATEST: &#123;</span><br><span class="line">           emitter = new LatestAsyncEmitter&lt;T&gt;(t);</span><br><span class="line">           break;</span><br><span class="line">       &#125;</span><br><span class="line">       default: &#123;</span><br><span class="line">           emitter = new BufferAsyncEmitter&lt;T&gt;(t, bufferSize());</span><br><span class="line">           break;</span><br><span class="line">       &#125;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       t.onSubscribe(emitter);</span><br><span class="line">       try &#123;</span><br><span class="line">           source.subscribe(emitter);</span><br><span class="line">       &#125; catch (Throwable ex) &#123;</span><br><span class="line">           Exceptions.throwIfFatal(ex);</span><br><span class="line">           emitter.onError(ex);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<h3 id="BaseEmitter"><a href="#BaseEmitter" class="headerlink" title="BaseEmitter"></a>BaseEmitter</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">abstract static class BaseEmitter&lt;T&gt;</span><br><span class="line">    extends AtomicLong</span><br><span class="line">    implements FlowableEmitter&lt;T&gt;, Subscription &#123;</span><br><span class="line">        private static final long serialVersionUID = 7326289992464377023L;</span><br><span class="line"></span><br><span class="line">        final Subscriber&lt;? super T&gt; actual;</span><br><span class="line"></span><br><span class="line">        final SequentialDisposable serial;</span><br><span class="line"></span><br><span class="line">        BaseEmitter(Subscriber&lt;? super T&gt; actual) &#123;</span><br><span class="line">            this.actual = actual;</span><br><span class="line">            this.serial = new SequentialDisposable();</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">    //è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒRequestæœ€ç»ˆä¼šæŠŠnè´Ÿè´£ç»™AtomicLong</span><br><span class="line">   @Override</span><br><span class="line">        public final void request(long n) &#123;</span><br><span class="line">            if (SubscriptionHelper.validate(n)) &#123;</span><br><span class="line">                BackpressureHelper.add(this, n);</span><br><span class="line">                onRequested();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">//çœç•¥å…¶ä»–è‹¥å¹²æ–¹æ³•</span><br></pre></td></tr></table></figure>
<p>é€šè¿‡ä¸Šé¢çš„ç»“æŸæˆ‘ä»¬çŸ¥é“Flowableæœ‰ä¸€ä¸ªç¼“å†²æ± ï¼Œé‚£ä¸ªè¿™ä¸ªå¤§å°æ˜¯å¤šå°‘ï¼Œåœ¨å“ªé‡Œè¿›è¡Œå¤åˆ¶ç»™å‘å°„å™¨å‘¢ï¼Ÿ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//é•¿åº¦æ˜¯128</span><br><span class="line">  static final int BUFFER_SIZE;</span><br><span class="line">  static &#123;</span><br><span class="line">      BUFFER_SIZE = Math.max(1, Integer.getInteger(&quot;rx2.buffer-size&quot;, 128));</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line"> public static int bufferSize() &#123;</span><br><span class="line">      return BUFFER_SIZE;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  //åœ¨è°ƒç”¨observeOnæ—¶ï¼Œä¼šå°†é•¿åº¦æœ€åä¼ ç»™emitterå‘å°„å™¨ï¼Œå…·ä½“å¯ä»¥æ‰“æ–­çš„è¿½è¸ªæŸ¥çœ‹è°ƒç”¨é“¾</span><br><span class="line">  public final Flowable&lt;T&gt; observeOn(Scheduler scheduler) &#123;</span><br><span class="line">      return observeOn(scheduler, false, bufferSize());</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="MissingEmitter"><a href="#MissingEmitter" class="headerlink" title="MissingEmitter"></a>MissingEmitter</h3><p>ä¸ä¼šå¯¹é€šè¿‡OnNextå‘å°„çš„æ•°æ®åšç¼“å­˜æˆ–ä¸¢å¼ƒå¤„ç†<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">     public void onNext(T t) &#123;</span><br><span class="line">         if (isCancelled()) &#123;</span><br><span class="line">             return;</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         if (t != null) &#123;</span><br><span class="line">             actual.onNext(t);</span><br><span class="line">         &#125; else &#123;</span><br><span class="line">             onError(new NullPointerException(&quot;onNext called with null. Null values are generally not allowed in 2.x operators and sources.&quot;));</span><br><span class="line">             return;</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         for (;;) &#123;</span><br><span class="line">             long r = get();</span><br><span class="line">             if (r == 0L || compareAndSet(r, r - 1)) &#123;</span><br><span class="line">                 return;</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="NoOverflowBaseAsyncEmitter"><a href="#NoOverflowBaseAsyncEmitter" class="headerlink" title="NoOverflowBaseAsyncEmitter"></a>NoOverflowBaseAsyncEmitter</h3><p>DropAsyncEmitterå’ŒErrorAsyncEmitterç»§æ‰¿äº†NoOverflowBaseAsyncEmitter<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">      public final void onNext(T t) &#123;</span><br><span class="line">          if (isCancelled()) &#123;</span><br><span class="line">              return;</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          if (t == null) &#123;</span><br><span class="line">              onError(new NullPointerException(&quot;onNext called with null. Null values are generally not allowed in 2.x operators and sources.&quot;));</span><br><span class="line">              return;</span><br><span class="line">          &#125;</span><br><span class="line">          //å¦‚æœæ•°é‡ä¸ä¸º0åˆ™å‡1ï¼Œé€šè¿‡ä¸Šé¢çš„Requestï¼Œå¯ä»¥çŸ¥é“getï¼ˆï¼‰ä¸ºFlowableçš„BUFFER_SIZE 128</span><br><span class="line">          if (get() != 0) &#123;</span><br><span class="line">              actual.onNext(t);</span><br><span class="line">              BackpressureHelper.produced(this, 1);</span><br><span class="line">          &#125; else &#123;</span><br><span class="line">              //è¶…å‡ºé˜ˆå€¼ æ‰§è¡ŒonOverflow</span><br><span class="line">              onOverflow();</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="DropAsyncEmitter"><a href="#DropAsyncEmitter" class="headerlink" title="DropAsyncEmitter"></a>DropAsyncEmitter</h3><p>å¦‚æœFlowableçš„å¼‚æ­¥ç¼“å­˜æ± æ»¡äº†ï¼Œä¼šä¸¢æ‰ä¸Šæ¸¸å‘é€çš„æ•°æ®<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">static final class DropAsyncEmitter&lt;T&gt; extends NoOverflowBaseAsyncEmitter&lt;T&gt; &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      private static final long serialVersionUID = 8360058422307496563L;</span><br><span class="line"></span><br><span class="line">      DropAsyncEmitter(Subscriber&lt;? super T&gt; actual) &#123;</span><br><span class="line">          super(actual);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      @Override</span><br><span class="line">      void onOverflow() &#123;</span><br><span class="line">          // nothing to do</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="ErrorAsyncEmitter"><a href="#ErrorAsyncEmitter" class="headerlink" title="ErrorAsyncEmitter"></a>ErrorAsyncEmitter</h3><p>å¦‚æœFlowableçš„å¼‚æ­¥ç¼“å­˜æ± æ»¡äº†ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">static final class ErrorAsyncEmitter&lt;T&gt; extends NoOverflowBaseAsyncEmitter&lt;T&gt; &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    private static final long serialVersionUID = 338953216916120960L;</span><br><span class="line"></span><br><span class="line">    ErrorAsyncEmitter(Subscriber&lt;? super T&gt; actual) &#123;</span><br><span class="line">        super(actual);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    void onOverflow() &#123;</span><br><span class="line">        onError(new MissingBackpressureException(&quot;create: could not emit value due to lack of requests&quot;));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="BufferAsyncEmitter"><a href="#BufferAsyncEmitter" class="headerlink" title="BufferAsyncEmitter"></a>BufferAsyncEmitter</h3><p>Flowableçš„å¼‚æ­¥ç¼“å­˜æ± åŒObservableçš„ä¸€æ ·ï¼Œæ²¡æœ‰å›ºå®šå¤§å°ï¼Œå¯ä»¥æ— é™åˆ¶å‘é‡Œæ·»åŠ æ•°æ®<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">  public void onNext(T t) &#123;</span><br><span class="line">      if (done || isCancelled()) &#123;</span><br><span class="line">          return;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      if (t == null) &#123;</span><br><span class="line">          onError(new NullPointerException(&quot;onNext called with null. Null values are generally not allowed in 2.x operators and sources.&quot;));</span><br><span class="line">          return;</span><br><span class="line">      &#125;</span><br><span class="line">      //åŠ å…¥é˜Ÿåˆ— queueä¸ºSpscLinkedArrayQueueé˜Ÿåˆ—</span><br><span class="line">      queue.offer(t);</span><br><span class="line">      //é€šçŸ¥æ¶ˆè´¹</span><br><span class="line">      drain();</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="LatestAsyncEmitter"><a href="#LatestAsyncEmitter" class="headerlink" title="LatestAsyncEmitter"></a>LatestAsyncEmitter</h3><p>Flowableçš„å¼‚æ­¥ç¼“å­˜æ± åŒObservableçš„ä¸€æ ·ï¼Œæ²¡æœ‰å›ºå®šå¤§å°ï¼Œå¯ä»¥æ— é™åˆ¶å‘é‡Œæ·»åŠ æ•°æ®<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">  public void onNext(T t) &#123;</span><br><span class="line">     if (done || isCancelled()) &#123;</span><br><span class="line">          return;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      if (t == null) &#123;</span><br><span class="line">          onError(new NullPointerException(&quot;onNext called with null. Null values are generally not allowed in 2.x operators and sources.&quot;));</span><br><span class="line">          return;</span><br><span class="line">      &#125;</span><br><span class="line">      //è¿›è¡Œè¦†ç›– queueä¸ºAtomicReference</span><br><span class="line">      queue.set(t);</span><br><span class="line">       //é€šçŸ¥æ¶ˆè´¹</span><br><span class="line">      drain();</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><h2 id="æ€è€ƒ"><a href="#æ€è€ƒ" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h2><p>æœ¬æ–‡ä¸»è¦å¯¹rxjavaçš„é“¾å¼æ‰§è¡Œæµç¨‹ã€çº¿ç¨‹è°ƒåº¦ä»¥åŠèƒŒå‹æœºåˆ¶è¿›è¡Œæ¢³ç†åˆ†æã€‚rxjavaçš„åº“è¿˜æœ‰éå¸¸å¤šçš„æ“ä½œç¬¦åŠåŠŸèƒ½,å¸Œæœ›åç»­æœ‰æ—¶é—´ç»§ç»­è¿›è¡Œåˆ†æã€‚rxjavaçš„æºç åŠä¸€äº›æ¦‚å¿µå‘½åè¿˜æ˜¯ç›¸å¯¹æ¯”è¾ƒå¤æ‚ï¼Œå‰å‰ååå¤§çº¦èŠ±äº†2å‘¨çš„æ—¶é—´è¿›è¡Œæºç çš„å­¦ä¹ ï¼ŒåšæŒä¸‹æ¥äº†ï¼Œè¿˜æ˜¯æ”¶è·æ»¡æ»¡ã€‚</p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p> <a href="https://www.jianshu.com/p/0cd258eecf60" target="_blank" rel="noopener">è¿™å¯èƒ½æ˜¯æœ€å¥½çš„RxJava 2.x æ•™ç¨‹ï¼ˆå®Œç»“ç‰ˆï¼‰</a></p>
<p> <a href="https://mcxiaoke.gitbooks.io/rxdocs/content/Intro.html" target="_blank" rel="noopener">ReactiveXä¸­æ–‡æ–‡æ¡£</a></p>
<p> <a href="https://www.jianshu.com/p/ff8167c1d191/" target="_blank" rel="noopener">Rxjava2å…¥é—¨æ•™ç¨‹äº”ï¼šFlowableèƒŒå‹æ”¯æŒâ€”â€”å¯¹Flowableæœ€å…¨é¢è€Œè¯¦ç»†çš„è®²è§£</a></p>
<p> <a href="https://www.jianshu.com/p/fae1af7732ef" target="_blank" rel="noopener">RxJava2 æºç è§£æâ€”â€”çº¿ç¨‹è°ƒåº¦ Scheduler</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>


          
          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="https://note.youdao.com/yws/api/personal/file/WEB917b08143504a6f8c96228312fcb5245?method=download&shareKey=03cb5c302c83b56bbb91668c5008444f" alt="é»„ä¿Šå½¬">
          <p class="site-author-name" itemprop="name">é»„ä¿Šå½¬</p>
           
              <p class="site-description motion-element" itemprop="description">ä¸€èŠ±ä¸€ä¸–ç•Œï¼Œä¸€ç ä¸€æµ®ç”Ÿ</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">81</span>
                <span class="site-state-item-name">æ—¥å¿—</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">12</span>
                <span class="site-state-item-name">æ ‡ç­¾</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/junbin1011" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/junbin-9-77" target="_blank" title="zhihu">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  zhihu
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">é»„ä¿Šå½¬</span>
</div>


<div class="powered-by">
  ç”± <a class="theme-link" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨
</div>

<div class="theme-info">
  ä¸»é¢˜ -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    
    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"junbin"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  













  
  

  

  

  

  


  

</body>
</html>
